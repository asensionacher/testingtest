{"format_version":"1.1","terraform_version":"1.4.1","variables":{"avd_vm_sku":{"value":"Standard_D4s_v5"},"az_files_hybrid_url":{"value":"https://github.com/Azure-Samples/azure-files-samples/releases/download/v0.2.7/AzFilesHybrid.zip"},"customer_managed_keys":{"value":"true"},"deploy_cache_db":{"value":"none"},"deploy_daybook_ver":{"value":"2_5_0"},"deploy_iris_db":{"value":"none"},"deploy_vb_app_ver":{"value":"4_2_0"},"deployment_public_ip_firewalls":{"value":true},"environment":{"value":"$Â´{{ parameters.environment_code }}"},"environment_num":{"value":"1"},"expiration_date":{"value":"2030-01-01T00:00:00Z"},"fslogix_app_url":{"value":"https://aka.ms/fslogix_download"},"install_base_software":{"value":true},"install_cache":{"value":false},"install_cache_client_only":{"value":false},"install_iris":{"value":false},"install_nbss":{"value":true},"install_vb6":{"value":false},"iris_db_arbiter_vm_sku":{"value":"Standard_D2s_v5"},"iris_db_backup_vm_sku":{"value":"Standard_D48s_v5"},"iris_db_primary_vm_sku":{"value":"Standard_D48s_v5"},"key_size":{"value":2048},"key_type":{"value":"RSA"},"location":{"value":"uksouth"},"mod_testers":{"value":["fb1919e0-6f24-483b-9805-cad05ea3c745","9ee966e1-4b96-483e-a0a2-10b6c0e070cb","823ce908-2aae-49a2-981d-870d8aca86b0"]},"modern_vnet_range":{"value":"10.20.0.0/21"},"org_name":{"value":"NBSS"},"security_contact_email":{"value":"paul.thoms@hitachivantara.com"},"security_contact_phone":{"value":"+447551283828"},"tag_app":{"value":"Core"},"tag_environment":{"value":"Modernisation"},"tag_project":{"value":"Modernisation"},"tag_service":{"value":"Modernisation"},"tag_shared":{"value":"Modernisation"},"tag_site":{"value":"Modernisation"}},"planned_values":{"root_module":{"resources":[{"address":"azurerm_firewall_policy_rule_collection_group.avd_core","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_core","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"application_rule_collection":[],"firewall_policy_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","name":"AVD-Core","nat_rule_collection":[],"network_rule_collection":[{"action":"Allow","name":"NetworkRules-WindowsVirtualDesktop","priority":100,"rule":[{"destination_addresses":["WindowsVirtualDesktop"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Service-Traffic","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["AzureMonitor"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Agent-Traffic","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["AzureFrontDoor.Frontend"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Azure-Marketplace","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["kms.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["1688"],"name":"Windows-activation","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["azkms.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["1688"],"name":"Azure-Windows-activation","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["mrsglobalsteus2prod.blob.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Agent-and-SXS-Stack-Updates","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["wvdportalstorageblob.blob.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Azure-Portal-Support","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["169.254.169.254"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Azure-Instance-Metadata-Service-Endpoint","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["168.63.129.16"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Session-Host-Health-Monitoring","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["oneocsp.microsoft.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Certificate-CRL-OneOCSP","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["www.microsoft.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Certificate-CRL-MicrosoftDotCom","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["*"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["3478"],"name":"TURN-Health-Checking","protocols":["UDP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null}]}],"priority":600,"timeouts":null},"sensitive_values":{"application_rule_collection":[],"nat_rule_collection":[],"network_rule_collection":[{"rule":[{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}]}},{"address":"azurerm_firewall_policy_rule_collection_group.avd_optional","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_optional","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"application_rule_collection":[],"firewall_policy_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","name":"AVD-Optional","nat_rule_collection":[],"network_rule_collection":[{"action":"Allow","name":"NetworkRules_AVD-Optional","priority":100,"rule":[{"destination_addresses":["time.windows.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["123"],"name":"NTP","protocols":["TCP","UDP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["login.microsoftonline.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Auth-To-MSOL","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["login.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Signin-To-MSOL365","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["www.msftconnecttest.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Detect-OS-Connected-To-Internet","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null}]}],"priority":601,"timeouts":null},"sensitive_values":{"application_rule_collection":[],"nat_rule_collection":[],"network_rule_collection":[{"rule":[{"destination_addresses":[false],"destination_ports":[false],"protocols":[false,false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}]}},{"address":"azurerm_firewall_policy_rule_collection_group.avd_optional_priority","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_optional_priority","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"application_rule_collection":[{"action":"Allow","name":"ApplicationRules_AVD-Optional","priority":100,"rule":[{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.events.data.microsoft.com"],"destination_urls":null,"name":"Telemetry-Service","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":["WindowsUpdate"],"destination_fqdns":null,"destination_urls":null,"name":"Windows-Update","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.sfx.ms"],"destination_urls":null,"name":"Updates-For-One-Drive","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.digicert.com"],"destination_urls":null,"name":"Digitcert-CRL","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.azure-dns.com"],"destination_urls":null,"name":"Azure-DNS-Resolution-1","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.azure-dns.net"],"destination_urls":null,"name":"Azure-DNS-Resolution-2","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null}]}],"firewall_policy_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","name":"AVD-Optional-priority","nat_rule_collection":[],"network_rule_collection":[],"priority":601,"timeouts":null},"sensitive_values":{"application_rule_collection":[{"rule":[{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdn_tags":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}],"nat_rule_collection":[],"network_rule_collection":[]}},{"address":"azurerm_role_assignment.avd_poweron_off","mode":"managed","type":"azurerm_role_assignment","name":"avd_poweron_off","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"condition":null,"condition_version":null,"delegated_managed_identity_resource_id":null,"description":null,"principal_id":"11eefac9-a5f4-4c9f-ba02-d453e2c34087","role_definition_name":"Desktop Virtualization Power On Off Contributor","scope":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9","skip_service_principal_aad_check":true,"timeouts":null},"sensitive_values":{}},{"address":"azurerm_role_definition.avd_autoscale","mode":"managed","type":"azurerm_role_definition","name":"avd_autoscale","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"description":"AVD AutoScale Role","name":"Mod-AVD-AutoScale","permissions":[{"actions":["Microsoft.Insights/eventtypes/values/read","Microsoft.Compute/virtualMachines/deallocate/action","Microsoft.Compute/virtualMachines/restart/action","Microsoft.Compute/virtualMachines/powerOff/action","Microsoft.Compute/virtualMachines/start/action","Microsoft.Compute/virtualMachines/read","Microsoft.DesktopVirtualization/hostpools/read","Microsoft.DesktopVirtualization/hostpools/write","Microsoft.DesktopVirtualization/hostpools/sessionhosts/read","Microsoft.DesktopVirtualization/hostpools/sessionhosts/write","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/delete","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/read","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/sendMessage/action","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/read","Microsoft.Authorization/roleAssignments/write"],"data_actions":null,"not_actions":[],"not_data_actions":null}],"scope":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9","timeouts":null},"sensitive_values":{"assignable_scopes":[],"permissions":[{"actions":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"not_actions":[]}]}},{"address":"azurerm_security_center_auto_provisioning.modern","mode":"managed","type":"azurerm_security_center_auto_provisioning","name":"modern","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"auto_provision":"On","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.app_services","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"app_services","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"AppServices","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.arm","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"arm","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"Arm","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.container_registry","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"container_registry","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"ContainerRegistry","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.containers","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"containers","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"Containers","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.dns","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"dns","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"Dns","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.key_vault","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"key_vault","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"KeyVaults","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.kubernetes","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"kubernetes","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"KubernetesService","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.os_relational_databases","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"os_relational_databases","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"OpenSourceRelationalDatabases","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.sql_server_virtual_machines","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"sql_server_virtual_machines","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"SqlServerVirtualMachines","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.sql_servers","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"sql_servers","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"SqlServers","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.storage_accounts","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"storage_accounts","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"StorageAccounts","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"azurerm_security_center_subscription_pricing.virtual_machines","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"virtual_machines","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":1,"values":{"resource_type":"VirtualMachines","subplan":null,"tier":"Standard","timeouts":null},"sensitive_values":{}},{"address":"time_offset.next_day","mode":"managed","type":"time_offset","name":"next_day","provider_name":"registry.terraform.io/hashicorp/time","schema_version":0,"values":{"offset_days":1,"offset_hours":null,"offset_minutes":null,"offset_months":null,"offset_seconds":null,"offset_years":null,"triggers":{"update_time":"04:00:00"}},"sensitive_values":{"triggers":{}}}]}},"resource_changes":[{"address":"azurerm_firewall_policy_rule_collection_group.avd_core","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_core","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"application_rule_collection":[],"firewall_policy_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","name":"AVD-Core","nat_rule_collection":[],"network_rule_collection":[{"action":"Allow","name":"NetworkRules-WindowsVirtualDesktop","priority":100,"rule":[{"destination_addresses":["WindowsVirtualDesktop"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Service-Traffic","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["AzureMonitor"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Agent-Traffic","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["AzureFrontDoor.Frontend"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Azure-Marketplace","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["kms.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["1688"],"name":"Windows-activation","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["azkms.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["1688"],"name":"Azure-Windows-activation","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["mrsglobalsteus2prod.blob.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Agent-and-SXS-Stack-Updates","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["wvdportalstorageblob.blob.core.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Azure-Portal-Support","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["169.254.169.254"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Azure-Instance-Metadata-Service-Endpoint","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["168.63.129.16"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Session-Host-Health-Monitoring","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["oneocsp.microsoft.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Certificate-CRL-OneOCSP","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["www.microsoft.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["80"],"name":"Certificate-CRL-MicrosoftDotCom","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["*"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["3478"],"name":"TURN-Health-Checking","protocols":["UDP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null}]}],"priority":600,"timeouts":null},"after_unknown":{"application_rule_collection":[],"id":true,"nat_rule_collection":[],"network_rule_collection":[{"rule":[{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}]},"before_sensitive":false,"after_sensitive":{"application_rule_collection":[],"nat_rule_collection":[],"network_rule_collection":[{"rule":[{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}]}}},{"address":"azurerm_firewall_policy_rule_collection_group.avd_optional","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_optional","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"application_rule_collection":[],"firewall_policy_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","name":"AVD-Optional","nat_rule_collection":[],"network_rule_collection":[{"action":"Allow","name":"NetworkRules_AVD-Optional","priority":100,"rule":[{"destination_addresses":["time.windows.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["123"],"name":"NTP","protocols":["TCP","UDP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["login.microsoftonline.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Auth-To-MSOL","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["login.windows.net"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Signin-To-MSOL365","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null},{"destination_addresses":["www.msftconnecttest.com"],"destination_fqdns":null,"destination_ip_groups":null,"destination_ports":["443"],"name":"Detect-OS-Connected-To-Internet","protocols":["TCP"],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null}]}],"priority":601,"timeouts":null},"after_unknown":{"application_rule_collection":[],"id":true,"nat_rule_collection":[],"network_rule_collection":[{"rule":[{"destination_addresses":[false],"destination_ports":[false],"protocols":[false,false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}]},"before_sensitive":false,"after_sensitive":{"application_rule_collection":[],"nat_rule_collection":[],"network_rule_collection":[{"rule":[{"destination_addresses":[false],"destination_ports":[false],"protocols":[false,false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_addresses":[false],"destination_ports":[false],"protocols":[false],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}]}}},{"address":"azurerm_firewall_policy_rule_collection_group.avd_optional_priority","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_optional_priority","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"application_rule_collection":[{"action":"Allow","name":"ApplicationRules_AVD-Optional","priority":100,"rule":[{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.events.data.microsoft.com"],"destination_urls":null,"name":"Telemetry-Service","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":["WindowsUpdate"],"destination_fqdns":null,"destination_urls":null,"name":"Windows-Update","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.sfx.ms"],"destination_urls":null,"name":"Updates-For-One-Drive","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.digicert.com"],"destination_urls":null,"name":"Digitcert-CRL","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.azure-dns.com"],"destination_urls":null,"name":"Azure-DNS-Resolution-1","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null},{"description":null,"destination_addresses":null,"destination_fqdn_tags":null,"destination_fqdns":["*.azure-dns.net"],"destination_urls":null,"name":"Azure-DNS-Resolution-2","protocols":[{"port":443,"type":"Https"}],"source_addresses":["10.20.1.16/28","10.20.1.32/28","10.20.1.48/28","10.20.1.64/28","10.20.1.80/28","10.20.1.96/28","10.20.1.112/28","10.20.1.128/28","10.20.1.144/28","10.20.1.160/28","10.20.1.176/28","10.20.1.192/28","10.20.1.208/28","10.20.1.224/28","10.20.1.240/28","10.20.2.0/28","10.20.2.16/28","10.20.2.32/28","10.20.2.48/28","10.20.2.64/28","10.20.2.80/28","10.20.2.96/28","10.20.2.112/28","10.20.2.128/28","10.20.2.144/28","10.20.2.160/28","10.20.2.176/28","10.20.2.192/28","10.20.2.208/28","10.20.2.224/28","10.20.2.240/28","10.20.3.0/28","10.20.3.16/28","10.20.3.32/28","10.20.3.48/28","10.20.3.64/28","10.20.3.80/28","10.20.3.96/28","10.20.3.112/28","10.20.3.128/28","10.20.3.144/28","10.20.3.160/28","10.20.3.176/28","10.20.3.192/28","10.20.3.208/28","10.20.3.224/28","10.20.3.240/28","10.20.4.0/28","10.20.4.16/28","10.20.4.32/28","10.20.4.48/28","10.20.4.64/28","10.20.4.80/28","10.20.4.96/28","10.20.4.112/28","10.20.4.128/28","10.20.4.144/28","10.20.4.160/28","10.20.4.176/28","10.20.4.192/28","10.20.4.208/28","10.20.4.224/28","10.20.4.240/28","10.20.5.0/28","10.20.5.16/28","10.20.5.32/28","10.20.5.48/28","10.20.5.64/28","10.20.5.80/28","10.20.5.96/28","10.20.5.112/28","10.20.5.128/28","10.20.5.144/28","10.20.5.160/28","10.20.5.176/28","10.20.5.192/28","10.20.5.208/28"],"source_ip_groups":null,"terminate_tls":false,"web_categories":null}]}],"firewall_policy_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","name":"AVD-Optional-priority","nat_rule_collection":[],"network_rule_collection":[],"priority":601,"timeouts":null},"after_unknown":{"application_rule_collection":[{"rule":[{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdn_tags":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}],"id":true,"nat_rule_collection":[],"network_rule_collection":[]},"before_sensitive":false,"after_sensitive":{"application_rule_collection":[{"rule":[{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdn_tags":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{"destination_fqdns":[false],"protocols":[{}],"source_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}]}],"nat_rule_collection":[],"network_rule_collection":[]}}},{"address":"azurerm_role_assignment.avd_poweron_off","mode":"managed","type":"azurerm_role_assignment","name":"avd_poweron_off","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"condition":null,"condition_version":null,"delegated_managed_identity_resource_id":null,"description":null,"principal_id":"11eefac9-a5f4-4c9f-ba02-d453e2c34087","role_definition_name":"Desktop Virtualization Power On Off Contributor","scope":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9","skip_service_principal_aad_check":true,"timeouts":null},"after_unknown":{"id":true,"name":true,"principal_type":true,"role_definition_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_role_definition.avd_autoscale","mode":"managed","type":"azurerm_role_definition","name":"avd_autoscale","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"description":"AVD AutoScale Role","name":"Mod-AVD-AutoScale","permissions":[{"actions":["Microsoft.Insights/eventtypes/values/read","Microsoft.Compute/virtualMachines/deallocate/action","Microsoft.Compute/virtualMachines/restart/action","Microsoft.Compute/virtualMachines/powerOff/action","Microsoft.Compute/virtualMachines/start/action","Microsoft.Compute/virtualMachines/read","Microsoft.DesktopVirtualization/hostpools/read","Microsoft.DesktopVirtualization/hostpools/write","Microsoft.DesktopVirtualization/hostpools/sessionhosts/read","Microsoft.DesktopVirtualization/hostpools/sessionhosts/write","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/delete","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/read","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/sendMessage/action","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/read","Microsoft.Authorization/roleAssignments/write"],"data_actions":null,"not_actions":[],"not_data_actions":null}],"scope":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9","timeouts":null},"after_unknown":{"assignable_scopes":true,"id":true,"permissions":[{"actions":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"not_actions":[]}],"role_definition_id":true,"role_definition_resource_id":true},"before_sensitive":false,"after_sensitive":{"assignable_scopes":[],"permissions":[{"actions":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"not_actions":[]}]}}},{"address":"azurerm_security_center_auto_provisioning.modern","mode":"managed","type":"azurerm_security_center_auto_provisioning","name":"modern","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"auto_provision":"On","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.app_services","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"app_services","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"AppServices","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.arm","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"arm","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"Arm","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.container_registry","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"container_registry","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"ContainerRegistry","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.containers","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"containers","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"Containers","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.dns","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"dns","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"Dns","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.key_vault","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"key_vault","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"KeyVaults","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.kubernetes","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"kubernetes","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"KubernetesService","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.os_relational_databases","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"os_relational_databases","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"OpenSourceRelationalDatabases","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.sql_server_virtual_machines","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"sql_server_virtual_machines","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"SqlServerVirtualMachines","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.sql_servers","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"sql_servers","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"SqlServers","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.storage_accounts","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"storage_accounts","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"StorageAccounts","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_security_center_subscription_pricing.virtual_machines","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"virtual_machines","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"resource_type":"VirtualMachines","subplan":null,"tier":"Standard","timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"time_offset.next_day","mode":"managed","type":"time_offset","name":"next_day","provider_name":"registry.terraform.io/hashicorp/time","change":{"actions":["create"],"before":null,"after":{"offset_days":1,"offset_hours":null,"offset_minutes":null,"offset_months":null,"offset_seconds":null,"offset_years":null,"triggers":{"update_time":"04:00:00"}},"after_unknown":{"base_rfc3339":true,"day":true,"hour":true,"id":true,"minute":true,"month":true,"rfc3339":true,"second":true,"triggers":{},"unix":true,"year":true},"before_sensitive":false,"after_sensitive":{"triggers":{}}}}],"prior_state":{"format_version":"1.0","terraform_version":"1.4.1","values":{"root_module":{"resources":[{"address":"data.azuread_domains.azuread_domain","mode":"data","type":"azuread_domains","name":"azuread_domain","provider_name":"registry.terraform.io/hashicorp/azuread","schema_version":0,"values":{"admin_managed":null,"domains":[{"admin_managed":true,"authentication_type":"Managed","default":true,"domain_name":"hvnbss.onmicrosoft.com","initial":true,"root":true,"supported_services":["Email","OfficeCommunicationsOnline"],"verified":true}],"id":"domains#938d617d-7cdc-4912-a45f-315ff6b87aaa#6AWFS1vWYo0s898BxfL8SEf-h8s=","include_unverified":null,"only_default":true,"only_initial":null,"only_root":null,"supports_services":null,"timeouts":null},"sensitive_values":{"domains":[{"supported_services":[false,false]}]}},{"address":"data.azuread_service_principal.wvd","mode":"data","type":"azuread_service_principal","name":"wvd","provider_name":"registry.terraform.io/hashicorp/azuread","schema_version":0,"values":{"account_enabled":true,"alternative_names":[],"app_role_assignment_required":false,"app_role_ids":{"Tenant.Create":"299dad25-58e3-473d-9733-171fb3034713"},"app_roles":[{"allowed_member_types":["Application","User"],"description":"Creators can create Windows Virtual Desktop Tenants","display_name":"Tenant.Create","enabled":true,"id":"299dad25-58e3-473d-9733-171fb3034713","value":"Tenant.Create"}],"application_id":"9cdead84-a844-4324-93f2-b2e6bb768d07","application_tenant_id":"f8cdef31-a31e-4b4a-93e4-5f571e91255a","description":"","display_name":"Windows Virtual Desktop","feature_tags":[{"custom_single_sign_on":false,"enterprise":false,"gallery":false,"hide":false}],"features":[{"custom_single_sign_on_app":false,"enterprise_application":false,"gallery_application":false,"visible_to_users":true}],"homepage_url":"","id":"11eefac9-a5f4-4c9f-ba02-d453e2c34087","login_url":"","logout_url":"","notes":"","notification_email_addresses":[],"oauth2_permission_scope_ids":{"User.Access":"1ea0ab9c-b888-476f-aca9-0fc9a53b483a"},"oauth2_permission_scopes":[{"admin_consent_description":"Allow the application to access Windows Virtual Desktop on your behalf.","admin_consent_display_name":"Access Windows Virtual Desktop","enabled":true,"id":"1ea0ab9c-b888-476f-aca9-0fc9a53b483a","type":"User","user_consent_description":"Allow the application to access Windows Virtual Desktop on your behalf.","user_consent_display_name":"Access Windows Virtual Desktop","value":"User.Access"}],"object_id":"11eefac9-a5f4-4c9f-ba02-d453e2c34087","preferred_single_sign_on_mode":"","redirect_uris":["https://rdbroker.wvd.microsoft.com/aadCallback","https://rdweb.wvd.microsoft.com/webclient/index.html","https://rdweb.wvd.microsoft.com/webclient","https://www.wvd.microsoft.com/webclient/index.html","https://www.wvd.microsoft.com/webclient","https://www.wvd.microsoft.com","https://www.wvd.microsoft.com/RDWeb/ConsentCallback","https://rdweb.wvd.microsoft.com/RDWeb/ConsentCallback"],"saml_metadata_url":"","saml_single_sign_on":[],"service_principal_names":["https://www.wvd.microsoft.com","https://www.wvd.azure.us"],"sign_in_audience":"AzureADMultipleOrgs","tags":[],"timeouts":null,"type":"Application"},"sensitive_values":{"alternative_names":[],"app_role_ids":{},"app_roles":[{"allowed_member_types":[false,false]}],"feature_tags":[{}],"features":[{}],"notification_email_addresses":[],"oauth2_permission_scope_ids":{},"oauth2_permission_scopes":[{}],"redirect_uris":[false,false,false,false,false,false,false,false],"saml_single_sign_on":[],"service_principal_names":[false,false],"tags":[]}},{"address":"data.azurerm_active_directory_domain_service.hub","mode":"data","type":"azurerm_active_directory_domain_service","name":"hub","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"deployment_id":"07bcedc0-0697-4d70-b653-2f6f514ef91f","domain_configuration_type":"FullySynced","domain_name":"hvnbss.onmicrosoft.com","filtered_sync_enabled":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-aadds-01/providers/Microsoft.AAD/domainServices/aadds-nbss-uks-hub-01","location":"uksouth","name":"aadds-nbss-uks-hub-01","notifications":[{"additional_recipients":["james.bland@hitachivantara.com","liam.statham@hitachivantara.com"],"notify_dc_admins":true,"notify_global_admins":true}],"replica_sets":[{"domain_controller_ip_addresses":["10.10.7.196","10.10.7.197"],"external_access_ip_address":"","id":"07bcedc0-0697-4d70-b653-2f6f514ef91f","location":"uksouth","service_status":"Running","subnet_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/AzureDomainServicesSubnet"}],"resource_group_name":"rg-nbss-uks-hub-aadds-01","resource_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-aadds-01/providers/Microsoft.AAD/domainServices/aadds-nbss-uks-hub-01","secure_ldap":[{"certificate_expiry":"0001-01-01T08:00:00Z","certificate_thumbprint":"","enabled":false,"external_access_enabled":false,"public_certificate":""}],"security":[{"kerberos_armoring_enabled":false,"kerberos_rc4_encryption_enabled":true,"ntlm_v1_enabled":false,"sync_kerberos_passwords":true,"sync_ntlm_passwords":true,"sync_on_prem_passwords":true,"tls_v1_enabled":false}],"sku":"Standard","sync_owner":"07bcedc0-0697-4d70-b653-2f6f514ef91f","tags":{"environment":"Hub","service":"Core"},"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa","timeouts":null,"version":2},"sensitive_values":{"notifications":[{"additional_recipients":[false,false]}],"replica_sets":[{"domain_controller_ip_addresses":[false,false]}],"secure_ldap":[{}],"security":[{}],"tags":{}}},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"client_id":"81c4f3a4-74a2-48f8-b581-4b8930dc1e74","id":"Y2xpZW50Q29uZmlncy9jbGllbnRJZD04MWM0ZjNhNC03NGEyLTQ4ZjgtYjU4MS00Yjg5MzBkYzFlNzQ7b2JqZWN0SWQ9NGVmMmQyYzQtNzk3My00MTRiLWIyNjMtMTVjY2YxM2VlNzU4O3N1YnNjcmlwdGlvbklkPTZkNWJkMzM2LWM3YTQtNDg4Ny04NzE1LThiODJlYjBlZWFjOTt0ZW5hbnRJZD05MzhkNjE3ZC03Y2RjLTQ5MTItYTQ1Zi0zMTVmZjZiODdhYWE=","object_id":"4ef2d2c4-7973-414b-b263-15ccf13ee758","subscription_id":"6d5bd336-c7a4-4887-8715-8b82eb0eeac9","tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa","timeouts":null},"sensitive_values":{}},{"address":"data.azurerm_firewall.hub","mode":"data","type":"azurerm_firewall","name":"hub","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"dns_servers":[],"firewall_policy_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/azureFirewalls/afw-nbss-uks-hub-01","ip_configuration":[{"name":"outbound_1","private_ip_address":"10.10.7.68","public_ip_address_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/publicIPAddresses/afw-nbss-uks-hub-01-pip","subnet_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/AzureFirewallSubnet"}],"location":"uksouth","management_ip_configuration":[],"name":"afw-nbss-uks-hub-01","resource_group_name":"rg-nbss-uks-hub-net-01","sku_name":"AZFW_VNet","sku_tier":"Standard","tags":{"environment":"Hub","service":"Core"},"threat_intel_mode":"Alert","timeouts":null,"virtual_hub":[],"zones":[]},"sensitive_values":{"dns_servers":[],"ip_configuration":[{}],"management_ip_configuration":[],"tags":{},"virtual_hub":[],"zones":[]}},{"address":"data.azurerm_firewall_policy.standard","mode":"data","type":"azurerm_firewall_policy","name":"standard","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"base_policy_id":"","child_policies":[],"dns":[],"firewalls":["/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/azureFirewalls/afw-nbss-uks-hub-01"],"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01","location":"uksouth","name":"afwp-nbss-uks-hub-01","resource_group_name":"rg-nbss-uks-hub-net-01","rule_collection_groups":["/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Azure-KMS","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Azure-WindowsUpdates","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/DNS","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Windows-Diagnostics","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Azure-Backup","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Allow-All-HTTP-HTTPS","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Azure-Devops","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Deny-All-HTTP-HTTPS","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Azure-Monitor","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Browser-Updates","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Azure-Defender","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Azure-Login","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/crl","/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/firewallPolicies/afwp-nbss-uks-hub-01/ruleCollectionGroups/Application-Install"],"tags":{"environment":"Hub","service":"Core"},"threat_intelligence_allowlist":[],"threat_intelligence_mode":"Alert","timeouts":null},"sensitive_values":{"child_policies":[],"dns":[],"firewalls":[false],"rule_collection_groups":[false,false,false,false,false,false,false,false,false,false,false,false,false,false],"tags":{},"threat_intelligence_allowlist":[]}},{"address":"data.azurerm_key_vault.hub","mode":"data","type":"azurerm_key_vault","name":"hub","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_policy":[{"application_id":"","certificate_permissions":["Get","List","Update","Create","Import","Delete","Recover","Backup","Restore","ManageContacts","ManageIssuers","GetIssuers","ListIssuers","SetIssuers","DeleteIssuers"],"key_permissions":["Get","List","Update","Create","Import","Delete","Recover","Backup","Restore","GetRotationPolicy","SetRotationPolicy","Rotate"],"object_id":"a4ca3f9f-5088-4011-ac8a-acb1e12dacc4","secret_permissions":["Get","List","Set","Delete","Recover","Backup","Restore"],"storage_permissions":[],"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa"},{"application_id":"","certificate_permissions":["Get","List","Update","Create","Import","Delete","Purge","Recover"],"key_permissions":["Get","List","Update","Create","Delete","Purge","Recover"],"object_id":"4ef2d2c4-7973-414b-b263-15ccf13ee758","secret_permissions":["Get","List","Set","Delete","Purge","Recover"],"storage_permissions":[],"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa"},{"application_id":"","certificate_permissions":["Get","List","Update","Create","Import","Delete","Recover","Backup","Restore","ManageContacts","ManageIssuers","GetIssuers","ListIssuers","SetIssuers","DeleteIssuers"],"key_permissions":["Get","List","Update","Create","Import","Delete","Recover","Backup","Restore","GetRotationPolicy","SetRotationPolicy","Rotate"],"object_id":"66d0a1e7-581c-43a1-a52f-c7cdf3081695","secret_permissions":["Get","List","Set","Delete","Recover","Backup","Restore"],"storage_permissions":[],"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa"},{"application_id":"","certificate_permissions":[],"key_permissions":[],"object_id":"fb1919e0-6f24-483b-9805-cad05ea3c745","secret_permissions":["Get","List"],"storage_permissions":[],"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa"},{"application_id":"","certificate_permissions":["Get","List","Update","Create","Import","Delete","Recover","Backup","Restore","ManageContacts","ManageIssuers","GetIssuers","ListIssuers","SetIssuers","DeleteIssuers"],"key_permissions":["Get","List","Update","Create","Import","Delete","Recover","Backup","Restore","GetRotationPolicy","SetRotationPolicy","Rotate"],"object_id":"9ee966e1-4b96-483e-a0a2-10b6c0e070cb","secret_permissions":["Get","List","Set","Delete","Recover","Backup","Restore"],"storage_permissions":[],"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa"}],"enable_rbac_authorization":false,"enabled_for_deployment":false,"enabled_for_disk_encryption":true,"enabled_for_template_deployment":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01/providers/Microsoft.KeyVault/vaults/kv-nbss-uks-hub-01","location":"uksouth","name":"kv-nbss-uks-hub-01","network_acls":[{"bypass":"AzureServices","default_action":"Deny","ip_rules":["40.81.159.67/32","51.104.26.0/23","144.64.156.208/32"],"virtual_network_subnet_ids":[]}],"public_network_access_enabled":true,"purge_protection_enabled":true,"resource_group_name":"rg-nbss-uks-hub-kv-01","sku_name":"standard","tags":{"environment":"Hub","service":"Core"},"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa","timeouts":null,"vault_uri":"https://kv-nbss-uks-hub-01.vault.azure.net/"},"sensitive_values":{"access_policy":[{"certificate_permissions":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"key_permissions":[false,false,false,false,false,false,false,false,false,false,false,false],"secret_permissions":[false,false,false,false,false,false,false],"storage_permissions":[]},{"certificate_permissions":[false,false,false,false,false,false,false,false],"key_permissions":[false,false,false,false,false,false,false],"secret_permissions":[false,false,false,false,false,false],"storage_permissions":[]},{"certificate_permissions":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"key_permissions":[false,false,false,false,false,false,false,false,false,false,false,false],"secret_permissions":[false,false,false,false,false,false,false],"storage_permissions":[]},{"certificate_permissions":[],"key_permissions":[],"secret_permissions":[false,false],"storage_permissions":[]},{"certificate_permissions":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"key_permissions":[false,false,false,false,false,false,false,false,false,false,false,false],"secret_permissions":[false,false,false,false,false,false,false],"storage_permissions":[]}],"network_acls":[{"ip_rules":[false,false,false],"virtual_network_subnet_ids":[]}],"tags":{}}},{"address":"data.azurerm_key_vault_secret.aadds_admin_password","mode":"data","type":"azurerm_key_vault_secret","name":"aadds_admin_password","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"content_type":"","expiration_date":null,"id":"https://kv-nbss-uks-hub-01.vault.azure.net/secrets/AADDSAdmin-Password/40b9f0b6a71a40ba8f2f8b86060df2ba","key_vault_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01/providers/Microsoft.KeyVault/vaults/kv-nbss-uks-hub-01","name":"AADDSAdmin-Password","not_before_date":null,"resource_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01/providers/Microsoft.KeyVault/vaults/kv-nbss-uks-hub-01/secrets/AADDSAdmin-Password/versions/40b9f0b6a71a40ba8f2f8b86060df2ba","resource_versionless_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01/providers/Microsoft.KeyVault/vaults/kv-nbss-uks-hub-01/secrets/AADDSAdmin-Password","tags":{"environment":"Hub","service":"Core"},"timeouts":null,"value":"lGoHm@n9XF0gCXdQxBdFU6hq0Ucp49Fh1Wwa1qS6L9h1dCAOQhg2fpqsSL4paaIb","version":"40b9f0b6a71a40ba8f2f8b86060df2ba","versionless_id":"https://kv-nbss-uks-hub-01.vault.azure.net/secrets/AADDSAdmin-Password"},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_key_vault_secret.aadds_admin_username","mode":"data","type":"azurerm_key_vault_secret","name":"aadds_admin_username","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"content_type":"","expiration_date":null,"id":"https://kv-nbss-uks-hub-01.vault.azure.net/secrets/AADDSAdmin-Username/a94219a6d20d4b14a3fa9a8576fc5003","key_vault_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01/providers/Microsoft.KeyVault/vaults/kv-nbss-uks-hub-01","name":"AADDSAdmin-Username","not_before_date":null,"resource_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01/providers/Microsoft.KeyVault/vaults/kv-nbss-uks-hub-01/secrets/AADDSAdmin-Username/versions/a94219a6d20d4b14a3fa9a8576fc5003","resource_versionless_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01/providers/Microsoft.KeyVault/vaults/kv-nbss-uks-hub-01/secrets/AADDSAdmin-Username","tags":{"environment":"Hub","service":"Core"},"timeouts":null,"value":"AADDSAdmin@hvnbss.onmicrosoft.com","version":"a94219a6d20d4b14a3fa9a8576fc5003","versionless_id":"https://kv-nbss-uks-hub-01.vault.azure.net/secrets/AADDSAdmin-Username"},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"agentsvc\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"agentsvc","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.agentsvc.azure-automation.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.agentsvc.azure-automation.net","number_of_record_sets":2,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"automation\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"automation","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.azure-automation.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.azure-automation.net","number_of_record_sets":3,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"key_vault\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"key_vault","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.vaultcore.azure.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.vaultcore.azure.net","number_of_record_sets":3,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"monitor\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"monitor","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.monitor.azure.com","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.monitor.azure.com","number_of_record_sets":1,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"ods\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"ods","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.ods.opinsights.azure.com","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.ods.opinsights.azure.com","number_of_record_sets":2,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"oms\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"oms","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.oms.opinsights.azure.com","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.oms.opinsights.azure.com","number_of_record_sets":2,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"recovery_vault\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"recovery_vault","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.uks.backup.windowsazure.com","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.uks.backup.windowsazure.com","number_of_record_sets":14,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"service_bus\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"service_bus","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.servicebus.windows.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.servicebus.windows.net","number_of_record_sets":2,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"storage_blob\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"storage_blob","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.blob.core.windows.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.blob.core.windows.net","number_of_record_sets":10,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"storage_file\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"storage_file","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.file.core.windows.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.file.core.windows.net","number_of_record_sets":8,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"storage_queue\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"storage_queue","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.queue.core.windows.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.queue.core.windows.net","number_of_record_sets":7,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"storage_table\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"storage_table","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.table.core.windows.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.table.core.windows.net","number_of_record_sets":7,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_private_dns_zone.zone[\"storage_web\"]","mode":"data","type":"azurerm_private_dns_zone","name":"zone","index":"storage_web","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/privateDnsZones/privatelink.web.core.windows.net","max_number_of_record_sets":25000,"max_number_of_virtual_network_links":1000,"max_number_of_virtual_network_links_with_registration":100,"name":"privatelink.web.core.windows.net","number_of_record_sets":5,"resource_group_name":"rg-nbss-uks-hub-net-01","tags":{},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.devops[\"key_vault\"]","mode":"data","type":"azurerm_resource_group","name":"devops","index":"key_vault","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-ado-kv-01","location":"uksouth","name":"rg-nbss-uks-ado-kv-01","tags":{"environment":"DevOps","service":"DevOps"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.devops[\"network\"]","mode":"data","type":"azurerm_resource_group","name":"devops","index":"network","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-ado-net-01","location":"uksouth","name":"rg-nbss-uks-ado-net-01","tags":{"environment":"DevOps","service":"DevOps"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.environment[\"network\"]","mode":"data","type":"azurerm_resource_group","name":"environment","index":"network","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-env-net-01","location":"uksouth","name":"rg-nbss-uks-env-net-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"aadds\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"aadds","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-aadds-01","location":"uksouth","name":"rg-nbss-uks-hub-aadds-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"automation\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"automation","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-auto-01","location":"uksouth","name":"rg-nbss-uks-hub-auto-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"backup\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"backup","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-bkp-01","location":"uksouth","name":"rg-nbss-uks-hub-bkp-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"file\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"file","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01","location":"uksouth","name":"rg-nbss-uks-hub-file-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"key_vault\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"key_vault","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-kv-01","location":"uksouth","name":"rg-nbss-uks-hub-kv-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"management\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"management","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-mgmt-01","location":"uksouth","name":"rg-nbss-uks-hub-mgmt-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"monitoring\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"monitoring","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-mon-01","location":"uksouth","name":"rg-nbss-uks-hub-mon-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"network\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"network","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01","location":"uksouth","name":"rg-nbss-uks-hub-net-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.hub[\"network_watcher\"]","mode":"data","type":"azurerm_resource_group","name":"hub","index":"network_watcher","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/NetworkWatcherRG","location":"uksouth","name":"NetworkWatcherRG","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_resource_group.support[\"network\"]","mode":"data","type":"azurerm_resource_group","name":"support","index":"network","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-sup-net-01","location":"uksouth","name":"rg-nbss-uks-sup-net-01","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_storage_account.hub[\"file\"]","mode":"data","type":"azurerm_storage_account","name":"hub","index":"file","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","account_kind":"StorageV2","account_replication_type":"GRS","account_tier":"Standard","allow_nested_items_to_be_public":true,"azure_files_authentication":[{"active_directory":[{"domain_guid":"","domain_name":"hvnbss.onmicrosoft.com","domain_sid":"","forest_name":"","netbios_domain_name":"","storage_sid":""}],"directory_type":"AADDS"}],"custom_domain":null,"enable_https_traffic_only":true,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01","identity":[],"infrastructure_encryption_enabled":false,"is_hns_enabled":false,"location":"uksouth","min_tls_version":"TLS1_2","name":"stnbssukshubfile01","nfsv3_enabled":false,"primary_access_key":"P0HjfS3M24Jl3RIK1kVXaZiJey7tAu4NVmETjF5pYeIRwZt8LfVzZiA2C95ip+ymNgZxqIJrwl8Ba4lVlziDeg==","primary_blob_connection_string":"DefaultEndpointsProtocol=https;BlobEndpoint=https://stnbssukshubfile01.blob.core.windows.net/;AccountName=stnbssukshubfile01;AccountKey=P0HjfS3M24Jl3RIK1kVXaZiJey7tAu4NVmETjF5pYeIRwZt8LfVzZiA2C95ip+ymNgZxqIJrwl8Ba4lVlziDeg==","primary_blob_endpoint":"https://stnbssukshubfile01.blob.core.windows.net/","primary_blob_host":"stnbssukshubfile01.blob.core.windows.net","primary_connection_string":"DefaultEndpointsProtocol=https;AccountName=stnbssukshubfile01;AccountKey=P0HjfS3M24Jl3RIK1kVXaZiJey7tAu4NVmETjF5pYeIRwZt8LfVzZiA2C95ip+ymNgZxqIJrwl8Ba4lVlziDeg==;EndpointSuffix=core.windows.net","primary_dfs_endpoint":"https://stnbssukshubfile01.dfs.core.windows.net/","primary_dfs_host":"stnbssukshubfile01.dfs.core.windows.net","primary_file_endpoint":"https://stnbssukshubfile01.file.core.windows.net/","primary_file_host":"stnbssukshubfile01.file.core.windows.net","primary_location":"uksouth","primary_queue_endpoint":"https://stnbssukshubfile01.queue.core.windows.net/","primary_queue_host":"stnbssukshubfile01.queue.core.windows.net","primary_table_endpoint":"https://stnbssukshubfile01.table.core.windows.net/","primary_table_host":"stnbssukshubfile01.table.core.windows.net","primary_web_endpoint":"https://stnbssukshubfile01.z33.web.core.windows.net/","primary_web_host":"stnbssukshubfile01.z33.web.core.windows.net","queue_encryption_key_type":"Service","resource_group_name":"rg-nbss-uks-hub-file-01","secondary_access_key":"G8Pgom/qVBPzv6phqQ4y4x3SCpD21XQ2tpNuj6Fsa0gSwKjR/y70nm2Hfa0Yr4SMNYOHZVH7raCKL6kDb38q0g==","secondary_blob_connection_string":"","secondary_blob_endpoint":null,"secondary_blob_host":null,"secondary_connection_string":"DefaultEndpointsProtocol=https;AccountName=stnbssukshubfile01;AccountKey=G8Pgom/qVBPzv6phqQ4y4x3SCpD21XQ2tpNuj6Fsa0gSwKjR/y70nm2Hfa0Yr4SMNYOHZVH7raCKL6kDb38q0g==;EndpointSuffix=core.windows.net","secondary_dfs_endpoint":null,"secondary_dfs_host":null,"secondary_file_endpoint":null,"secondary_file_host":null,"secondary_location":"ukwest","secondary_queue_endpoint":null,"secondary_queue_host":null,"secondary_table_endpoint":null,"secondary_table_host":null,"secondary_web_endpoint":null,"secondary_web_host":null,"table_encryption_key_type":"Service","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"azure_files_authentication":[{"active_directory":[{}]}],"identity":[],"tags":{}}},{"address":"data.azurerm_storage_account.hub[\"log\"]","mode":"data","type":"azurerm_storage_account","name":"hub","index":"log","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","account_kind":"StorageV2","account_replication_type":"LRS","account_tier":"Standard","allow_nested_items_to_be_public":false,"azure_files_authentication":[],"custom_domain":null,"enable_https_traffic_only":true,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-mon-01/providers/Microsoft.Storage/storageAccounts/stnbssukshublog01","identity":[],"infrastructure_encryption_enabled":false,"is_hns_enabled":false,"location":"uksouth","min_tls_version":"TLS1_2","name":"stnbssukshublog01","nfsv3_enabled":false,"primary_access_key":"oow1V2RG6QVFFdZDybogol5KyhOGx/KU0KXJ34GfCgUVOE+lorFW/It33L/UNoSzRxn+CT7oIthLug6TMgrfKQ==","primary_blob_connection_string":"DefaultEndpointsProtocol=https;BlobEndpoint=https://stnbssukshublog01.blob.core.windows.net/;AccountName=stnbssukshublog01;AccountKey=oow1V2RG6QVFFdZDybogol5KyhOGx/KU0KXJ34GfCgUVOE+lorFW/It33L/UNoSzRxn+CT7oIthLug6TMgrfKQ==","primary_blob_endpoint":"https://stnbssukshublog01.blob.core.windows.net/","primary_blob_host":"stnbssukshublog01.blob.core.windows.net","primary_connection_string":"DefaultEndpointsProtocol=https;AccountName=stnbssukshublog01;AccountKey=oow1V2RG6QVFFdZDybogol5KyhOGx/KU0KXJ34GfCgUVOE+lorFW/It33L/UNoSzRxn+CT7oIthLug6TMgrfKQ==;EndpointSuffix=core.windows.net","primary_dfs_endpoint":"https://stnbssukshublog01.dfs.core.windows.net/","primary_dfs_host":"stnbssukshublog01.dfs.core.windows.net","primary_file_endpoint":"https://stnbssukshublog01.file.core.windows.net/","primary_file_host":"stnbssukshublog01.file.core.windows.net","primary_location":"uksouth","primary_queue_endpoint":"https://stnbssukshublog01.queue.core.windows.net/","primary_queue_host":"stnbssukshublog01.queue.core.windows.net","primary_table_endpoint":"https://stnbssukshublog01.table.core.windows.net/","primary_table_host":"stnbssukshublog01.table.core.windows.net","primary_web_endpoint":"https://stnbssukshublog01.z33.web.core.windows.net/","primary_web_host":"stnbssukshublog01.z33.web.core.windows.net","queue_encryption_key_type":"Service","resource_group_name":"rg-nbss-uks-hub-mon-01","secondary_access_key":"H0cpPgsy5JqW2MTrjYg1Q2sryJrNaVvt2dY7uZL2i1gVYCzcY6J4QWxkf06w3g6LpasAkpXChpWXy0T3QZywzQ==","secondary_blob_connection_string":"","secondary_blob_endpoint":null,"secondary_blob_host":null,"secondary_connection_string":"DefaultEndpointsProtocol=https;AccountName=stnbssukshublog01;AccountKey=H0cpPgsy5JqW2MTrjYg1Q2sryJrNaVvt2dY7uZL2i1gVYCzcY6J4QWxkf06w3g6LpasAkpXChpWXy0T3QZywzQ==;EndpointSuffix=core.windows.net","secondary_dfs_endpoint":null,"secondary_dfs_host":null,"secondary_file_endpoint":null,"secondary_file_host":null,"secondary_location":"","secondary_queue_endpoint":null,"secondary_queue_host":null,"secondary_table_endpoint":null,"secondary_table_host":null,"secondary_web_endpoint":null,"secondary_web_host":null,"table_encryption_key_type":"Service","tags":{"environment":"Hub","service":"Core"},"timeouts":null},"sensitive_values":{"azure_files_authentication":[],"identity":[],"tags":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"IRISHealth-2022\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"IRISHealth-2022","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"b1a3373c164efcafdd79545ead82fe29","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/iris/IRISHealth-2022.exe","metadata":{},"name":"IRISHealth-2022.exe","storage_account_name":"stnbssukshubfile01","storage_container_name":"iris","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/iris/IRISHealth-2022.exe"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"IRIS_Dem_app\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"IRIS_Dem_app","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/iris/IRISDEMAPP/IRIS.DAT","metadata":{},"name":"IRISDEMAPP/IRIS.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"iris","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/iris/IRISDEMAPP/IRIS.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"IRIS_Dem_dat\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"IRIS_Dem_dat","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/iris/IRISDEMDAT/IRIS.DAT","metadata":{},"name":"IRISDEMDAT/IRIS.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"iris","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/iris/IRISDEMDAT/IRIS.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"IRIS_mgr\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"IRIS_mgr","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"c1ef3df11679f4e45fb76df09ef66642","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/iris/MGR/IRIS.DAT","metadata":{},"name":"MGR/IRIS.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"iris","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/iris/MGR/IRIS.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"activex\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"activex","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"4189ea453c2509831f216a068b774d44","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/vb6/ActiveX.zip","metadata":{},"name":"ActiveX.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"vb6","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/vb6/ActiveX.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"bomgar_jump_agent_win_x64\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"bomgar_jump_agent_win_x64","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"245a93562ac3b63cece131041b94e308","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/bomgar/bomgar-scc-win64.msi","metadata":{},"name":"bomgar-scc-win64.msi","storage_account_name":"stnbssukshubfile01","storage_container_name":"bomgar","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/bomgar/bomgar-scc-win64.msi"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"bomgar_representative_console\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"bomgar_representative_console","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"b4ae71ec5f9227fa23d756329abf49e6","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/bomgar/bomgar-rep-win64-installer.msi","metadata":{},"name":"bomgar-rep-win64-installer.msi","storage_account_name":"stnbssukshubfile01","storage_container_name":"bomgar","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/bomgar/bomgar-rep-win64-installer.msi"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_2018_x64\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_2018_x64","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"ee5ff78013c8a376b6749413e2c01cbe","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache/cache-2018.1.4.505.1-win_x64.exe","metadata":{},"name":"cache-2018.1.4.505.1-win_x64.exe","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache/cache-2018.1.4.505.1-win_x64.exe"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_apache\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_apache","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"13460b4add9af45ef75244c7d9c2cf03","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache/httpd-2.4.52-o111m-x86-vs16.zip","metadata":{},"name":"httpd-2.4.52-o111m-x86-vs16.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache/httpd-2.4.52-o111m-x86-vs16.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_backup_script\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_backup_script","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"d5ee068a583f5671c9c4bdf909e7b1b5","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/scripts/backup_cache.ps1","metadata":{},"name":"backup_cache.ps1","storage_account_name":"stnbssukshubfile01","storage_container_name":"scripts","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/scripts/backup_cache.ps1"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r919001_app\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r919001_app","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R919001_DEM_APP.DAT","metadata":{},"name":"R919001_DEM_APP.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R919001_DEM_APP.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r919001_cache\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r919001_cache","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R919001_CACHE.DAT","metadata":{},"name":"R919001_CACHE.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R919001_CACHE.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r919001_dat\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r919001_dat","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R919001_DEM_DAT.DAT","metadata":{},"name":"R919001_DEM_DAT.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R919001_DEM_DAT.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r920001_app\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r920001_app","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R920001_DEM_APP.DAT","metadata":{},"name":"R920001_DEM_APP.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R920001_DEM_APP.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r920001_cache\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r920001_cache","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R920001_CACHE.DAT","metadata":{},"name":"R920001_CACHE.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R920001_CACHE.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r920001_dat\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r920001_dat","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R920001_DEM_DAT.DAT","metadata":{},"name":"R920001_DEM_DAT.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R920001_DEM_DAT.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r921001_app\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r921001_app","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"990b3b68efd7361b63b812265273e6e9","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R921001_DEM_APP.DAT","metadata":{},"name":"R921001_DEM_APP.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R921001_DEM_APP.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r921001_cache\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r921001_cache","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R921001_CACHE.DAT","metadata":{},"name":"R921001_CACHE.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R921001_CACHE.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_db_r921001_dat\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_db_r921001_dat","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"32d5687c93135b78f4376985a9836c19","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R921001_DEM_DAT.DAT","metadata":{},"name":"R921001_DEM_DAT.DAT","storage_account_name":"stnbssukshubfile01","storage_container_name":"cache-db","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/cache-db/R921001_DEM_DAT.DAT"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"cache_restore_script\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"cache_restore_script","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"b97437710789a8afcdbb851cf343d0e1","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/scripts/restore_cache.ps1","metadata":{},"name":"restore_cache.ps1","storage_account_name":"stnbssukshubfile01","storage_container_name":"scripts","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/scripts/restore_cache.ps1"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"daybook_answer_file\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"daybook_answer_file","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"cfda2a0eca81f68ef51b0c1c5f5f3f59","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_Daybook.iss","metadata":{},"name":"NBSS_Daybook.iss","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_Daybook.iss"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"daybook_zip_2_4_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"daybook_zip_2_4_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"d9ee95cbf46032bf110173f32c2b59b5","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_Daybook_2_4_0.zip","metadata":{},"name":"NBSS_Daybook_2_4_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_Daybook_2_4_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"daybook_zip_2_5_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"daybook_zip_2_5_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"dd520e38f9729ae1dc94b49ab73b46c7","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_Daybook_2_5_0.zip","metadata":{},"name":"NBSS_Daybook_2_5_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_Daybook_2_5_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"file_share_connect_internal\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"file_share_connect_internal","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"e5e363f722de3bad7358b69f4fdd1aac","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/scripts/share_connect_internal.ps1","metadata":{},"name":"share_connect_internal.ps1","storage_account_name":"stnbssukshubfile01","storage_container_name":"scripts","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/scripts/share_connect_internal.ps1"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"msdn_library\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"msdn_library","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"65b603d9ee583f4eedc27da429b35049","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/vb6/en_msdn_library_october2001_dvd.exe","metadata":{},"name":"en_msdn_library_october2001_dvd.exe","storage_account_name":"stnbssukshubfile01","storage_container_name":"vb6","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/vb6/en_msdn_library_october2001_dvd.exe"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_answer_file\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_answer_file","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"d75f01f08c031bdc51564a4cee9f2d0a","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS.iss","metadata":{},"name":"NBSS.iss","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS.iss"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_answer_file_upgrade\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_answer_file_upgrade","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"e10948c68e4b3d812ff0ef6f62612af1","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS-upgrade.iss","metadata":{},"name":"NBSS-upgrade.iss","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS-upgrade.iss"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_odbc\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_odbc","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"29598bec4c60f5f9c877647d18d58dd5","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSSODBC.exe","metadata":{},"name":"NBSSODBC.exe","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSSODBC.exe"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_odbc_answer_file\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_odbc_answer_file","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"b63f49cc4992441f75befafe60586065","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSSODBC.iss","metadata":{},"name":"NBSSODBC.iss","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSSODBC.iss"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_templates\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_templates","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"98a8134df124efaf0c3c9d6f887aa98f","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS-Templates.zip","metadata":{},"name":"NBSS-Templates.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS-Templates.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_zip\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_zip","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"846108a90d4161a647d1049d826a2be3","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS.zip","metadata":{},"name":"NBSS.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_zip_4_1_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_zip_4_1_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"846108a90d4161a647d1049d826a2be3","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_4_1_0.zip","metadata":{},"name":"NBSS_4_1_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_4_1_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_zip_4_2_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_zip_4_2_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"52c7e9623abaed6f2aa5464f85bdcdc0","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_4_2_0.zip","metadata":{},"name":"NBSS_4_2_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_4_2_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_zip_5_0_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_zip_5_0_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"16cc0b42b13d7607e3f810dd617c24b8","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_5_0_0.zip","metadata":{},"name":"NBSS_5_0_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_5_0_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_zip_thin_4_1_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_zip_thin_4_1_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"471552f87acc196d1d4e5925b4e38aa1","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_THIN_4_1_0.zip","metadata":{},"name":"NBSS_THIN_4_1_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_THIN_4_1_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_zip_thin_4_2_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_zip_thin_4_2_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"e0eb31918a8ae102233226799a1788a3","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_THIN_4_2_0.zip","metadata":{},"name":"NBSS_THIN_4_2_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_THIN_4_2_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"nbss_zip_thin_5_0_0\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"nbss_zip_thin_5_0_0","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"33d5d07a08cd58f2aa2ec80a251823dd","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_THIN_5_0_0.zip","metadata":{},"name":"NBSS_THIN_5_0_0.zip","storage_account_name":"stnbssukshubfile01","storage_container_name":"nbss","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/nbss/NBSS_THIN_5_0_0.zip"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"start_stop_script\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"start_stop_script","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"0dba198302b7a2e861ffa53a6c280f7c","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/scripts/vm_auto_start_stop.ps1","metadata":{},"name":"vm_auto_start_stop.ps1","storage_account_name":"stnbssukshubfile01","storage_container_name":"scripts","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/scripts/vm_auto_start_stop.ps1"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"vb6_iso\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"vb6_iso","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"d2158f8c0c0c65aaef923096d5514a65","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/vb6/en_vb6_ent_cd1.iso","metadata":{},"name":"en_vb6_ent_cd1.iso","storage_account_name":"stnbssukshubfile01","storage_container_name":"vb6","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/vb6/en_vb6_ent_cd1.iso"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"vb6_kb3096896\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"vb6_kb3096896","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"e796cedbb8284c0314beb1b4ed1ee7dc","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/vb6/VB60SP6-KB3096896-x86-ENU.msi","metadata":{},"name":"VB60SP6-KB3096896-x86-ENU.msi","storage_account_name":"stnbssukshubfile01","storage_container_name":"vb6","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/vb6/VB60SP6-KB3096896-x86-ENU.msi"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"vb6_sp6\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"vb6_sp6","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"21b05942ec8a51be69b5ab800c61b385","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/vb6/Vs6sp6B.exe","metadata":{},"name":"Vs6sp6B.exe","storage_account_name":"stnbssukshubfile01","storage_container_name":"vb6","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/vb6/Vs6sp6B.exe"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"vb6_stf\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"vb6_stf","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"7c9eb211c1ea80073aa91cfb8d7b89fb","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/vb6/ACMSETUP.STF","metadata":{},"name":"ACMSETUP.STF","storage_account_name":"stnbssukshubfile01","storage_container_name":"vb6","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/vb6/ACMSETUP.STF"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"]","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","index":"windows_configure_script","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access_tier":"Hot","content_md5":"0d6738cc8bb1921d30f13c5a5104e4f0","content_type":"application/octet-stream","id":"https://stnbssukshubfile01.blob.core.windows.net/scripts/vm_windows_configure.ps1","metadata":{},"name":"vm_windows_configure.ps1","storage_account_name":"stnbssukshubfile01","storage_container_name":"scripts","timeouts":null,"type":"Block","url":"https://stnbssukshubfile01.blob.core.windows.net/scripts/vm_windows_configure.ps1"},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"bomgar\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"bomgar","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/bomgar","metadata":{},"name":"bomgar","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/bomgar","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"build_nbss\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"build_nbss","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/build-nbss","metadata":{},"name":"build-nbss","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/build-nbss","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"cache\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"cache","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/cache","metadata":{},"name":"cache","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/cache","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"cache_db\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"cache_db","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/cache-db","metadata":{},"name":"cache-db","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/cache-db","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"iris\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"iris","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/iris","metadata":{},"name":"iris","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/iris","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"nbss\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"nbss","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/nbss","metadata":{},"name":"nbss","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/nbss","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"scripts\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"scripts","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/scripts","metadata":{},"name":"scripts","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/scripts","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_storage_container.file[\"vb6\"]","mode":"data","type":"azurerm_storage_container","name":"file","index":"vb6","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"container_access_type":"container","has_immutability_policy":false,"has_legal_hold":false,"id":"https://stnbssukshubfile01.blob.core.windows.net/vb6","metadata":{},"name":"vb6","resource_manager_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-file-01/providers/Microsoft.Storage/storageAccounts/stnbssukshubfile01/blobServices/default/containers/vb6","storage_account_name":"stnbssukshubfile01","timeouts":null},"sensitive_values":{"metadata":{}}},{"address":"data.azurerm_subnet.hub[\"aadds\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"aadds","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.7.192/27","address_prefixes":["10.10.7.192/27"],"enforce_private_link_endpoint_network_policies":false,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/AzureDomainServicesSubnet","name":"AzureDomainServicesSubnet","network_security_group_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/networkSecurityGroups/nsg-AzureDomainServicesSubnet","private_endpoint_network_policies_enabled":true,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"","service_endpoints":[],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[]}},{"address":"data.azurerm_subnet.hub[\"backend\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"backend","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.0.128/25","address_prefixes":["10.10.0.128/25"],"enforce_private_link_endpoint_network_policies":true,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/BackendSubnet","name":"BackendSubnet","network_security_group_id":"","private_endpoint_network_policies_enabled":false,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/routeTables/rt-nbss-uks-hub-afw-01","service_endpoints":[],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[]}},{"address":"data.azurerm_subnet.hub[\"bastion\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"bastion","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.7.224/27","address_prefixes":["10.10.7.224/27"],"enforce_private_link_endpoint_network_policies":false,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/AzureBastionSubnet","name":"AzureBastionSubnet","network_security_group_id":"","private_endpoint_network_policies_enabled":true,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"","service_endpoints":[],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[]}},{"address":"data.azurerm_subnet.hub[\"cloud_shell\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"cloud_shell","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.6.0/26","address_prefixes":["10.10.6.0/26"],"enforce_private_link_endpoint_network_policies":false,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/CloudShellSubnet","name":"CloudShellSubnet","network_security_group_id":"","private_endpoint_network_policies_enabled":true,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"","service_endpoints":["Microsoft.Storage"],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[false]}},{"address":"data.azurerm_subnet.hub[\"firewall\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"firewall","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.7.64/26","address_prefixes":["10.10.7.64/26"],"enforce_private_link_endpoint_network_policies":false,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/AzureFirewallSubnet","name":"AzureFirewallSubnet","network_security_group_id":"","private_endpoint_network_policies_enabled":true,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"","service_endpoints":[],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[]}},{"address":"data.azurerm_subnet.hub[\"gateway\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"gateway","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.7.0/26","address_prefixes":["10.10.7.0/26"],"enforce_private_link_endpoint_network_policies":false,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/GatewaySubnet","name":"GatewaySubnet","network_security_group_id":"","private_endpoint_network_policies_enabled":true,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"","service_endpoints":[],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[]}},{"address":"data.azurerm_subnet.hub[\"management\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"management","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.0.0/25","address_prefixes":["10.10.0.0/25"],"enforce_private_link_endpoint_network_policies":true,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/ManagementSubnet","name":"ManagementSubnet","network_security_group_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/networkSecurityGroups/ManagementSubnet-nsg","private_endpoint_network_policies_enabled":false,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/routeTables/rt-nbss-uks-hub-afw-01","service_endpoints":[],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[]}},{"address":"data.azurerm_subnet.hub[\"relay\"]","mode":"data","type":"azurerm_subnet","name":"hub","index":"relay","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefix":"10.10.6.64/26","address_prefixes":["10.10.6.64/26"],"enforce_private_link_endpoint_network_policies":true,"enforce_private_link_service_network_policies":false,"id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01/subnets/RelaySubnet","name":"RelaySubnet","network_security_group_id":"","private_endpoint_network_policies_enabled":false,"private_link_service_network_policies_enabled":true,"resource_group_name":"rg-nbss-uks-hub-net-01","route_table_id":"","service_endpoints":[],"timeouts":null,"virtual_network_name":"vnet-nbss-uks-hub-01"},"sensitive_values":{"address_prefixes":[false],"service_endpoints":[]}},{"address":"data.azurerm_subscription.current","mode":"data","type":"azurerm_subscription","name":"current","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"display_name":"NHS NBSS","id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9","location_placement_id":"Public_2014-09-01","quota_id":"EnterpriseAgreement_2014-09-01","spending_limit":"Off","state":"Enabled","subscription_id":"6d5bd336-c7a4-4887-8715-8b82eb0eeac9","tags":{"CostCenter":"NBSS UK Managed Services","Owner":"james.bland@hitachivantara.com"},"tenant_id":"938d617d-7cdc-4912-a45f-315ff6b87aaa","timeouts":null},"sensitive_values":{"tags":{}}},{"address":"data.azurerm_virtual_network.devops","mode":"data","type":"azurerm_virtual_network","name":"devops","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_space":["10.240.0.0/23"],"dns_servers":["10.10.7.196","10.10.7.197"],"guid":"4a327e34-b6a0-41a4-a44f-6bc8faabbde1","id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-ado-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-ado-01","location":"uksouth","name":"vnet-nbss-uks-ado-01","resource_group_name":"rg-nbss-uks-ado-net-01","subnets":["AgentsSubnet","BackendSubnet"],"tags":{"environment":"DevOps","service":"DevOps"},"timeouts":null,"vnet_peerings":{"vnet-nbss-uks-ait-02":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-ait-net-02/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-ait-02","vnet-nbss-uks-dev-50":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-dev-net-50/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-dev-50","vnet-nbss-uks-env-01":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-env-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-env-01","vnet-nbss-uks-hub-01":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01","vnet-nbss-uks-mod-txet-001":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-vnet-nbss-uks-mod-txet-001/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-mod-txet-001","vnet-nbss-uks-pre-10":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-pre-net-10/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-pre-10","vnet-nbss-uks-sbx-51":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-sbx-net-51/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-sbx-51","vnet-nbss-uks-trn-02":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-trn-net-02/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-trn-02","vnet-nbss-uks-tst-22":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-net-22/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-22","vnet-nbss-uks-tst-30":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-net-30/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-30","vnet-nbss-uks-tst-31":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-net-31/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-31"},"vnet_peerings_addresses":["10.10.0.0/21","10.11.3.16/28","10.11.2.80/28","10.11.1.208/28","10.11.4.16/28","10.11.5.160/28","10.11.2.96/28","10.11.1.144/28","10.11.2.144/28","10.10.128.0/17","10.20.0.0/21"]},"sensitive_values":{"address_space":[false],"dns_servers":[false,false],"subnets":[false,false],"tags":{},"vnet_peerings":{},"vnet_peerings_addresses":[false,false,false,false,false,false,false,false,false,false,false]}},{"address":"data.azurerm_virtual_network.hub","mode":"data","type":"azurerm_virtual_network","name":"hub","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_space":["10.10.0.0/21"],"dns_servers":["10.10.7.196","10.10.7.197"],"guid":"5471e7c0-847c-4985-862f-6c9bfee298dc","id":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-hub-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-hub-01","location":"uksouth","name":"vnet-nbss-uks-hub-01","resource_group_name":"rg-nbss-uks-hub-net-01","subnets":["CloudShellSubnet","RelaySubnet","AzureBastionSubnet","GatewaySubnet","AzureFirewallSubnet","AzureDomainServicesSubnet","ManagementSubnet","BackendSubnet"],"tags":{"environment":"Hub","service":"Core"},"timeouts":null,"vnet_peerings":{"vnet-nbss-uks-ado-01":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-ado-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-ado-01","vnet-nbss-uks-ait-02":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-ait-net-02/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-ait-02","vnet-nbss-uks-dev-50":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-dev-net-50/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-dev-50","vnet-nbss-uks-env-01":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-env-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-env-01","vnet-nbss-uks-mod-txet-001":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-vnet-nbss-uks-mod-txet-001/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-mod-txet-001","vnet-nbss-uks-pre-10":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-pre-net-10/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-pre-10","vnet-nbss-uks-sbx-50":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-sbx-net-50/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-sbx-50","vnet-nbss-uks-sbx-51":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-sbx-net-51/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-sbx-51","vnet-nbss-uks-sup-01":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-sup-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-sup-01","vnet-nbss-uks-trn-02":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-trn-net-02/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-trn-02","vnet-nbss-uks-tst-22":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-net-22/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-22","vnet-nbss-uks-tst-23":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-net-23/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-23","vnet-nbss-uks-tst-30":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-net-30/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-30","vnet-nbss-uks-tst-31":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-net-31/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-31","vnet-nbss-uks-tst-32":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-tst-vm-32/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-tst-32","vnet-nbss-uks-uat-01":"/subscriptions/6d5bd336-c7a4-4887-8715-8b82eb0eeac9/resourceGroups/rg-nbss-uks-uat-net-01/providers/Microsoft.Network/virtualNetworks/vnet-nbss-uks-uat-01"},"vnet_peerings_addresses":["10.240.0.0/23","10.11.1.0/28","10.11.5.144/28","10.11.3.16/28","10.11.1.224/28","10.11.2.80/28","10.11.1.208/28","10.11.4.16/28","10.11.5.160/28","10.11.2.96/28","10.11.1.144/28","10.11.2.144/28","10.10.128.0/17","10.10.16.0/24","10.11.4.160/28","10.11.4.96/28","10.20.0.0/21"]},"sensitive_values":{"address_space":[false],"dns_servers":[false,false],"subnets":[false,false,false,false,false,false,false,false],"tags":{},"vnet_peerings":{},"vnet_peerings_addresses":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]}},{"address":"data.external.env","mode":"data","type":"external","name":"env","provider_name":"registry.terraform.io/hashicorp/external","schema_version":0,"values":{"id":"-","program":["jq","-n","env"],"query":null,"result":{"AGENT_ACCEPTTEEEULA":"True","AGENT_BUILDDIRECTORY":"/agent/_work/1","AGENT_CLOUDID":"","AGENT_DISABLELOGPLUGIN_TESTFILEPUBLISHERPLUGIN":"true","AGENT_DISABLELOGPLUGIN_TESTRESULTLOGPLUGIN":"true","AGENT_HOMEDIRECTORY":"/agent","AGENT_ID":"1251","AGENT_ISSELFHOSTED":"1","AGENT_JOBNAME":"Terraform Plan","AGENT_JOBSTATUS":"Succeeded","AGENT_LOGTOBLOBSTORAGESERVICE":"true","AGENT_MACHINENAME":"vmss-nbss-uks-hub-azdo-linux-010000TN","AGENT_NAME":"vmss-nbss-uks-hub-azdo-linux-010000TN","AGENT_OS":"Linux","AGENT_OSARCHITECTURE":"X64","AGENT_READONLYVARIABLES":"true","AGENT_RETAINDEFAULTENCODING":"false","AGENT_ROOTDIRECTORY":"/agent/_work","AGENT_TASKRESTRICTIONSENFORCEMENTMODE":"Enabled","AGENT_TEMPDIRECTORY":"/agent/_work/_temp","AGENT_TOOLSDIRECTORY":"/agent/_work/_tool","AGENT_UPLOADBUILDARTIFACTSTOBLOB":"true","AGENT_UPLOADTIMELINEATTACHMENTSTOBLOB":"true","AGENT_USEWORKSPACEID":"true","AGENT_VERSION":"3.220.5","AGENT_WORKFOLDER":"/agent/_work","ARM_CLIENT_ID":"81c4f3a4-74a2-48f8-b581-4b8930dc1e74","ARM_CLIENT_SECRET":"aG38Q~0QgM1FwZFzILwbyTn9531Ygvj647AINcNf","ARM_SUBSCRIPTION_ID":"6d5bd336-c7a4-4887-8715-8b82eb0eeac9","ARM_TENANT_ID":"938d617d-7cdc-4912-a45f-315ff6b87aaa","AZURE_CONFIG_DIR":"/agent/_work/_temp/.azclitask","AZURE_GUEST_AGENT_CONTAINER_ID":"57edf652-bac7-4da4-be24-9f5df9d9f85d","AZURE_GUEST_AGENT_EXTENSION_PATH":"/var/lib/waagent/Microsoft.VisualStudio.Services.TeamServicesAgentLinux-1.23.0.1","AZURE_GUEST_AGENT_EXTENSION_SUPPORTED_FEATURES":"[{\"Key\": \"ExtensionTelemetryPipeline\", \"Value\": \"1.0\"}]","AZURE_GUEST_AGENT_EXTENSION_VERSION":"1.23.0.1","AZURE_GUEST_AGENT_UNINSTALL_CMD_EXIT_CODE":"NOT_RUN","AZURE_GUEST_AGENT_WIRE_PROTOCOL_ADDRESS":"168.63.129.16","AZURE_HTTP_USER_AGENT":"VSTS_8b670450-0d67-467f-8728-6279a6f1c640_build_39_0","BUILD_ARTIFACTSTAGINGDIRECTORY":"/agent/_work/1/a","BUILD_BINARIESDIRECTORY":"/agent/_work/1/b","BUILD_BUILDID":"3738","BUILD_BUILDNUMBER":"deploy-iac.191.6","BUILD_BUILDURI":"vstfs:///Build/Build/3738","BUILD_CONTAINERID":"30128322","BUILD_DEFINITIONFOLDERPATH":"\\IaC","BUILD_DEFINITIONNAME":"deploy-iac","BUILD_DEFINITIONVERSION":"3","BUILD_QUEUEDBY":"Sergi Asensio","BUILD_QUEUEDBYID":"cf088f1d-1b77-686e-a6ad-2e6d80544383","BUILD_REASON":"Manual","BUILD_REPOSITORY_CLEAN":"True","BUILD_REPOSITORY_GIT_SUBMODULECHECKOUT":"False","BUILD_REPOSITORY_ID":"e1a10862-6d08-42f9-b85e-d2a1eccbde39","BUILD_REPOSITORY_LOCALPATH":"/agent/_work/1/s","BUILD_REPOSITORY_NAME":"Modernisation","BUILD_REPOSITORY_PROVIDER":"TfsGit","BUILD_REPOSITORY_URI":"https://hvnbss@dev.azure.com/hvnbss/Modernisation/_git/Modernisation","BUILD_REQUESTEDFOR":"Sergi Asensio","BUILD_REQUESTEDFOREMAIL":"sergi.asensio@hvnbss.onmicrosoft.com","BUILD_REQUESTEDFORID":"cf088f1d-1b77-686e-a6ad-2e6d80544383","BUILD_SOURCEBRANCH":"refs/heads/infra","BUILD_SOURCEBRANCHNAME":"infra","BUILD_SOURCESDIRECTORY":"/agent/_work/1/s","BUILD_SOURCEVERSION":"e8e57926e62803503748215ad343b4e6924d3d9a","BUILD_SOURCEVERSIONAUTHOR":"Sergi Asensio","BUILD_SOURCEVERSIONMESSAGE":"added environment to pipelines","BUILD_STAGINGDIRECTORY":"/agent/_work/1/a","COMMON_TESTRESULTSDIRECTORY":"/agent/_work/1/TestResults","ConfigSequenceNumber":"5588","DEVOPS_PROJECT":"nbss","DEVOPS_URL":"https://dev.azure.com/hvnbss","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63":"{\"environment\":\"AzureCloud\",\"scopeLevel\":\"Subscription\",\"subscriptionId\":\"6d5bd336-c7a4-4887-8715-8b82eb0eeac9\",\"subscriptionName\":\"NHS NBSS\",\"creationMode\":\"Manual\",\"environmentUrl\":\"https://management.azure.com/\",\"galleryUrl\":\"https://gallery.azure.com/\",\"serviceManagementUrl\":\"https://management.core.windows.net/\",\"resourceManagerUrl\":\"https://management.azure.com/\",\"activeDirectoryAuthority\":\"https://login.microsoftonline.com/\",\"environmentAuthorityUrl\":\"https://login.windows.net/\",\"graphUrl\":\"https://graph.windows.net/\",\"microsoftGraphUrl\":\"https://graph.microsoft.com/\",\"managementPortalUrl\":\"https://manage.windowsazure.com/\",\"armManagementPortalUrl\":\"https://portal.azure.com/\",\"activeDirectoryServiceEndpointResourceId\":\"https://management.core.windows.net/\",\"sqlDatabaseDnsSuffix\":\".database.windows.net\",\"AzureKeyVaultDnsSuffix\":\"vault.azure.net\",\"AzureKeyVaultServiceEndpointResourceId\":\"https://vault.azure.net\",\"StorageEndpointSuffix\":\"core.windows.net\",\"EnableAdfsAuthentication\":\"false\"}","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_ACTIVEDIRECTORYAUTHORITY":"https://login.microsoftonline.com/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_ACTIVEDIRECTORYSERVICEENDPOINTRESOURCEID":"https://management.core.windows.net/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_ARMMANAGEMENTPORTALURL":"https://portal.azure.com/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_AZUREKEYVAULTDNSSUFFIX":"vault.azure.net","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_AZUREKEYVAULTSERVICEENDPOINTRESOURCEID":"https://vault.azure.net","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_CREATIONMODE":"Manual","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_ENABLEADFSAUTHENTICATION":"false","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_ENVIRONMENT":"AzureCloud","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_ENVIRONMENTAUTHORITYURL":"https://login.windows.net/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_ENVIRONMENTURL":"https://management.azure.com/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_GALLERYURL":"https://gallery.azure.com/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_GRAPHURL":"https://graph.windows.net/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_MANAGEMENTPORTALURL":"https://manage.windowsazure.com/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_MICROSOFTGRAPHURL":"https://graph.microsoft.com/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_RESOURCEMANAGERURL":"https://management.azure.com/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_SCOPELEVEL":"Subscription","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_SERVICEMANAGEMENTURL":"https://management.core.windows.net/","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_SQLDATABASEDNSSUFFIX":".database.windows.net","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_STORAGEENDPOINTSUFFIX":"core.windows.net","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_SUBSCRIPTIONID":"6d5bd336-c7a4-4887-8715-8b82eb0eeac9","ENDPOINT_DATA_8c7fcb22-545e-48f8-b5fc-244d8f436d63_SUBSCRIPTIONNAME":"NHS NBSS","ENDPOINT_URL_8c7fcb22-545e-48f8-b5fc-244d8f436d63":"https://management.azure.com/","ENDPOINT_URL_SYSTEMVSSCONNECTION":"https://dev.azure.com/hvnbss/","GIT_TERMINAL_PROMPT":"0","HOME":"/home/AzDevOps","INPUT_SCRIPTARGUMENTS":"","INVOCATION_ID":"52f79685d8ef4574b29ffcec6c270d13","JOURNAL_STREAM":"8:23522","LANG":"C.UTF-8","LOGFILE":"/var/log/azure/Microsoft.VisualStudio.Services.TeamServicesAgentLinux/enableagent.log","LOGNAME":"AzDevOps","MSDEPLOY_HTTP_USER_AGENT":"VSTS_8b670450-0d67-467f-8728-6279a6f1c640_build_39_0","OLDPWD":"/agent/_work/1/s","PATH":"/agent/_work/_tool/terraform/1.4.1/x64:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin","PIPELINE_WORKSPACE":"/agent/_work/1","PLUGIN_CLIENT_CERT":"-----BEGIN CERTIFICATE-----\nMIICTjCCAbCgAwIBAgIQRjGqfFwOAjfMGvILIkc68TAKBggqhkjOPQQDBDAoMRIw\nEAYDVQQKEwlIYXNoaUNvcnAxEjAQBgNVBAMTCWxvY2FsaG9zdDAgFw0yMzA3MTAw\nNzUzMTVaGA8yMDUzMDcwOTE5NTM0NVowKDESMBAGA1UEChMJSGFzaGlDb3JwMRIw\nEAYDVQQDEwlsb2NhbGhvc3QwgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAExL3of\nXFnfbgNISYYWilq7L7Wdn7SG7py62I/R8FU8OzOFKIlqwfiza53MMvoI5wFdxPuS\nXHNK6sLRlsz1o0PnEgAK1XCHonWsNNAnsJCo0IBALPOlWAs7PHi1kyC2y/u8q/E6\nOlbR97EdqJS6+vxkx/YkiCubepWQhcYS0Gf+YAW2C6N3MHUwDgYDVR0PAQH/BAQD\nAgKsMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATAPBgNVHRMBAf8EBTAD\nAQH/MB0GA1UdDgQWBBSkZGfKlwR34TLkdncCCyAiguWMZDAUBgNVHREEDTALggls\nb2NhbGhvc3QwCgYIKoZIzj0EAwQDgYsAMIGHAkFihSdNtmO5T1OO0dgOaTdAcW6D\nqlsziEZP1wpUFv3TsxyywXodb/+mdi6JGlVOHRsuqZJEkmqz0/oNKkFVrBAY3QJC\nAVdZI4Di78bOzK3pzDP4xYC4cHmF4SJdqR0XdongjeDQAx9ubrxRA1DY73gfn7sv\nxXfvENA7yy1rqCGR8TrRbu12\n-----END CERTIFICATE-----\n","PLUGIN_MAX_PORT":"25000","PLUGIN_MIN_PORT":"10000","PLUGIN_PROTOCOL_VERSIONS":"5,6","PWD":"/agent/_work/1/s/iac_mod/terraform","RESOURCES_TRIGGERINGALIAS":"","RESOURCES_TRIGGERINGCATEGORY":"","SERVICE_CONNECTION":"Service - Infrastructure as Code","SGX_AESM_ADDR":"1","SHELL":"/bin/bash","SHLVL":"3","STATE_BLOB_NAME":"mod-dev-1.tfstate","STATE_CONTAINER":"tfstate","STATE_RESOURCE_GROUP":"rg-nbss-uks-ado-tfstate-01","STATE_STORAGE_ACCOUNT":"stnbssuksadotfstate01","SUDO_COMMAND":"/usr/bin/nice -n 0 runuser AzDevOps -c /bin/bash /agent/run.sh ","SUDO_GID":"0","SUDO_UID":"0","SUDO_USER":"root","SYSTEM":"build","SYSTEM_ARTIFACTSDIRECTORY":"/agent/_work/1/a","SYSTEM_COLLECTIONID":"8b670450-0d67-467f-8728-6279a6f1c640","SYSTEM_COLLECTIONURI":"https://dev.azure.com/hvnbss/","SYSTEM_CULTURE":"en-US","SYSTEM_DEFAULTWORKINGDIRECTORY":"/agent/_work/1/s","SYSTEM_DEFINITIONID":"39","SYSTEM_DEFINITIONNAME":"deploy-iac","SYSTEM_ENABLEACCESSTOKEN":"SecretVariable","SYSTEM_HOSTTYPE":"build","SYSTEM_ISAZUREVM":"1","SYSTEM_ISDOCKERCONTAINER":"0","SYSTEM_ISSCHEDULED":"False","SYSTEM_JOBATTEMPT":"1","SYSTEM_JOBDISPLAYNAME":"Terraform Plan","SYSTEM_JOBID":"9ae1dbbe-1d52-5a57-1af5-5b4d5c836546","SYSTEM_JOBIDENTIFIER":"Plan.Terraform_Plan.__default","SYSTEM_JOBNAME":"__default","SYSTEM_JOBPARALLELISMTAG":"Private","SYSTEM_JOBPOSITIONINPHASE":"1","SYSTEM_JOBTIMEOUT":"60","SYSTEM_PHASEATTEMPT":"1","SYSTEM_PHASEDISPLAYNAME":"Terraform Plan","SYSTEM_PHASEID":"c1db9a5f-7db6-5fb7-31a9-2d0991add9f1","SYSTEM_PHASENAME":"Terraform_Plan","SYSTEM_PIPELINESTARTTIME":"2023-07-10 08:53:18+01:00","SYSTEM_PLANID":"ec453247-5ec6-43a6-aa9a-49cf1a45d2d5","SYSTEM_POSTLINESSPEED":"500","SYSTEM_PULLREQUEST_ISFORK":"False","SYSTEM_SERVERTYPE":"Hosted","SYSTEM_STAGEATTEMPT":"1","SYSTEM_STAGEDISPLAYNAME":"Plan","SYSTEM_STAGEID":"c9bd906c-8296-5bac-0166-0b307c26c45c","SYSTEM_STAGENAME":"Plan","SYSTEM_TASKDEFINITIONSURI":"https://dev.azure.com/hvnbss/","SYSTEM_TASKDISPLAYNAME":"Terraform Plan","SYSTEM_TASKINSTANCEID":"7368fc4c-4a33-5263-b3dc-8060d7e02b31","SYSTEM_TASKINSTANCENAME":"AzureCLI2","SYSTEM_TEAMFOUNDATIONCOLLECTIONURI":"https://dev.azure.com/hvnbss/","SYSTEM_TEAMFOUNDATIONSERVERURI":"https://dev.azure.com/hvnbss/","SYSTEM_TEAMPROJECT":"Modernisation","SYSTEM_TEAMPROJECTID":"c9939a22-44cd-4c66-9895-7bfa0bcfb91c","SYSTEM_TIMELINEID":"ec453247-5ec6-43a6-aa9a-49cf1a45d2d5","SYSTEM_TOTALJOBSINPHASE":"1","SYSTEM_WORKFOLDER":"/agent/_work","TASK_DISPLAYNAME":"Terraform Plan","TASK_SKIPTRANSLATORFORCHECKOUT":"False","TERM":"unknown","TERRAFORMINSTALLER_TERRAFORMLOCATION":"/agent/_work/_tool/terraform/1.4.1/x64/terraform","TERRAFORM_VERSION":"1.4.1","TF_BUILD":"True","TF_PLUGIN_MAGIC_COOKIE":"d602bf8f470bc67ca7faa0386276bbdd4330efaf76d1a219cb4d6991ca9872b2","USER":"AzDevOps","USE_MSAL":"true","VSTSAGENT_CONTINUE_AFTER_CANCEL_PROCESSTREEKILL_ATTEMPT":"true","VSTSAGENT_DOCKER_ACTION_RETRIES":"true","VSTS_PROCESS_LOOKUP_ID":"vsts_84d5a74e-b90d-4319-8d0e-b2621ab782f5","_":"/agent/_work/_tool/terraform/1.4.1/x64/terraform","agent.jobstatus":"Succeeded","servicePrincipalId":"81c4f3a4-74a2-48f8-b581-4b8930dc1e74","servicePrincipalKey":"aG38Q~0QgM1FwZFzILwbyTn9531Ygvj647AINcNf","tenantId":"938d617d-7cdc-4912-a45f-315ff6b87aaa"},"working_dir":null},"sensitive_values":{"program":[false,false,false],"result":{}}},{"address":"data.http.myip","mode":"data","type":"http","name":"myip","provider_name":"registry.terraform.io/hashicorp/http","schema_version":0,"values":{"body":"20.117.86.197\n","id":"http://ipv4.icanhazip.com","request_headers":null,"response_headers":{"Access-Control-Allow-Methods":"GET","Access-Control-Allow-Origin":"*","Alt-Svc":"h3=\":443\"; ma=86400","Cf-Ray":"7e473c1f5b9623b2-LHR","Connection":"keep-alive","Content-Length":"14","Content-Type":"text/plain","Date":"Mon, 10 Jul 2023 07:53:46 GMT","Server":"cloudflare","Set-Cookie":"__cf_bm=XwNj9RnP9RYKW83dO_pc2Dh.1mNsFNAug0uKKaeVv0k-1688975626-0-AZRPJhD3QGechv8VM3sPLg6+Zj5mz1JQ1lcsmlAsd3GDsgRjCMdGIMHEvNtjdJqSzdu3kbErsYc4XDhR6KJkcEk=; path=/; expires=Mon, 10-Jul-23 08:23:46 GMT; domain=.icanhazip.com; HttpOnly; SameSite=None","Vary":"Accept-Encoding"},"url":"http://ipv4.icanhazip.com"},"sensitive_values":{"response_headers":{}}},{"address":"data.local_file.vm_start_stop_runbook","mode":"data","type":"local_file","name":"vm_start_stop_runbook","provider_name":"registry.terraform.io/hashicorp/local","schema_version":0,"values":{"content":"workflow Auto-StartShutdown\n{\n  #################################################################################\n  # AUTHOR  : James Bland \u0026 David Sampson\n  # DATE    : 14/01/2022\n  # EDIT    : \n  # COMMENT : Starts or Stops VMs based on their AutoStartShut Tag\n  # VERSION : 1.3\n  #\n  # Changes\n  # 1.1: Updated to Az module\n  # 1.2: Improved Weekday Handling and turned to run Parallel for better performance\n  #      in large environments\n  # 1.3: Added in the AutoStartOrder tag and code to process this\n  #################################################################################\n\n\n  # Virtual machines need to have a tag assigned to them to automatically startup and switch off\n  # AutoStartShut = Start Hour,Shutdown Hour,Days\n  #\n  # Example: AutoStartShut = 07,19,Weekdays\n  #\n  # In this example the server will start up at 7am and shutdown at 7pm Mon - Fri UTC time\n  #\n  # You can specify multiple days if you put it with a | between so Monday|Wednesday|Friday is\n  # valid for Days\n  #\n  # NOTE: This is depending on the schedule of the RunBook and how long it takes to run so times\n  #       aren't exact.\n\n  # Virtual machines can also have a tag to group them into an Application Group along with a\n  # specific start up order.\n  # AutoStartOrder = Application Group,Order\n  #\n  # Example Server 1: AutoStartOrder = App1,2\n  # Example Server 2: AutoStartOrder = App1,1\n  #\n  # In this example we will start Server 2 first and then Server 1. When we do a Shutdown we will\n  # reverse this order so we will Shutdown Server 2 first and then Server 1.\n  #\n  # NOTE: This will only work if the AutoStartShut is set to the same time for all servers in the\n  # Application group\n\n  # Startup\n  Write-Output \"Azure VM Auto Start and Shutdown\"\n  Write-Output \"`r`n\"\n\n  # Connect to Azure using Managed Service Identity\n  try {  \n    Write-Output \"Connecting to Azure via Managed Service Identity of the Automation Account\" \n    Connect-AzAccount -Identity\n    Write-Output \"`r`nSuccessfully connected to Azure\" \n  }\n  catch {\n    Write-Error -Message $_.Exception\n    throw $_.Exception\n  }\n\n  # Get all the VMs you have in your Azure subscription which have scheduled startup / shutdown configured\n  $vms = Get-AzVM -Status | Where-Object {$_.Tags.ContainsKey(\"AutoStartShut\")}\n  $currentHour = Get-Date -Format HH\n\n  # If any VMs are found we loop through them\n  if (!$vms) {\n    Write-Output \"No VMs were found that have Auto Startup / Shutdown configured.\"\n  } else {\n    # Loop through the VM's and check if we need to start them or shut them down\n    ForEach -Parallel ($vm in $vms) {\n      # Get the VM Details\n      $vmName = $vm.Name\n      $vmRunning = $vm | Select-Object -ExpandProperty PowerState\n          \n      # Continue statements are not valid in a workflow so using a variable to see if we need to continue\n      $processServer = $true\n\n      # Get the Start and Shutdown hours plus if we need to run over weekends\n      $tagsSplit = $vm.Tags.AutoStartShut.Split(\",\")\n      if ($tagsSplit.Count -eq 3) {\n        $startHour = $tagsSplit[0]\n        $shutHour = $tagsSplit[1]\n        $runDays = $tagsSplit[2].Split(\"|\")\n      } else {\n        # We don't have the required parameters setup correctly on this VM so end this loop\n        Write-Output \"VM name: $vmName - AutoStartShut Tags not set correctly. Must be Start, Shut, Days\"\n        Write-Output \"Start = 24 hour representation as 2 digits so 7am would be 07\"\n        Write-Output \"Shut = 24 hour representation as 2 digits so 7pm would be 19\"\n        Write-Output \"Days = Monday, Tuesday etc. or Weekdays or All. You can have multiple days if you specify as Monday|Wednesday|Friday with a | between days.\"\n        Write-Output \"Example: AutoStartShut = 07,19,Weekdays or AutoStartShut = 07,19,Monday\"\n        $processServer = $false\n      }\n\n      # Check if the Start hour is set correctly\n      if (!(($startHour -ge \"00\") -and ($startHour -le \"23\"))) {\n        Write-Output \"VM name: $vmName - Start hour is not between 00 and 23. Skipping this server\"\n        $processServer = $false\n      }\n\n      # Check if the End hour is set correctly\n      if (!(($shutHour -ge \"00\") -and ($shutHour -le \"23\"))) {\n        Write-Output \"VM name: $vmName - Shutdown hour is not between 00 and 23. Skipping this server\"\n        $processServer = $false\n      }\n\n      # Check if the Days to run is set correctly\n      if (!($runDays | Where-Object { \"Weekdays\", \"All\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\" -contains $_ })) {\n        Write-Output \"VM name: $vmName - Run Days is not set to Weekdays, All, or a day(s) of the week. Skipping this server\"\n        $processServer = $false\n      }\n\n      # Check for an AutoStartOrder tag\n      $vmsAppGroup = $false\n      $vmAutoStartOrder = $vm.Tags.ContainsKey(\"AutoStartOrder\")\n      if ($vmAutoStartOrder) {\n        # We have an order we need to shutdown, lets get all other VM's in the same application group\n        $tagsSplit = $vm.Tags.AutoStartOrder.Split(\",\")\n        if ($tagsSplit.Count -eq 2) {\n          $vmApp = $tagsSplit[0]\n          $vmStartOrder = $tagsSplit[1]\n\n          # Find any other VM's running the same application as we do\n          $vmsAppGroup = Get-AzVM -Status | Where-Object {$_.Tags.ContainsKey(\"AutoStartOrder\")} | Where-Object {$_.Tags.ContainsKey(\"AutoStartShut\")} | Where-Object {$_.Tags.AutoStartShut -eq $vm.Tags.AutoStartShut} | Where-Object {$_.Name -ne $vm.Name} | Where-Object {$_.Tags.AutoStartOrder.Split(\",\")[0] -eq $vmApp}\n        }\n        else {\n          # We don't have the required parameters setup correctly on this VM so end this loop\n          Write-Output \"VM name: $vmName - AutoStartOrder Tags not set correctly. Must be App, Order\"\n          Write-Output \"App = This is the application name we match with other VM's of the same name to then set a start / shut order\"\n          Write-Output \"Order = The order in this application group we start this VM, we will shutdown in reverse order\"\n          Write-Output \"Example: AutoStartOrder = App1,1\"\n          $processServer = $false\n        }\n      }\n\n      # Process the server if the tags are configured correctly\n      if ($processServer) {\n        # Check if the VM should be switched on now, True for on and False for off\n        $VmOnTime = (($currentHour -ge $startHour) -and ($currentHour -lt $shutHour))\n        Write-Output \"VM name: $vmName | VM on time: $VmOnTime | Current hour: $currentHour | VM start time: $startHour | VM shutdown time: $shutHour\"\n\n        # Default $vmOnDay to false\n        $vmOnDay = $false\n                        \n        # Get the current day\n        $day = (Get-Date).DayOfWeek\n        \n        # Check what day of the week it is and if we should be on on this day\n        if ($runDays -contains \"All\") {\n          Write-Output \"VM name: $vmName - Run days is all, so we need to process the server today\"\n          $vmOnDay = $true\n        }\n        elseif ($runDays -contains \"Weekdays\") {\n          if (($day -ne \"Saturday\") -and ($day -ne \"Sunday\")) {\n            Write-Output \"VM name: $vmName - Run days is weekdays and it's not a weekend so we need to process the server today\"\n            $vmOnDay = $true\n          }\n        }\n        elseif ($runDays -contains $day) {\n          Write-Output \"VM name: $vmName - It's $day so we need to process the server today\"\n          $vmOnDay = $true\n        }\n        \n        # Check to see if VM is on and we need to power it off\n        if (($vmRunning -eq \"VM running\") -and (!($VmOnTime)) -or (!($vmOnDay))) {\n          Write-Output \"VM name: $vmName ($vmRunning) | Day(s) to run: $vmOnDay | VM on time: $VmOnTime - We need to power this server off\"\n\n          # Check if we need to shutdown other servers first\n          if ($vmsAppGroup) {\n            Write-Output \"VM name: $vmName ($vmRunning) | Day(s) to run: $vmOnDay | VM on time: $VmOnTime | Startup Order: $vmStartOrder\"\n            $vmsShutDownFirst = $vmsAppGroup | Where-Object {$_.Tags.AutoStartOrder.Split(\",\")[1] -gt $vmStartOrder}\n\n            # Check to see if any other VMs need to be shutdown first\n            if ($vmsShutDownFirst) {\n              # Check if the VM's in the group are all shutdown\n              $vmsShutDownFirstWaiting = $true\n              while ($vmsShutDownFirstWaiting) {\n                # Check if any VMs we need to shutdown first are still running\n                $vmsShutDownFirstWaiting = $vmsShutDownFirst | Where-Object {$_.PowerState -eq \"VM running\"}\n                if ($vmsShutDownFirstWaiting) {\n                  # Wait for 60 seconds before we check again as not all servers are off\n                  Write-Output \"VM name: $vmName ($vmRunning) | Day(s) to run: $vmOnDay | VM on time: $VmOnTime - Waiting for other servers in the Application Group to Shutdown first\"\n                  Sleep 60\n                  # Refresh the status of the VM's in the Application Group we need to check PowerState on\n                  $vmsAppGroup = Get-AzVM -Status | Where-Object {$_.Tags.ContainsKey(\"AutoStartOrder\")} | Where-Object {$_.Tags.ContainsKey(\"AutoStartShut\")} | Where-Object {$_.Tags.AutoStartShut -eq $vm.Tags.AutoStartShut} | Where-Object {$_.Name -ne $vm.Name} | Where-Object {$_.Tags.AutoStartOrder.Split(\",\")[0] -eq $vmApp}\n                  $vmsShutDownFirst = $vmsAppGroup | Where-Object {$_.Tags.AutoStartOrder.Split(\",\")[1] -gt $vmStartOrder}\n                }\n              }\n            }\n          }\n\n          $shutStatus = $vm | Stop-AzVM -Force\n\n          # Check if the shutdown was successful\n          if ($shutStatus.Status -eq \"Succeeded\") {\n            Write-Output \"$vmName - Shutdown successfully\"\n          } else {\n            Write-Output \"$vmName - Failed to shutdown\"\n          }\n        } else {\n          # Check to see if the server is off and we need to power it on\n          if (($vmRunning -ne \"VM running\") -and $VmOnTime -and $vmOnDay) {\n            Write-Output \"VM name: $vmName ($vmRunning) | Day(s) to run: $vmOnDay | VM on time: $VmOnTime - We need to power this server on\"\n\n            # Check if we need to shutdown other servers first\n            if ($vmsAppGroup) {\n              Write-Output \"VM name: $vmName ($vmRunning) | Day(s) to run: $vmOnDay | VM on time: $VmOnTime | Startup Order: $vmStartOrder\"\n              $vmsStartUpFirst = $vmsAppGroup | Where-Object {$_.Tags.AutoStartOrder.Split(\",\")[1] -lt $vmStartOrder}\n\n              # Check to see if any other VMs need to be started up first\n              if ($vmsStartUpFirst) {\n                # Check if the VM's in the group are all started up\n                $vmsStartUpFirstWaiting = $true\n                while ($vmsStartUpFirstWaiting) {\n                  # Check if any VMs we need to startup first are still powered off\n                  $vmsStartUpFirstWaiting = $vmsStartUpFirst | Where-Object {$_.PowerState -ne \"VM running\"}\n                  if ($vmsStartUpFirstWaiting) {\n                    # Wait for 60 seconds before we check again as not all servers are started yet\n                    Write-Output \"VM name: $vmName ($vmRunning) | Day(s) to run: $vmOnDay | VM on time: $VmOnTime - Waiting for other servers in the Application Group to Startup first\"\n                    Sleep 60\n                    # Refresh the status of the VM's in the Application Group we need to check PowerState on\n                    $vmsAppGroup = Get-AzVM -Status | Where-Object {$_.Tags.ContainsKey(\"AutoStartOrder\")} | Where-Object {$_.Tags.ContainsKey(\"AutoStartShut\")} | Where-Object {$_.Tags.AutoStartShut -eq $vm.Tags.AutoStartShut} | Where-Object {$_.Name -ne $vm.Name} | Where-Object {$_.Tags.AutoStartOrder.Split(\",\")[0] -eq $vmApp}\n                    $vmsStartUpFirst = $vmsAppGroup | Where-Object {$_.Tags.AutoStartOrder.Split(\",\")[1] -lt $vmStartOrder}\n                  }\n                }\n              }\n            }\n\n            $startStatus = $vm | Start-AzVM\n\n            # Check if the startup was successful\n            if ($startStatus.Status -eq \"Succeeded\") {\n              Write-Output \"$vmName - Started successfully\"\n            } else {\n              Write-Output \"$vmName - Failed to start\"\n            }\n          } else {\n            Write-Output \"VM name: $vmName ($vmRunning) | Day(s) to run: $vmOnDay | VM on time: $VmOnTime - Server is in the correct PowerState\"\n          }\n        }\n      }\n    }\n  }\n}\n","content_base64":"d29ya2Zsb3cgQXV0by1TdGFydFNodXRkb3duCnsKICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAjIEFVVEhPUiAgOiBKYW1lcyBCbGFuZCAmIERhdmlkIFNhbXBzb24KICAjIERBVEUgICAgOiAxNC8wMS8yMDIyCiAgIyBFRElUICAgIDogCiAgIyBDT01NRU5UIDogU3RhcnRzIG9yIFN0b3BzIFZNcyBiYXNlZCBvbiB0aGVpciBBdXRvU3RhcnRTaHV0IFRhZwogICMgVkVSU0lPTiA6IDEuMwogICMKICAjIENoYW5nZXMKICAjIDEuMTogVXBkYXRlZCB0byBBeiBtb2R1bGUKICAjIDEuMjogSW1wcm92ZWQgV2Vla2RheSBIYW5kbGluZyBhbmQgdHVybmVkIHRvIHJ1biBQYXJhbGxlbCBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlCiAgIyAgICAgIGluIGxhcmdlIGVudmlyb25tZW50cwogICMgMS4zOiBBZGRlZCBpbiB0aGUgQXV0b1N0YXJ0T3JkZXIgdGFnIGFuZCBjb2RlIHRvIHByb2Nlc3MgdGhpcwogICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKCiAgIyBWaXJ0dWFsIG1hY2hpbmVzIG5lZWQgdG8gaGF2ZSBhIHRhZyBhc3NpZ25lZCB0byB0aGVtIHRvIGF1dG9tYXRpY2FsbHkgc3RhcnR1cCBhbmQgc3dpdGNoIG9mZgogICMgQXV0b1N0YXJ0U2h1dCA9IFN0YXJ0IEhvdXIsU2h1dGRvd24gSG91cixEYXlzCiAgIwogICMgRXhhbXBsZTogQXV0b1N0YXJ0U2h1dCA9IDA3LDE5LFdlZWtkYXlzCiAgIwogICMgSW4gdGhpcyBleGFtcGxlIHRoZSBzZXJ2ZXIgd2lsbCBzdGFydCB1cCBhdCA3YW0gYW5kIHNodXRkb3duIGF0IDdwbSBNb24gLSBGcmkgVVRDIHRpbWUKICAjCiAgIyBZb3UgY2FuIHNwZWNpZnkgbXVsdGlwbGUgZGF5cyBpZiB5b3UgcHV0IGl0IHdpdGggYSB8IGJldHdlZW4gc28gTW9uZGF5fFdlZG5lc2RheXxGcmlkYXkgaXMKICAjIHZhbGlkIGZvciBEYXlzCiAgIwogICMgTk9URTogVGhpcyBpcyBkZXBlbmRpbmcgb24gdGhlIHNjaGVkdWxlIG9mIHRoZSBSdW5Cb29rIGFuZCBob3cgbG9uZyBpdCB0YWtlcyB0byBydW4gc28gdGltZXMKICAjICAgICAgIGFyZW4ndCBleGFjdC4KCiAgIyBWaXJ0dWFsIG1hY2hpbmVzIGNhbiBhbHNvIGhhdmUgYSB0YWcgdG8gZ3JvdXAgdGhlbSBpbnRvIGFuIEFwcGxpY2F0aW9uIEdyb3VwIGFsb25nIHdpdGggYQogICMgc3BlY2lmaWMgc3RhcnQgdXAgb3JkZXIuCiAgIyBBdXRvU3RhcnRPcmRlciA9IEFwcGxpY2F0aW9uIEdyb3VwLE9yZGVyCiAgIwogICMgRXhhbXBsZSBTZXJ2ZXIgMTogQXV0b1N0YXJ0T3JkZXIgPSBBcHAxLDIKICAjIEV4YW1wbGUgU2VydmVyIDI6IEF1dG9TdGFydE9yZGVyID0gQXBwMSwxCiAgIwogICMgSW4gdGhpcyBleGFtcGxlIHdlIHdpbGwgc3RhcnQgU2VydmVyIDIgZmlyc3QgYW5kIHRoZW4gU2VydmVyIDEuIFdoZW4gd2UgZG8gYSBTaHV0ZG93biB3ZSB3aWxsCiAgIyByZXZlcnNlIHRoaXMgb3JkZXIgc28gd2Ugd2lsbCBTaHV0ZG93biBTZXJ2ZXIgMiBmaXJzdCBhbmQgdGhlbiBTZXJ2ZXIgMS4KICAjCiAgIyBOT1RFOiBUaGlzIHdpbGwgb25seSB3b3JrIGlmIHRoZSBBdXRvU3RhcnRTaHV0IGlzIHNldCB0byB0aGUgc2FtZSB0aW1lIGZvciBhbGwgc2VydmVycyBpbiB0aGUKICAjIEFwcGxpY2F0aW9uIGdyb3VwCgogICMgU3RhcnR1cAogIFdyaXRlLU91dHB1dCAiQXp1cmUgVk0gQXV0byBTdGFydCBhbmQgU2h1dGRvd24iCiAgV3JpdGUtT3V0cHV0ICJgcmBuIgoKICAjIENvbm5lY3QgdG8gQXp1cmUgdXNpbmcgTWFuYWdlZCBTZXJ2aWNlIElkZW50aXR5CiAgdHJ5IHsgIAogICAgV3JpdGUtT3V0cHV0ICJDb25uZWN0aW5nIHRvIEF6dXJlIHZpYSBNYW5hZ2VkIFNlcnZpY2UgSWRlbnRpdHkgb2YgdGhlIEF1dG9tYXRpb24gQWNjb3VudCIgCiAgICBDb25uZWN0LUF6QWNjb3VudCAtSWRlbnRpdHkKICAgIFdyaXRlLU91dHB1dCAiYHJgblN1Y2Nlc3NmdWxseSBjb25uZWN0ZWQgdG8gQXp1cmUiIAogIH0KICBjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAtTWVzc2FnZSAkXy5FeGNlcHRpb24KICAgIHRocm93ICRfLkV4Y2VwdGlvbgogIH0KCiAgIyBHZXQgYWxsIHRoZSBWTXMgeW91IGhhdmUgaW4geW91ciBBenVyZSBzdWJzY3JpcHRpb24gd2hpY2ggaGF2ZSBzY2hlZHVsZWQgc3RhcnR1cCAvIHNodXRkb3duIGNvbmZpZ3VyZWQKICAkdm1zID0gR2V0LUF6Vk0gLVN0YXR1cyB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5Db250YWluc0tleSgiQXV0b1N0YXJ0U2h1dCIpfQogICRjdXJyZW50SG91ciA9IEdldC1EYXRlIC1Gb3JtYXQgSEgKCiAgIyBJZiBhbnkgVk1zIGFyZSBmb3VuZCB3ZSBsb29wIHRocm91Z2ggdGhlbQogIGlmICghJHZtcykgewogICAgV3JpdGUtT3V0cHV0ICJObyBWTXMgd2VyZSBmb3VuZCB0aGF0IGhhdmUgQXV0byBTdGFydHVwIC8gU2h1dGRvd24gY29uZmlndXJlZC4iCiAgfSBlbHNlIHsKICAgICMgTG9vcCB0aHJvdWdoIHRoZSBWTSdzIGFuZCBjaGVjayBpZiB3ZSBuZWVkIHRvIHN0YXJ0IHRoZW0gb3Igc2h1dCB0aGVtIGRvd24KICAgIEZvckVhY2ggLVBhcmFsbGVsICgkdm0gaW4gJHZtcykgewogICAgICAjIEdldCB0aGUgVk0gRGV0YWlscwogICAgICAkdm1OYW1lID0gJHZtLk5hbWUKICAgICAgJHZtUnVubmluZyA9ICR2bSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFBvd2VyU3RhdGUKICAgICAgICAgIAogICAgICAjIENvbnRpbnVlIHN0YXRlbWVudHMgYXJlIG5vdCB2YWxpZCBpbiBhIHdvcmtmbG93IHNvIHVzaW5nIGEgdmFyaWFibGUgdG8gc2VlIGlmIHdlIG5lZWQgdG8gY29udGludWUKICAgICAgJHByb2Nlc3NTZXJ2ZXIgPSAkdHJ1ZQoKICAgICAgIyBHZXQgdGhlIFN0YXJ0IGFuZCBTaHV0ZG93biBob3VycyBwbHVzIGlmIHdlIG5lZWQgdG8gcnVuIG92ZXIgd2Vla2VuZHMKICAgICAgJHRhZ3NTcGxpdCA9ICR2bS5UYWdzLkF1dG9TdGFydFNodXQuU3BsaXQoIiwiKQogICAgICBpZiAoJHRhZ3NTcGxpdC5Db3VudCAtZXEgMykgewogICAgICAgICRzdGFydEhvdXIgPSAkdGFnc1NwbGl0WzBdCiAgICAgICAgJHNodXRIb3VyID0gJHRhZ3NTcGxpdFsxXQogICAgICAgICRydW5EYXlzID0gJHRhZ3NTcGxpdFsyXS5TcGxpdCgifCIpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgIyBXZSBkb24ndCBoYXZlIHRoZSByZXF1aXJlZCBwYXJhbWV0ZXJzIHNldHVwIGNvcnJlY3RseSBvbiB0aGlzIFZNIHNvIGVuZCB0aGlzIGxvb3AKICAgICAgICBXcml0ZS1PdXRwdXQgIlZNIG5hbWU6ICR2bU5hbWUgLSBBdXRvU3RhcnRTaHV0IFRhZ3Mgbm90IHNldCBjb3JyZWN0bHkuIE11c3QgYmUgU3RhcnQsIFNodXQsIERheXMiCiAgICAgICAgV3JpdGUtT3V0cHV0ICJTdGFydCA9IDI0IGhvdXIgcmVwcmVzZW50YXRpb24gYXMgMiBkaWdpdHMgc28gN2FtIHdvdWxkIGJlIDA3IgogICAgICAgIFdyaXRlLU91dHB1dCAiU2h1dCA9IDI0IGhvdXIgcmVwcmVzZW50YXRpb24gYXMgMiBkaWdpdHMgc28gN3BtIHdvdWxkIGJlIDE5IgogICAgICAgIFdyaXRlLU91dHB1dCAiRGF5cyA9IE1vbmRheSwgVHVlc2RheSBldGMuIG9yIFdlZWtkYXlzIG9yIEFsbC4gWW91IGNhbiBoYXZlIG11bHRpcGxlIGRheXMgaWYgeW91IHNwZWNpZnkgYXMgTW9uZGF5fFdlZG5lc2RheXxGcmlkYXkgd2l0aCBhIHwgYmV0d2VlbiBkYXlzLiIKICAgICAgICBXcml0ZS1PdXRwdXQgIkV4YW1wbGU6IEF1dG9TdGFydFNodXQgPSAwNywxOSxXZWVrZGF5cyBvciBBdXRvU3RhcnRTaHV0ID0gMDcsMTksTW9uZGF5IgogICAgICAgICRwcm9jZXNzU2VydmVyID0gJGZhbHNlCiAgICAgIH0KCiAgICAgICMgQ2hlY2sgaWYgdGhlIFN0YXJ0IGhvdXIgaXMgc2V0IGNvcnJlY3RseQogICAgICBpZiAoISgoJHN0YXJ0SG91ciAtZ2UgIjAwIikgLWFuZCAoJHN0YXJ0SG91ciAtbGUgIjIzIikpKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJWTSBuYW1lOiAkdm1OYW1lIC0gU3RhcnQgaG91ciBpcyBub3QgYmV0d2VlbiAwMCBhbmQgMjMuIFNraXBwaW5nIHRoaXMgc2VydmVyIgogICAgICAgICRwcm9jZXNzU2VydmVyID0gJGZhbHNlCiAgICAgIH0KCiAgICAgICMgQ2hlY2sgaWYgdGhlIEVuZCBob3VyIGlzIHNldCBjb3JyZWN0bHkKICAgICAgaWYgKCEoKCRzaHV0SG91ciAtZ2UgIjAwIikgLWFuZCAoJHNodXRIb3VyIC1sZSAiMjMiKSkpIHsKICAgICAgICBXcml0ZS1PdXRwdXQgIlZNIG5hbWU6ICR2bU5hbWUgLSBTaHV0ZG93biBob3VyIGlzIG5vdCBiZXR3ZWVuIDAwIGFuZCAyMy4gU2tpcHBpbmcgdGhpcyBzZXJ2ZXIiCiAgICAgICAgJHByb2Nlc3NTZXJ2ZXIgPSAkZmFsc2UKICAgICAgfQoKICAgICAgIyBDaGVjayBpZiB0aGUgRGF5cyB0byBydW4gaXMgc2V0IGNvcnJlY3RseQogICAgICBpZiAoISgkcnVuRGF5cyB8IFdoZXJlLU9iamVjdCB7ICJXZWVrZGF5cyIsICJBbGwiLCAiTW9uZGF5IiwgIlR1ZXNkYXkiLCAiV2VkbmVzZGF5IiwgIlRodXJzZGF5IiwgIkZyaWRheSIsICJTYXR1cmRheSIsICJTdW5kYXkiIC1jb250YWlucyAkXyB9KSkgewogICAgICAgIFdyaXRlLU91dHB1dCAiVk0gbmFtZTogJHZtTmFtZSAtIFJ1biBEYXlzIGlzIG5vdCBzZXQgdG8gV2Vla2RheXMsIEFsbCwgb3IgYSBkYXkocykgb2YgdGhlIHdlZWsuIFNraXBwaW5nIHRoaXMgc2VydmVyIgogICAgICAgICRwcm9jZXNzU2VydmVyID0gJGZhbHNlCiAgICAgIH0KCiAgICAgICMgQ2hlY2sgZm9yIGFuIEF1dG9TdGFydE9yZGVyIHRhZwogICAgICAkdm1zQXBwR3JvdXAgPSAkZmFsc2UKICAgICAgJHZtQXV0b1N0YXJ0T3JkZXIgPSAkdm0uVGFncy5Db250YWluc0tleSgiQXV0b1N0YXJ0T3JkZXIiKQogICAgICBpZiAoJHZtQXV0b1N0YXJ0T3JkZXIpIHsKICAgICAgICAjIFdlIGhhdmUgYW4gb3JkZXIgd2UgbmVlZCB0byBzaHV0ZG93biwgbGV0cyBnZXQgYWxsIG90aGVyIFZNJ3MgaW4gdGhlIHNhbWUgYXBwbGljYXRpb24gZ3JvdXAKICAgICAgICAkdGFnc1NwbGl0ID0gJHZtLlRhZ3MuQXV0b1N0YXJ0T3JkZXIuU3BsaXQoIiwiKQogICAgICAgIGlmICgkdGFnc1NwbGl0LkNvdW50IC1lcSAyKSB7CiAgICAgICAgICAkdm1BcHAgPSAkdGFnc1NwbGl0WzBdCiAgICAgICAgICAkdm1TdGFydE9yZGVyID0gJHRhZ3NTcGxpdFsxXQoKICAgICAgICAgICMgRmluZCBhbnkgb3RoZXIgVk0ncyBydW5uaW5nIHRoZSBzYW1lIGFwcGxpY2F0aW9uIGFzIHdlIGRvCiAgICAgICAgICAkdm1zQXBwR3JvdXAgPSBHZXQtQXpWTSAtU3RhdHVzIHwgV2hlcmUtT2JqZWN0IHskXy5UYWdzLkNvbnRhaW5zS2V5KCJBdXRvU3RhcnRPcmRlciIpfSB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5Db250YWluc0tleSgiQXV0b1N0YXJ0U2h1dCIpfSB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5BdXRvU3RhcnRTaHV0IC1lcSAkdm0uVGFncy5BdXRvU3RhcnRTaHV0fSB8IFdoZXJlLU9iamVjdCB7JF8uTmFtZSAtbmUgJHZtLk5hbWV9IHwgV2hlcmUtT2JqZWN0IHskXy5UYWdzLkF1dG9TdGFydE9yZGVyLlNwbGl0KCIsIilbMF0gLWVxICR2bUFwcH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAjIFdlIGRvbid0IGhhdmUgdGhlIHJlcXVpcmVkIHBhcmFtZXRlcnMgc2V0dXAgY29ycmVjdGx5IG9uIHRoaXMgVk0gc28gZW5kIHRoaXMgbG9vcAogICAgICAgICAgV3JpdGUtT3V0cHV0ICJWTSBuYW1lOiAkdm1OYW1lIC0gQXV0b1N0YXJ0T3JkZXIgVGFncyBub3Qgc2V0IGNvcnJlY3RseS4gTXVzdCBiZSBBcHAsIE9yZGVyIgogICAgICAgICAgV3JpdGUtT3V0cHV0ICJBcHAgPSBUaGlzIGlzIHRoZSBhcHBsaWNhdGlvbiBuYW1lIHdlIG1hdGNoIHdpdGggb3RoZXIgVk0ncyBvZiB0aGUgc2FtZSBuYW1lIHRvIHRoZW4gc2V0IGEgc3RhcnQgLyBzaHV0IG9yZGVyIgogICAgICAgICAgV3JpdGUtT3V0cHV0ICJPcmRlciA9IFRoZSBvcmRlciBpbiB0aGlzIGFwcGxpY2F0aW9uIGdyb3VwIHdlIHN0YXJ0IHRoaXMgVk0sIHdlIHdpbGwgc2h1dGRvd24gaW4gcmV2ZXJzZSBvcmRlciIKICAgICAgICAgIFdyaXRlLU91dHB1dCAiRXhhbXBsZTogQXV0b1N0YXJ0T3JkZXIgPSBBcHAxLDEiCiAgICAgICAgICAkcHJvY2Vzc1NlcnZlciA9ICRmYWxzZQogICAgICAgIH0KICAgICAgfQoKICAgICAgIyBQcm9jZXNzIHRoZSBzZXJ2ZXIgaWYgdGhlIHRhZ3MgYXJlIGNvbmZpZ3VyZWQgY29ycmVjdGx5CiAgICAgIGlmICgkcHJvY2Vzc1NlcnZlcikgewogICAgICAgICMgQ2hlY2sgaWYgdGhlIFZNIHNob3VsZCBiZSBzd2l0Y2hlZCBvbiBub3csIFRydWUgZm9yIG9uIGFuZCBGYWxzZSBmb3Igb2ZmCiAgICAgICAgJFZtT25UaW1lID0gKCgkY3VycmVudEhvdXIgLWdlICRzdGFydEhvdXIpIC1hbmQgKCRjdXJyZW50SG91ciAtbHQgJHNodXRIb3VyKSkKICAgICAgICBXcml0ZS1PdXRwdXQgIlZNIG5hbWU6ICR2bU5hbWUgfCBWTSBvbiB0aW1lOiAkVm1PblRpbWUgfCBDdXJyZW50IGhvdXI6ICRjdXJyZW50SG91ciB8IFZNIHN0YXJ0IHRpbWU6ICRzdGFydEhvdXIgfCBWTSBzaHV0ZG93biB0aW1lOiAkc2h1dEhvdXIiCgogICAgICAgICMgRGVmYXVsdCAkdm1PbkRheSB0byBmYWxzZQogICAgICAgICR2bU9uRGF5ID0gJGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICMgR2V0IHRoZSBjdXJyZW50IGRheQogICAgICAgICRkYXkgPSAoR2V0LURhdGUpLkRheU9mV2VlawogICAgICAgIAogICAgICAgICMgQ2hlY2sgd2hhdCBkYXkgb2YgdGhlIHdlZWsgaXQgaXMgYW5kIGlmIHdlIHNob3VsZCBiZSBvbiBvbiB0aGlzIGRheQogICAgICAgIGlmICgkcnVuRGF5cyAtY29udGFpbnMgIkFsbCIpIHsKICAgICAgICAgIFdyaXRlLU91dHB1dCAiVk0gbmFtZTogJHZtTmFtZSAtIFJ1biBkYXlzIGlzIGFsbCwgc28gd2UgbmVlZCB0byBwcm9jZXNzIHRoZSBzZXJ2ZXIgdG9kYXkiCiAgICAgICAgICAkdm1PbkRheSA9ICR0cnVlCiAgICAgICAgfQogICAgICAgIGVsc2VpZiAoJHJ1bkRheXMgLWNvbnRhaW5zICJXZWVrZGF5cyIpIHsKICAgICAgICAgIGlmICgoJGRheSAtbmUgIlNhdHVyZGF5IikgLWFuZCAoJGRheSAtbmUgIlN1bmRheSIpKSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiVk0gbmFtZTogJHZtTmFtZSAtIFJ1biBkYXlzIGlzIHdlZWtkYXlzIGFuZCBpdCdzIG5vdCBhIHdlZWtlbmQgc28gd2UgbmVlZCB0byBwcm9jZXNzIHRoZSBzZXJ2ZXIgdG9kYXkiCiAgICAgICAgICAgICR2bU9uRGF5ID0gJHRydWUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkcnVuRGF5cyAtY29udGFpbnMgJGRheSkgewogICAgICAgICAgV3JpdGUtT3V0cHV0ICJWTSBuYW1lOiAkdm1OYW1lIC0gSXQncyAkZGF5IHNvIHdlIG5lZWQgdG8gcHJvY2VzcyB0aGUgc2VydmVyIHRvZGF5IgogICAgICAgICAgJHZtT25EYXkgPSAkdHJ1ZQogICAgICAgIH0KICAgICAgICAKICAgICAgICAjIENoZWNrIHRvIHNlZSBpZiBWTSBpcyBvbiBhbmQgd2UgbmVlZCB0byBwb3dlciBpdCBvZmYKICAgICAgICBpZiAoKCR2bVJ1bm5pbmcgLWVxICJWTSBydW5uaW5nIikgLWFuZCAoISgkVm1PblRpbWUpKSAtb3IgKCEoJHZtT25EYXkpKSkgewogICAgICAgICAgV3JpdGUtT3V0cHV0ICJWTSBuYW1lOiAkdm1OYW1lICgkdm1SdW5uaW5nKSB8IERheShzKSB0byBydW46ICR2bU9uRGF5IHwgVk0gb24gdGltZTogJFZtT25UaW1lIC0gV2UgbmVlZCB0byBwb3dlciB0aGlzIHNlcnZlciBvZmYiCgogICAgICAgICAgIyBDaGVjayBpZiB3ZSBuZWVkIHRvIHNodXRkb3duIG90aGVyIHNlcnZlcnMgZmlyc3QKICAgICAgICAgIGlmICgkdm1zQXBwR3JvdXApIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJWTSBuYW1lOiAkdm1OYW1lICgkdm1SdW5uaW5nKSB8IERheShzKSB0byBydW46ICR2bU9uRGF5IHwgVk0gb24gdGltZTogJFZtT25UaW1lIHwgU3RhcnR1cCBPcmRlcjogJHZtU3RhcnRPcmRlciIKICAgICAgICAgICAgJHZtc1NodXREb3duRmlyc3QgPSAkdm1zQXBwR3JvdXAgfCBXaGVyZS1PYmplY3QgeyRfLlRhZ3MuQXV0b1N0YXJ0T3JkZXIuU3BsaXQoIiwiKVsxXSAtZ3QgJHZtU3RhcnRPcmRlcn0KCiAgICAgICAgICAgICMgQ2hlY2sgdG8gc2VlIGlmIGFueSBvdGhlciBWTXMgbmVlZCB0byBiZSBzaHV0ZG93biBmaXJzdAogICAgICAgICAgICBpZiAoJHZtc1NodXREb3duRmlyc3QpIHsKICAgICAgICAgICAgICAjIENoZWNrIGlmIHRoZSBWTSdzIGluIHRoZSBncm91cCBhcmUgYWxsIHNodXRkb3duCiAgICAgICAgICAgICAgJHZtc1NodXREb3duRmlyc3RXYWl0aW5nID0gJHRydWUKICAgICAgICAgICAgICB3aGlsZSAoJHZtc1NodXREb3duRmlyc3RXYWl0aW5nKSB7CiAgICAgICAgICAgICAgICAjIENoZWNrIGlmIGFueSBWTXMgd2UgbmVlZCB0byBzaHV0ZG93biBmaXJzdCBhcmUgc3RpbGwgcnVubmluZwogICAgICAgICAgICAgICAgJHZtc1NodXREb3duRmlyc3RXYWl0aW5nID0gJHZtc1NodXREb3duRmlyc3QgfCBXaGVyZS1PYmplY3QgeyRfLlBvd2VyU3RhdGUgLWVxICJWTSBydW5uaW5nIn0KICAgICAgICAgICAgICAgIGlmICgkdm1zU2h1dERvd25GaXJzdFdhaXRpbmcpIHsKICAgICAgICAgICAgICAgICAgIyBXYWl0IGZvciA2MCBzZWNvbmRzIGJlZm9yZSB3ZSBjaGVjayBhZ2FpbiBhcyBub3QgYWxsIHNlcnZlcnMgYXJlIG9mZgogICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlZNIG5hbWU6ICR2bU5hbWUgKCR2bVJ1bm5pbmcpIHwgRGF5KHMpIHRvIHJ1bjogJHZtT25EYXkgfCBWTSBvbiB0aW1lOiAkVm1PblRpbWUgLSBXYWl0aW5nIGZvciBvdGhlciBzZXJ2ZXJzIGluIHRoZSBBcHBsaWNhdGlvbiBHcm91cCB0byBTaHV0ZG93biBmaXJzdCIKICAgICAgICAgICAgICAgICAgU2xlZXAgNjAKICAgICAgICAgICAgICAgICAgIyBSZWZyZXNoIHRoZSBzdGF0dXMgb2YgdGhlIFZNJ3MgaW4gdGhlIEFwcGxpY2F0aW9uIEdyb3VwIHdlIG5lZWQgdG8gY2hlY2sgUG93ZXJTdGF0ZSBvbgogICAgICAgICAgICAgICAgICAkdm1zQXBwR3JvdXAgPSBHZXQtQXpWTSAtU3RhdHVzIHwgV2hlcmUtT2JqZWN0IHskXy5UYWdzLkNvbnRhaW5zS2V5KCJBdXRvU3RhcnRPcmRlciIpfSB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5Db250YWluc0tleSgiQXV0b1N0YXJ0U2h1dCIpfSB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5BdXRvU3RhcnRTaHV0IC1lcSAkdm0uVGFncy5BdXRvU3RhcnRTaHV0fSB8IFdoZXJlLU9iamVjdCB7JF8uTmFtZSAtbmUgJHZtLk5hbWV9IHwgV2hlcmUtT2JqZWN0IHskXy5UYWdzLkF1dG9TdGFydE9yZGVyLlNwbGl0KCIsIilbMF0gLWVxICR2bUFwcH0KICAgICAgICAgICAgICAgICAgJHZtc1NodXREb3duRmlyc3QgPSAkdm1zQXBwR3JvdXAgfCBXaGVyZS1PYmplY3QgeyRfLlRhZ3MuQXV0b1N0YXJ0T3JkZXIuU3BsaXQoIiwiKVsxXSAtZ3QgJHZtU3RhcnRPcmRlcn0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAkc2h1dFN0YXR1cyA9ICR2bSB8IFN0b3AtQXpWTSAtRm9yY2UKCiAgICAgICAgICAjIENoZWNrIGlmIHRoZSBzaHV0ZG93biB3YXMgc3VjY2Vzc2Z1bAogICAgICAgICAgaWYgKCRzaHV0U3RhdHVzLlN0YXR1cyAtZXEgIlN1Y2NlZWRlZCIpIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICIkdm1OYW1lIC0gU2h1dGRvd24gc3VjY2Vzc2Z1bGx5IgogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICIkdm1OYW1lIC0gRmFpbGVkIHRvIHNodXRkb3duIgogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAjIENoZWNrIHRvIHNlZSBpZiB0aGUgc2VydmVyIGlzIG9mZiBhbmQgd2UgbmVlZCB0byBwb3dlciBpdCBvbgogICAgICAgICAgaWYgKCgkdm1SdW5uaW5nIC1uZSAiVk0gcnVubmluZyIpIC1hbmQgJFZtT25UaW1lIC1hbmQgJHZtT25EYXkpIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJWTSBuYW1lOiAkdm1OYW1lICgkdm1SdW5uaW5nKSB8IERheShzKSB0byBydW46ICR2bU9uRGF5IHwgVk0gb24gdGltZTogJFZtT25UaW1lIC0gV2UgbmVlZCB0byBwb3dlciB0aGlzIHNlcnZlciBvbiIKCiAgICAgICAgICAgICMgQ2hlY2sgaWYgd2UgbmVlZCB0byBzaHV0ZG93biBvdGhlciBzZXJ2ZXJzIGZpcnN0CiAgICAgICAgICAgIGlmICgkdm1zQXBwR3JvdXApIHsKICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlZNIG5hbWU6ICR2bU5hbWUgKCR2bVJ1bm5pbmcpIHwgRGF5KHMpIHRvIHJ1bjogJHZtT25EYXkgfCBWTSBvbiB0aW1lOiAkVm1PblRpbWUgfCBTdGFydHVwIE9yZGVyOiAkdm1TdGFydE9yZGVyIgogICAgICAgICAgICAgICR2bXNTdGFydFVwRmlyc3QgPSAkdm1zQXBwR3JvdXAgfCBXaGVyZS1PYmplY3QgeyRfLlRhZ3MuQXV0b1N0YXJ0T3JkZXIuU3BsaXQoIiwiKVsxXSAtbHQgJHZtU3RhcnRPcmRlcn0KCiAgICAgICAgICAgICAgIyBDaGVjayB0byBzZWUgaWYgYW55IG90aGVyIFZNcyBuZWVkIHRvIGJlIHN0YXJ0ZWQgdXAgZmlyc3QKICAgICAgICAgICAgICBpZiAoJHZtc1N0YXJ0VXBGaXJzdCkgewogICAgICAgICAgICAgICAgIyBDaGVjayBpZiB0aGUgVk0ncyBpbiB0aGUgZ3JvdXAgYXJlIGFsbCBzdGFydGVkIHVwCiAgICAgICAgICAgICAgICAkdm1zU3RhcnRVcEZpcnN0V2FpdGluZyA9ICR0cnVlCiAgICAgICAgICAgICAgICB3aGlsZSAoJHZtc1N0YXJ0VXBGaXJzdFdhaXRpbmcpIHsKICAgICAgICAgICAgICAgICAgIyBDaGVjayBpZiBhbnkgVk1zIHdlIG5lZWQgdG8gc3RhcnR1cCBmaXJzdCBhcmUgc3RpbGwgcG93ZXJlZCBvZmYKICAgICAgICAgICAgICAgICAgJHZtc1N0YXJ0VXBGaXJzdFdhaXRpbmcgPSAkdm1zU3RhcnRVcEZpcnN0IHwgV2hlcmUtT2JqZWN0IHskXy5Qb3dlclN0YXRlIC1uZSAiVk0gcnVubmluZyJ9CiAgICAgICAgICAgICAgICAgIGlmICgkdm1zU3RhcnRVcEZpcnN0V2FpdGluZykgewogICAgICAgICAgICAgICAgICAgICMgV2FpdCBmb3IgNjAgc2Vjb25kcyBiZWZvcmUgd2UgY2hlY2sgYWdhaW4gYXMgbm90IGFsbCBzZXJ2ZXJzIGFyZSBzdGFydGVkIHlldAogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiVk0gbmFtZTogJHZtTmFtZSAoJHZtUnVubmluZykgfCBEYXkocykgdG8gcnVuOiAkdm1PbkRheSB8IFZNIG9uIHRpbWU6ICRWbU9uVGltZSAtIFdhaXRpbmcgZm9yIG90aGVyIHNlcnZlcnMgaW4gdGhlIEFwcGxpY2F0aW9uIEdyb3VwIHRvIFN0YXJ0dXAgZmlyc3QiCiAgICAgICAgICAgICAgICAgICAgU2xlZXAgNjAKICAgICAgICAgICAgICAgICAgICAjIFJlZnJlc2ggdGhlIHN0YXR1cyBvZiB0aGUgVk0ncyBpbiB0aGUgQXBwbGljYXRpb24gR3JvdXAgd2UgbmVlZCB0byBjaGVjayBQb3dlclN0YXRlIG9uCiAgICAgICAgICAgICAgICAgICAgJHZtc0FwcEdyb3VwID0gR2V0LUF6Vk0gLVN0YXR1cyB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5Db250YWluc0tleSgiQXV0b1N0YXJ0T3JkZXIiKX0gfCBXaGVyZS1PYmplY3QgeyRfLlRhZ3MuQ29udGFpbnNLZXkoIkF1dG9TdGFydFNodXQiKX0gfCBXaGVyZS1PYmplY3QgeyRfLlRhZ3MuQXV0b1N0YXJ0U2h1dCAtZXEgJHZtLlRhZ3MuQXV0b1N0YXJ0U2h1dH0gfCBXaGVyZS1PYmplY3QgeyRfLk5hbWUgLW5lICR2bS5OYW1lfSB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5BdXRvU3RhcnRPcmRlci5TcGxpdCgiLCIpWzBdIC1lcSAkdm1BcHB9CiAgICAgICAgICAgICAgICAgICAgJHZtc1N0YXJ0VXBGaXJzdCA9ICR2bXNBcHBHcm91cCB8IFdoZXJlLU9iamVjdCB7JF8uVGFncy5BdXRvU3RhcnRPcmRlci5TcGxpdCgiLCIpWzFdIC1sdCAkdm1TdGFydE9yZGVyfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkc3RhcnRTdGF0dXMgPSAkdm0gfCBTdGFydC1BelZNCgogICAgICAgICAgICAjIENoZWNrIGlmIHRoZSBzdGFydHVwIHdhcyBzdWNjZXNzZnVsCiAgICAgICAgICAgIGlmICgkc3RhcnRTdGF0dXMuU3RhdHVzIC1lcSAiU3VjY2VlZGVkIikgewogICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiJHZtTmFtZSAtIFN0YXJ0ZWQgc3VjY2Vzc2Z1bGx5IgogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiJHZtTmFtZSAtIEZhaWxlZCB0byBzdGFydCIKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJWTSBuYW1lOiAkdm1OYW1lICgkdm1SdW5uaW5nKSB8IERheShzKSB0byBydW46ICR2bU9uRGF5IHwgVk0gb24gdGltZTogJFZtT25UaW1lIC0gU2VydmVyIGlzIGluIHRoZSBjb3JyZWN0IFBvd2VyU3RhdGUiCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Cg==","filename":"../scripts/vm_auto_start_stop.ps1","id":"25701597495b240ae624698dc877ff9fea9fc584"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"azuread":{"name":"azuread","full_name":"registry.terraform.io/hashicorp/azuread","version_constraint":"~\u003e 2.19.1"},"azurerm":{"name":"azurerm","full_name":"registry.terraform.io/hashicorp/azurerm","version_constraint":"~\u003e 3.61.0","expressions":{"features":[{"key_vault":[{"purge_soft_delete_on_destroy":{"constant_value":false},"recover_soft_deleted_key_vaults":{"constant_value":true}}]}],"skip_provider_registration":{"constant_value":false}}},"external":{"name":"external","full_name":"registry.terraform.io/hashicorp/external"},"http":{"name":"http","full_name":"registry.terraform.io/hashicorp/http","version_constraint":"~\u003e 2.1.0"},"local":{"name":"local","full_name":"registry.terraform.io/hashicorp/local","version_constraint":"~\u003e 2.1.0"},"module.bau_support_vm:tls":{"name":"tls","full_name":"registry.terraform.io/hashicorp/tls","module_address":"module.bau_support_vm"},"module.vm_primary_iris_db:tls":{"name":"tls","full_name":"registry.terraform.io/hashicorp/tls","module_address":"module.vm_primary_iris_db"},"module.vm_session_host_1:tls":{"name":"tls","full_name":"registry.terraform.io/hashicorp/tls","module_address":"module.vm_session_host_1"},"module.vm_session_host_2:tls":{"name":"tls","full_name":"registry.terraform.io/hashicorp/tls","module_address":"module.vm_session_host_2"},"module.vm_session_host_3:tls":{"name":"tls","full_name":"registry.terraform.io/hashicorp/tls","module_address":"module.vm_session_host_3"},"null":{"name":"null","full_name":"registry.terraform.io/hashicorp/null","version_constraint":"~\u003e 3.1.0"},"random":{"name":"random","full_name":"registry.terraform.io/hashicorp/random","version_constraint":"~\u003e 3.1.0"},"time":{"name":"time","full_name":"registry.terraform.io/hashicorp/time","version_constraint":"~\u003e 0.7.2"}},"root_module":{"resources":[{"address":"azuread_group.bau_vm_admins","mode":"managed","type":"azuread_group","name":"bau_vm_admins","provider_config_key":"azuread","expressions":{"display_name":{"references":["each.value.bau_aad_group_name_admin","each.value"]},"mail_enabled":{"constant_value":false},"owners":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"prevent_duplicate_names":{"constant_value":true},"security_enabled":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.bau_support_vm"]}},{"address":"azuread_group.bau_vm_power_users","mode":"managed","type":"azuread_group","name":"bau_vm_power_users","provider_config_key":"azuread","expressions":{"display_name":{"references":["each.value.bau_aad_group_name_power","each.value"]},"mail_enabled":{"constant_value":false},"owners":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"prevent_duplicate_names":{"constant_value":true},"security_enabled":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.bau_support_vm"]}},{"address":"azuread_group.irisdb_vm_admins","mode":"managed","type":"azuread_group","name":"irisdb_vm_admins","provider_config_key":"azuread","expressions":{"display_name":{"references":["each.value.iris_vm_aad_group_name_admin","each.value"]},"mail_enabled":{"constant_value":false},"owners":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"prevent_duplicate_names":{"constant_value":true},"security_enabled":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.modern_irisdb"]}},{"address":"azuread_group.irisdb_vm_power_users","mode":"managed","type":"azuread_group","name":"irisdb_vm_power_users","provider_config_key":"azuread","expressions":{"display_name":{"references":["each.value.iris_vm_aad_group_name_power","each.value"]},"mail_enabled":{"constant_value":false},"owners":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"prevent_duplicate_names":{"constant_value":true},"security_enabled":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.modern_irisdb"]}},{"address":"azuread_group.session_host_users","mode":"managed","type":"azuread_group","name":"session_host_users","provider_config_key":"azuread","expressions":{"display_name":{"references":["each.value.aad_group_name","each.value"]},"mail_enabled":{"constant_value":false},"members":{"references":["var.mod_testers"]},"owners":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"prevent_duplicate_names":{"constant_value":true},"security_enabled":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]}},{"address":"azuread_group.vm_admins","mode":"managed","type":"azuread_group","name":"vm_admins","provider_config_key":"azuread","expressions":{"display_name":{"references":["each.value.aad_group_name_admin","each.value"]},"mail_enabled":{"constant_value":false},"owners":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"prevent_duplicate_names":{"constant_value":true},"security_enabled":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]}},{"address":"azuread_group.vm_power_users","mode":"managed","type":"azuread_group","name":"vm_power_users","provider_config_key":"azuread","expressions":{"display_name":{"references":["each.value.aad_group_name_power","each.value"]},"mail_enabled":{"constant_value":false},"owners":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"prevent_duplicate_names":{"constant_value":true},"security_enabled":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]}},{"address":"azurerm_automation_account.modern","mode":"managed","type":"azurerm_automation_account","name":"modern","provider_config_key":"azurerm","expressions":{"identity":[{"identity_ids":{"references":["azurerm_user_assigned_identity.automation.id","azurerm_user_assigned_identity.automation"]},"type":{"constant_value":"SystemAssigned, UserAssigned"}}],"location":{"references":["azurerm_resource_group.modern[\"automation\"].location","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"automation\"].name","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"sku_name":{"constant_value":"Basic"},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"depends_on":["azurerm_role_assignment.kv_aa_reader","azurerm_role_assignment.kv_aa_crypto_user"]},{"address":"azurerm_automation_job_schedule.vm_start_stop","mode":"managed","type":"azurerm_automation_job_schedule","name":"vm_start_stop","provider_config_key":"azurerm","expressions":{"automation_account_name":{"references":["azurerm_automation_account.modern.name","azurerm_automation_account.modern"]},"parameters":{"constant_value":{}},"resource_group_name":{"references":["azurerm_resource_group.modern[\"automation\"].name","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"runbook_name":{"references":["azurerm_automation_runbook.vm_start_stop.name","azurerm_automation_runbook.vm_start_stop"]},"schedule_name":{"references":["azurerm_automation_schedule.hourly.name","azurerm_automation_schedule.hourly"]}},"schema_version":0},{"address":"azurerm_automation_runbook.vm_start_stop","mode":"managed","type":"azurerm_automation_runbook","name":"vm_start_stop","provider_config_key":"azurerm","expressions":{"automation_account_name":{"references":["azurerm_automation_account.modern.name","azurerm_automation_account.modern"]},"content":{"references":["data.local_file.vm_start_stop_runbook.content","data.local_file.vm_start_stop_runbook"]},"description":{"constant_value":"This Runbook powers VM's on and off based on tags on the VM resource"},"location":{"references":["azurerm_resource_group.modern[\"automation\"].location","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"log_progress":{"constant_value":"true"},"log_verbose":{"constant_value":"true"},"name":{"constant_value":"Auto-StartShutdown"},"resource_group_name":{"references":["azurerm_resource_group.modern[\"automation\"].name","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"runbook_type":{"constant_value":"PowerShellWorkflow"}},"schema_version":0},{"address":"azurerm_automation_schedule.hourly","mode":"managed","type":"azurerm_automation_schedule","name":"hourly","provider_config_key":"azurerm","expressions":{"automation_account_name":{"references":["azurerm_automation_account.modern.name","azurerm_automation_account.modern"]},"description":{"constant_value":"Hourly schedule"},"frequency":{"constant_value":"Hour"},"interval":{"constant_value":1},"name":{"constant_value":"Hourly"},"resource_group_name":{"references":["azurerm_resource_group.modern[\"automation\"].name","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"start_time":{"references":["local.schedule_start"]},"timezone":{"constant_value":"Etc/UTC"}},"schema_version":0},{"address":"azurerm_backup_container_storage_account.modern","mode":"managed","type":"azurerm_backup_container_storage_account","name":"modern","provider_config_key":"azurerm","expressions":{"recovery_vault_name":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"storage_account_id":{"references":["azurerm_storage_account.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_storage_accounts"]},"depends_on":["azurerm_role_assignment.storage_account_mod_deployment_account","azurerm_private_endpoint.storage_modern","azurerm_storage_share.modern","azurerm_private_endpoint.recovery_vault_modern"]},{"address":"azurerm_backup_policy_file_share.modern_avd","mode":"managed","type":"azurerm_backup_policy_file_share","name":"modern_avd","provider_config_key":"azurerm","expressions":{"backup":[{"frequency":{"constant_value":"Daily"},"time":{"constant_value":"14:00"}}],"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"recovery_vault_name":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"retention_daily":[{"count":{"constant_value":14}}],"retention_monthly":[{"count":{"constant_value":6},"weekdays":{"constant_value":["Saturday"]},"weeks":{"constant_value":["Last"]}}],"retention_weekly":[{"count":{"constant_value":4},"weekdays":{"constant_value":["Saturday"]}}],"timezone":{"constant_value":"UTC"}},"schema_version":0},{"address":"azurerm_backup_policy_vm.modern_standard","mode":"managed","type":"azurerm_backup_policy_vm","name":"modern_standard","provider_config_key":"azurerm","expressions":{"backup":[{"frequency":{"constant_value":"Daily"},"time":{"constant_value":"23:00"}}],"instant_restore_retention_days":{"constant_value":2},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"recovery_vault_name":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"retention_daily":[{"count":{"constant_value":14}}],"retention_monthly":[{"count":{"constant_value":6},"weekdays":{"constant_value":["Saturday"]},"weeks":{"constant_value":["Last"]}}],"retention_weekly":[{"count":{"constant_value":4},"weekdays":{"constant_value":["Saturday"]}}],"timezone":{"constant_value":"UTC"}},"schema_version":0},{"address":"azurerm_backup_protected_file_share.modern","mode":"managed","type":"azurerm_backup_protected_file_share","name":"modern","provider_config_key":"azurerm","expressions":{"backup_policy_id":{"references":["azurerm_backup_policy_file_share.modern_avd.id","azurerm_backup_policy_file_share.modern_avd"]},"recovery_vault_name":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"source_file_share_name":{"references":["azurerm_storage_share.modern","each.key"]},"source_storage_account_id":{"references":["azurerm_storage_account.modern","each.value.storage_account","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_storage_file_shares"]},"depends_on":["azurerm_backup_container_storage_account.modern","azurerm_private_endpoint.recovery_vault_modern"]},{"address":"azurerm_bastion_host.bastion","mode":"managed","type":"azurerm_bastion_host","name":"bastion","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"constant_value":"configuration"},"public_ip_address_id":{"references":["azurerm_public_ip.bastion.id","azurerm_public_ip.bastion"]},"subnet_id":{"references":["azurerm_subnet.modern[\"bastion\"].id","azurerm_subnet.modern[\"bastion\"]","azurerm_subnet.modern"]}}],"location":{"references":["azurerm_resource_group.modern[\"bastion\"].location","azurerm_resource_group.modern[\"bastion\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"bastion\"].name","azurerm_resource_group.modern[\"bastion\"]","azurerm_resource_group.modern"]},"scale_units":{"constant_value":2},"sku":{"constant_value":"Standard"},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_firewall_policy_rule_collection_group.avd_core","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_core","provider_config_key":"azurerm","expressions":{"firewall_policy_id":{"references":["data.azurerm_firewall_policy.standard.id","data.azurerm_firewall_policy.standard"]},"name":{"constant_value":"AVD-Core"},"network_rule_collection":[{"action":{"constant_value":"Allow"},"name":{"constant_value":"NetworkRules-WindowsVirtualDesktop"},"priority":{"constant_value":100},"rule":[{"destination_addresses":{"constant_value":["WindowsVirtualDesktop"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Service-Traffic"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["AzureMonitor"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Agent-Traffic"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["AzureFrontDoor.Frontend"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Azure-Marketplace"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["kms.core.windows.net"]},"destination_ports":{"constant_value":["1688"]},"name":{"constant_value":"Windows-activation"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["azkms.core.windows.net"]},"destination_ports":{"constant_value":["1688"]},"name":{"constant_value":"Azure-Windows-activation"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["mrsglobalsteus2prod.blob.core.windows.net"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Agent-and-SXS-Stack-Updates"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["wvdportalstorageblob.blob.core.windows.net"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Azure-Portal-Support"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["169.254.169.254"]},"destination_ports":{"constant_value":["80"]},"name":{"constant_value":"Azure-Instance-Metadata-Service-Endpoint"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["168.63.129.16"]},"destination_ports":{"constant_value":["80"]},"name":{"constant_value":"Session-Host-Health-Monitoring"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["oneocsp.microsoft.com"]},"destination_ports":{"constant_value":["80"]},"name":{"constant_value":"Certificate-CRL-OneOCSP"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["www.microsoft.com"]},"destination_ports":{"constant_value":["80"]},"name":{"constant_value":"Certificate-CRL-MicrosoftDotCom"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["*"]},"destination_ports":{"constant_value":["3478"]},"name":{"constant_value":"TURN-Health-Checking"},"protocols":{"constant_value":["UDP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}}]}],"priority":{"constant_value":600}},"schema_version":0},{"address":"azurerm_firewall_policy_rule_collection_group.avd_optional","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_optional","provider_config_key":"azurerm","expressions":{"firewall_policy_id":{"references":["data.azurerm_firewall_policy.standard.id","data.azurerm_firewall_policy.standard"]},"name":{"constant_value":"AVD-Optional"},"network_rule_collection":[{"action":{"constant_value":"Allow"},"name":{"constant_value":"NetworkRules_AVD-Optional"},"priority":{"constant_value":100},"rule":[{"destination_addresses":{"constant_value":["time.windows.com"]},"destination_ports":{"constant_value":["123"]},"name":{"constant_value":"NTP"},"protocols":{"constant_value":["TCP","UDP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["login.microsoftonline.com"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Auth-To-MSOL"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["login.windows.net"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Signin-To-MSOL365"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}},{"destination_addresses":{"constant_value":["www.msftconnecttest.com"]},"destination_ports":{"constant_value":["443"]},"name":{"constant_value":"Detect-OS-Connected-To-Internet"},"protocols":{"constant_value":["TCP"]},"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]}}]}],"priority":{"constant_value":601}},"schema_version":0},{"address":"azurerm_firewall_policy_rule_collection_group.avd_optional_priority","mode":"managed","type":"azurerm_firewall_policy_rule_collection_group","name":"avd_optional_priority","provider_config_key":"azurerm","expressions":{"application_rule_collection":[{"action":{"constant_value":"Allow"},"name":{"constant_value":"ApplicationRules_AVD-Optional"},"priority":{"constant_value":100},"rule":[{"destination_fqdns":{"constant_value":["*.events.data.microsoft.com"]},"name":{"constant_value":"Telemetry-Service"},"protocols":[{"port":{"constant_value":443},"type":{"constant_value":"Https"}}],"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]},"terminate_tls":{"constant_value":false}},{"destination_fqdn_tags":{"constant_value":["WindowsUpdate"]},"name":{"constant_value":"Windows-Update"},"protocols":[{"port":{"constant_value":443},"type":{"constant_value":"Https"}}],"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]},"terminate_tls":{"constant_value":false}},{"destination_fqdns":{"constant_value":["*.sfx.ms"]},"name":{"constant_value":"Updates-For-One-Drive"},"protocols":[{"port":{"constant_value":443},"type":{"constant_value":"Https"}}],"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]},"terminate_tls":{"constant_value":false}},{"destination_fqdns":{"constant_value":["*.digicert.com"]},"name":{"constant_value":"Digitcert-CRL"},"protocols":[{"port":{"constant_value":443},"type":{"constant_value":"Https"}}],"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]},"terminate_tls":{"constant_value":false}},{"destination_fqdns":{"constant_value":["*.azure-dns.com"]},"name":{"constant_value":"Azure-DNS-Resolution-1"},"protocols":[{"port":{"constant_value":443},"type":{"constant_value":"Https"}}],"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]},"terminate_tls":{"constant_value":false}},{"destination_fqdns":{"constant_value":["*.azure-dns.net"]},"name":{"constant_value":"Azure-DNS-Resolution-2"},"protocols":[{"port":{"constant_value":443},"type":{"constant_value":"Https"}}],"source_addresses":{"references":["var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range","var.modern_vnet_range"]},"terminate_tls":{"constant_value":false}}]}],"firewall_policy_id":{"references":["data.azurerm_firewall_policy.standard.id","data.azurerm_firewall_policy.standard"]},"name":{"constant_value":"AVD-Optional-priority"},"priority":{"constant_value":601}},"schema_version":0},{"address":"azurerm_key_vault.modern","mode":"managed","type":"azurerm_key_vault","name":"modern","provider_config_key":"azurerm","expressions":{"enable_rbac_authorization":{"constant_value":true},"enabled_for_disk_encryption":{"constant_value":true},"location":{"references":["azurerm_resource_group.modern[\"key_vault\"].location","azurerm_resource_group.modern[\"key_vault\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"network_acls":[{"bypass":{"constant_value":"AzureServices"},"default_action":{"constant_value":"Deny"}}],"purge_protection_enabled":{"constant_value":true},"resource_group_name":{"references":["azurerm_resource_group.modern[\"key_vault\"].name","azurerm_resource_group.modern[\"key_vault\"]","azurerm_resource_group.modern"]},"sku_name":{"constant_value":"standard"},"soft_delete_retention_days":{"constant_value":90},"tags":{"references":["module.tags.value","module.tags"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":2},{"address":"azurerm_key_vault_key.modern","mode":"managed","type":"azurerm_key_vault_key","name":"modern","provider_config_key":"azurerm","expressions":{"expiration_date":{"references":["var.expiration_date"]},"key_opts":{"constant_value":["decrypt","encrypt","sign","unwrapKey","verify","wrapKey"]},"key_size":{"references":["var.key_size"]},"key_type":{"references":["var.key_type"]},"key_vault_id":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]},"name":{"references":["azurerm_key_vault.modern.name","azurerm_key_vault.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_log_analytics_linked_service.modern","mode":"managed","type":"azurerm_log_analytics_linked_service","name":"modern","provider_config_key":"azurerm","expressions":{"read_access_id":{"references":["azurerm_automation_account.modern.id","azurerm_automation_account.modern"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"workspace_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]}},"schema_version":0},{"address":"azurerm_log_analytics_solution.security","mode":"managed","type":"azurerm_log_analytics_solution","name":"security","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"plan":[{"product":{"constant_value":"OMSGallery/Security"},"publisher":{"constant_value":"Microsoft"}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"solution_name":{"constant_value":"Security"},"workspace_name":{"references":["azurerm_log_analytics_workspace.modern.name","azurerm_log_analytics_workspace.modern"]},"workspace_resource_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]}},"schema_version":1},{"address":"azurerm_log_analytics_solution.security_center_free","mode":"managed","type":"azurerm_log_analytics_solution","name":"security_center_free","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"plan":[{"product":{"constant_value":"OMSGallery/SecurityCenterFree"},"publisher":{"constant_value":"Microsoft"}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"solution_name":{"constant_value":"SecurityCenterFree"},"workspace_name":{"references":["azurerm_log_analytics_workspace.modern.name","azurerm_log_analytics_workspace.modern"]},"workspace_resource_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]}},"schema_version":1},{"address":"azurerm_log_analytics_solution.windows_event_forwarding","mode":"managed","type":"azurerm_log_analytics_solution","name":"windows_event_forwarding","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"plan":[{"product":{"constant_value":"OMSGallery/WindowsEventForwarding"},"publisher":{"constant_value":"Microsoft"}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"solution_name":{"constant_value":"WindowsEventForwarding"},"workspace_name":{"references":["azurerm_log_analytics_workspace.modern.name","azurerm_log_analytics_workspace.modern"]},"workspace_resource_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]}},"schema_version":1},{"address":"azurerm_log_analytics_solution.windows_updates","mode":"managed","type":"azurerm_log_analytics_solution","name":"windows_updates","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"plan":[{"product":{"constant_value":"OMSGallery/Updates"},"publisher":{"constant_value":"Microsoft"}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"solution_name":{"constant_value":"Updates"},"workspace_name":{"references":["azurerm_log_analytics_workspace.modern.name","azurerm_log_analytics_workspace.modern"]},"workspace_resource_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]}},"schema_version":1,"depends_on":["azurerm_log_analytics_linked_service.modern"]},{"address":"azurerm_log_analytics_workspace.modern","mode":"managed","type":"azurerm_log_analytics_workspace","name":"modern","provider_config_key":"azurerm","expressions":{"internet_ingestion_enabled":{"constant_value":false},"internet_query_enabled":{"constant_value":true},"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"retention_in_days":{"constant_value":90},"sku":{"constant_value":"PerGB2018"},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":3},{"address":"azurerm_monitor_data_collection_endpoint.modern","mode":"managed","type":"azurerm_monitor_data_collection_endpoint","name":"modern","provider_config_key":"azurerm","expressions":{"description":{"constant_value":"monitor_data_collection_endpoint example"},"kind":{"constant_value":"Windows"},"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"public_network_access_enabled":{"constant_value":false},"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_monitor_data_collection_rule.modern","mode":"managed","type":"azurerm_monitor_data_collection_rule","name":"modern","provider_config_key":"azurerm","expressions":{"data_collection_endpoint_id":{"references":["azurerm_monitor_data_collection_endpoint.modern.id","azurerm_monitor_data_collection_endpoint.modern"]},"data_flow":[{"destinations":{"references":["azurerm_log_analytics_workspace.modern.name","azurerm_log_analytics_workspace.modern"]},"streams":{"constant_value":["Microsoft-InsightsMetrics"]}},{"destinations":{"references":["azurerm_log_analytics_workspace.modern.name","azurerm_log_analytics_workspace.modern"]},"streams":{"constant_value":["Microsoft-Event"]}}],"data_sources":[{"performance_counter":[{"counter_specifiers":{"constant_value":["\\Processor Information(_Total)\\% Processor Time","\\Processor Information(_Total)\\% Privileged Time","\\Processor Information(_Total)\\% User Time","\\Processor Information(_Total)\\Processor Frequency","\\System\\Processes","\\Process(_Total)\\Thread Count","\\Process(_Total)\\Handle Count","\\System\\System Up Time","\\System\\Context Switches/sec","\\System\\Processor Queue Length","\\Memory\\% Committed Bytes In Use","\\Memory\\Available Bytes","\\Memory\\Committed Bytes","\\Memory\\Cache Bytes","\\Memory\\Pool Paged Bytes","\\Memory\\Pool Nonpaged Bytes","\\Memory\\Pages/sec","\\Memory\\Page Faults/sec","\\Process(_Total)\\Working Set","\\Process(_Total)\\Working Set - Private","\\LogicalDisk(_Total)\\% Disk Time","\\LogicalDisk(_Total)\\% Disk Read Time","\\LogicalDisk(_Total)\\% Disk Write Time","\\LogicalDisk(_Total)\\% Idle Time","\\LogicalDisk(_Total)\\Disk Bytes/sec","\\LogicalDisk(_Total)\\Disk Read Bytes/sec","\\LogicalDisk(_Total)\\Disk Write Bytes/sec","\\LogicalDisk(_Total)\\Disk Transfers/sec","\\LogicalDisk(_Total)\\Disk Reads/sec","\\LogicalDisk(_Total)\\Disk Writes/sec","\\LogicalDisk(_Total)\\Avg. Disk sec/Transfer","\\LogicalDisk(_Total)\\Avg. Disk sec/Read","\\LogicalDisk(_Total)\\Avg. Disk sec/Write","\\LogicalDisk(_Total)\\Avg. Disk Queue Length","\\LogicalDisk(_Total)\\Avg. Disk Read Queue Length","\\LogicalDisk(_Total)\\Avg. Disk Write Queue Length","\\LogicalDisk(_Total)\\% Free Space","\\LogicalDisk(_Total)\\Free Megabytes","\\Network Interface(*)\\Bytes Total/sec","\\Network Interface(*)\\Bytes Sent/sec","\\Network Interface(*)\\Bytes Received/sec","\\Network Interface(*)\\Packets/sec","\\Network Interface(*)\\Packets Sent/sec","\\Network Interface(*)\\Packets Received/sec","\\Network Interface(*)\\Packets Outbound Errors","\\Network Interface(*)\\Packets Received Errors"]},"name":{"constant_value":"datasource-perfcounter"},"sampling_frequency_in_seconds":{"constant_value":60},"streams":{"constant_value":["Microsoft-InsightsMetrics"]}}],"syslog":[{"facility_names":{"constant_value":["*"]},"log_levels":{"constant_value":["*"]},"name":{"constant_value":"datasource-syslog"}}],"windows_event_log":[{"name":{"constant_value":"datasource-wineventlog"},"streams":{"constant_value":["Microsoft-WindowsEvent"]},"x_path_queries":{"constant_value":["Application!*[System[(Level=1 or Level=2 or Level=3)]]","Security!*[System[(band(Keywords,13510798882111488))]]","System!*[System[(Level=1 or Level=2 or Level=3)]]"]}}]}],"description":{"constant_value":"Data collection rule for Modernisation."},"destinations":[{"log_analytics":[{"name":{"references":["azurerm_log_analytics_workspace.modern.name","azurerm_log_analytics_workspace.modern"]},"workspace_resource_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]}}]}],"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"stream_declaration":[{"column":[{"name":{"constant_value":"Time"},"type":{"constant_value":"datetime"}},{"name":{"constant_value":"Computer"},"type":{"constant_value":"string"}},{"name":{"constant_value":"AdditionalContext"},"type":{"constant_value":"string"}}],"stream_name":{"constant_value":"Custom-MyTableRawData"}}],"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"depends_on":["azurerm_log_analytics_solution.windows_event_forwarding"]},{"address":"azurerm_monitor_diagnostic_setting.automation_account_modern","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"automation_account_modern","provider_config_key":"azurerm","expressions":{"log_analytics_workspace_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]},"name":{"constant_value":"Diagnostics"},"storage_account_id":{"references":["azurerm_storage_account.modern[\"blob\"].id","azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"target_resource_id":{"references":["azurerm_automation_account.modern.id","azurerm_automation_account.modern"]}},"schema_version":0,"depends_on":["azurerm_monitor_private_link_scoped_service.modern","azurerm_private_endpoint.storage_modern"]},{"address":"azurerm_monitor_diagnostic_setting.bastion","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"bastion","provider_config_key":"azurerm","expressions":{"log_analytics_workspace_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]},"name":{"constant_value":"Diagnostics"},"storage_account_id":{"references":["azurerm_storage_account.modern[\"blob\"].id","azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"target_resource_id":{"references":["azurerm_bastion_host.bastion.id","azurerm_bastion_host.bastion"]}},"schema_version":0,"depends_on":["azurerm_monitor_private_link_scoped_service.modern","azurerm_private_endpoint.storage_modern"]},{"address":"azurerm_monitor_diagnostic_setting.key_vault_modern","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"key_vault_modern","provider_config_key":"azurerm","expressions":{"log_analytics_workspace_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]},"name":{"constant_value":"Diagnostics"},"storage_account_id":{"references":["azurerm_storage_account.modern[\"blob\"].id","azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"target_resource_id":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"depends_on":["azurerm_monitor_private_link_scoped_service.modern","azurerm_private_endpoint.key_vault_modern"]},{"address":"azurerm_monitor_diagnostic_setting.storage_account_modern","mode":"managed","type":"azurerm_monitor_diagnostic_setting","name":"storage_account_modern","provider_config_key":"azurerm","expressions":{"log_analytics_workspace_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]},"name":{"constant_value":"Diagnostics"},"storage_account_id":{"references":["azurerm_storage_account.modern[\"blob\"].id","azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"target_resource_id":{"references":["each.value.storage_account_id","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.storage_diagnostics_process"]},"depends_on":["azurerm_monitor_private_link_scoped_service.modern","azurerm_private_endpoint.storage_modern"]},{"address":"azurerm_monitor_private_link_scope.modern","mode":"managed","type":"azurerm_monitor_private_link_scope","name":"modern","provider_config_key":"azurerm","expressions":{"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]}},"schema_version":0},{"address":"azurerm_monitor_private_link_scoped_service.modern","mode":"managed","type":"azurerm_monitor_private_link_scoped_service","name":"modern","provider_config_key":"azurerm","expressions":{"linked_resource_id":{"references":["azurerm_log_analytics_workspace.modern.id","azurerm_log_analytics_workspace.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"scope_name":{"references":["azurerm_monitor_private_link_scope.modern.name","azurerm_monitor_private_link_scope.modern"]}},"schema_version":0,"depends_on":["azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern"]},{"address":"azurerm_monitor_private_link_scoped_service.modern_data_collection","mode":"managed","type":"azurerm_monitor_private_link_scoped_service","name":"modern_data_collection","provider_config_key":"azurerm","expressions":{"linked_resource_id":{"references":["azurerm_monitor_data_collection_endpoint.modern.id","azurerm_monitor_data_collection_endpoint.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"scope_name":{"references":["azurerm_monitor_private_link_scope.modern.name","azurerm_monitor_private_link_scope.modern"]}},"schema_version":0,"depends_on":["azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern"]},{"address":"azurerm_network_security_group.modern_bastion","mode":"managed","type":"azurerm_network_security_group","name":"modern_bastion","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"nsg\"].location","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"name":{"references":["local.modern_subnets_nsg[\"bastion\"].name","local.modern_subnets_nsg[\"bastion\"]","local.modern_subnets_nsg"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"nsg\"].name","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_network_security_group.modern_bau","mode":"managed","type":"azurerm_network_security_group","name":"modern_bau","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"nsg\"].location","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"name":{"references":["local.modern_subnets_nsg[\"bau\"].name","local.modern_subnets_nsg[\"bau\"]","local.modern_subnets_nsg"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"nsg\"].name","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_network_security_group.modern_irisuser","mode":"managed","type":"azurerm_network_security_group","name":"modern_irisuser","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"nsg\"].location","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"name":{"references":["local.modern_subnets_nsg[\"irisuser\"].name","local.modern_subnets_nsg[\"irisuser\"]","local.modern_subnets_nsg"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"nsg\"].name","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_network_security_group.modern_nbssclientsite","mode":"managed","type":"azurerm_network_security_group","name":"modern_nbssclientsite","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"nsg\"].location","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"name":{"references":["local.modern_subnets_nsg[\"nbssclientsite\"].name","local.modern_subnets_nsg[\"nbssclientsite\"]","local.modern_subnets_nsg"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"nsg\"].name","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_network_security_group.modern_pep","mode":"managed","type":"azurerm_network_security_group","name":"modern_pep","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"nsg\"].location","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"name":{"references":["local.modern_subnets_nsg[\"pep\"].name","local.modern_subnets_nsg[\"pep\"]","local.modern_subnets_nsg"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"nsg\"].name","azurerm_resource_group.modern[\"nsg\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_private_dns_zone_virtual_network_link.modern","mode":"managed","type":"azurerm_private_dns_zone_virtual_network_link","name":"modern","provider_config_key":"azurerm","expressions":{"name":{"references":["azurerm_virtual_network.modern.name","azurerm_virtual_network.modern"]},"private_dns_zone_name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["each.value.resource_group_name","each.value"]},"virtual_network_id":{"references":["azurerm_virtual_network.modern.id","azurerm_virtual_network.modern"]}},"schema_version":0,"for_each_expression":{"references":["data.azurerm_private_dns_zone.zone"]},"depends_on":["azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern"]},{"address":"azurerm_private_endpoint.automation_account_modern","mode":"managed","type":"azurerm_private_endpoint","name":"automation_account_modern","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"automation\"].location","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"name":{"references":["azurerm_automation_account.modern.name","azurerm_automation_account.modern"]},"private_dns_zone_group":[{"name":{"references":["azurerm_automation_account.modern.name","azurerm_automation_account.modern"]},"private_dns_zone_ids":{"references":["data.azurerm_private_dns_zone.zone[\"automation\"].id","data.azurerm_private_dns_zone.zone[\"automation\"]","data.azurerm_private_dns_zone.zone"]}}],"private_service_connection":[{"is_manual_connection":{"constant_value":false},"name":{"references":["azurerm_automation_account.modern.name","azurerm_automation_account.modern"]},"private_connection_resource_id":{"references":["azurerm_automation_account.modern.id","azurerm_automation_account.modern"]},"subresource_names":{"constant_value":["DSCAndHybridWorker"]}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"automation\"].name","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"subnet_id":{"references":["azurerm_subnet.modern[\"pep\"].id","azurerm_subnet.modern[\"pep\"]","azurerm_subnet.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"depends_on":["azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_subnet.modern"]},{"address":"azurerm_private_endpoint.key_vault_modern","mode":"managed","type":"azurerm_private_endpoint","name":"key_vault_modern","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"key_vault\"].location","azurerm_resource_group.modern[\"key_vault\"]","azurerm_resource_group.modern"]},"name":{"references":["azurerm_key_vault.modern.name","azurerm_key_vault.modern"]},"private_dns_zone_group":[{"name":{"references":["azurerm_key_vault.modern.name","azurerm_key_vault.modern"]},"private_dns_zone_ids":{"references":["data.azurerm_private_dns_zone.zone[\"key_vault\"].id","data.azurerm_private_dns_zone.zone[\"key_vault\"]","data.azurerm_private_dns_zone.zone"]}}],"private_service_connection":[{"is_manual_connection":{"constant_value":false},"name":{"references":["azurerm_key_vault.modern.name","azurerm_key_vault.modern"]},"private_connection_resource_id":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]},"subresource_names":{"constant_value":["vault"]}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"key_vault\"].name","azurerm_resource_group.modern[\"key_vault\"]","azurerm_resource_group.modern"]},"subnet_id":{"references":["azurerm_subnet.modern[\"pep\"].id","azurerm_subnet.modern[\"pep\"]","azurerm_subnet.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"depends_on":["azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_subnet.modern"]},{"address":"azurerm_private_endpoint.private_link_scope_modern","mode":"managed","type":"azurerm_private_endpoint","name":"private_link_scope_modern","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"monitoring\"].location","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"name":{"references":["azurerm_monitor_private_link_scope.modern.name","azurerm_monitor_private_link_scope.modern","var.environment_num"]},"private_dns_zone_group":[{"name":{"references":["azurerm_monitor_private_link_scope.modern.name","azurerm_monitor_private_link_scope.modern","var.environment_num"]},"private_dns_zone_ids":{"references":["data.azurerm_private_dns_zone.zone[\"monitor\"].id","data.azurerm_private_dns_zone.zone[\"monitor\"]","data.azurerm_private_dns_zone.zone","data.azurerm_private_dns_zone.zone[\"oms\"].id","data.azurerm_private_dns_zone.zone[\"oms\"]","data.azurerm_private_dns_zone.zone","data.azurerm_private_dns_zone.zone[\"ods\"].id","data.azurerm_private_dns_zone.zone[\"ods\"]","data.azurerm_private_dns_zone.zone","data.azurerm_private_dns_zone.zone[\"agentsvc\"].id","data.azurerm_private_dns_zone.zone[\"agentsvc\"]","data.azurerm_private_dns_zone.zone","data.azurerm_private_dns_zone.zone[\"storage_blob\"].id","data.azurerm_private_dns_zone.zone[\"storage_blob\"]","data.azurerm_private_dns_zone.zone"]}}],"private_service_connection":[{"is_manual_connection":{"constant_value":false},"name":{"references":["azurerm_monitor_private_link_scope.modern.name","azurerm_monitor_private_link_scope.modern","var.environment_num"]},"private_connection_resource_id":{"references":["azurerm_monitor_private_link_scope.modern.id","azurerm_monitor_private_link_scope.modern"]},"subresource_names":{"constant_value":["azuremonitor"]}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"monitoring\"].name","azurerm_resource_group.modern[\"monitoring\"]","azurerm_resource_group.modern"]},"subnet_id":{"references":["azurerm_subnet.modern[\"pep\"].id","azurerm_subnet.modern[\"pep\"]","azurerm_subnet.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"depends_on":["azurerm_monitor_private_link_scoped_service.modern","azurerm_monitor_private_link_scoped_service.modern_data_collection"]},{"address":"azurerm_private_endpoint.recovery_vault_modern","mode":"managed","type":"azurerm_private_endpoint","name":"recovery_vault_modern","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"backup\"].location","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"name":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern","var.environment_num"]},"private_dns_zone_group":[{"name":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern","var.environment_num"]},"private_dns_zone_ids":{"references":["data.azurerm_private_dns_zone.zone[\"recovery_vault\"].id","data.azurerm_private_dns_zone.zone[\"recovery_vault\"]","data.azurerm_private_dns_zone.zone"]}}],"private_service_connection":[{"is_manual_connection":{"constant_value":false},"name":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern","var.environment_num"]},"private_connection_resource_id":{"references":["azurerm_recovery_services_vault.modern.id","azurerm_recovery_services_vault.modern"]},"subresource_names":{"constant_value":["AzureBackup"]}}],"resource_group_name":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"subnet_id":{"references":["azurerm_subnet.modern[\"pep\"].id","azurerm_subnet.modern[\"pep\"]","azurerm_subnet.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"depends_on":["azurerm_role_assignment.recovery_vault"]},{"address":"azurerm_private_endpoint.storage_modern","mode":"managed","type":"azurerm_private_endpoint","name":"storage_modern","provider_config_key":"azurerm","expressions":{"location":{"references":["each.value.location","each.value"]},"name":{"references":["each.value.storage_account_name","each.value","each.value.endpoint_key","each.value","var.environment_num"]},"private_dns_zone_group":[{"name":{"references":["each.value.storage_account_name","each.value","each.value.endpoint_key","each.value","var.environment_num"]},"private_dns_zone_ids":{"references":["each.value.private_dns_zone_id","each.value"]}}],"private_service_connection":[{"is_manual_connection":{"constant_value":false},"name":{"references":["each.value.storage_account_name","each.value","each.value.endpoint_key","each.value","var.environment_num"]},"private_connection_resource_id":{"references":["each.value.storage_account_id","each.value"]},"subresource_names":{"references":["each.value.subresource_name","each.value"]}}],"resource_group_name":{"references":["each.value.resource_group_name","each.value"]},"subnet_id":{"references":["azurerm_subnet.modern[\"pep\"].id","azurerm_subnet.modern[\"pep\"]","azurerm_subnet.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"for_each_expression":{"references":["local.storage_endpoints_process"]},"depends_on":["azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_subnet.modern"]},{"address":"azurerm_public_ip.bastion","mode":"managed","type":"azurerm_public_ip","name":"bastion","provider_config_key":"azurerm","expressions":{"allocation_method":{"constant_value":"Static"},"idle_timeout_in_minutes":{"constant_value":4},"location":{"references":["azurerm_resource_group.modern[\"bastion\"].location","azurerm_resource_group.modern[\"bastion\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"bastion\"].name","azurerm_resource_group.modern[\"bastion\"]","azurerm_resource_group.modern"]},"sku":{"constant_value":"Standard"},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_recovery_services_vault.modern","mode":"managed","type":"azurerm_recovery_services_vault","name":"modern","provider_config_key":"azurerm","expressions":{"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["azurerm_resource_group.modern[\"backup\"].location","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"public_network_access_enabled":{"constant_value":false},"resource_group_name":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"sku":{"constant_value":"Standard"},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_resource_group.modern","mode":"managed","type":"azurerm_resource_group","name":"modern","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_resource_groups"]}},{"address":"azurerm_role_assignment.automation_account_subscription_virtual_machines","mode":"managed","type":"azurerm_role_assignment","name":"automation_account_subscription_virtual_machines","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_automation_account.modern.identity[0].principal_id","azurerm_automation_account.modern.identity[0]","azurerm_automation_account.modern.identity","azurerm_automation_account.modern"]},"role_definition_name":{"constant_value":"Virtual Machine Contributor"},"scope":{"references":["data.azurerm_subscription.current.id","data.azurerm_subscription.current"]}},"schema_version":0},{"address":"azurerm_role_assignment.avd_autoscale","mode":"managed","type":"azurerm_role_assignment","name":"avd_autoscale","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["data.azuread_service_principal.wvd.id","data.azuread_service_principal.wvd"]},"role_definition_id":{"references":["azurerm_role_definition.avd_autoscale.role_definition_resource_id","azurerm_role_definition.avd_autoscale"]},"scope":{"references":["azurerm_resource_group.modern","each.key"]},"skip_service_principal_aad_check":{"constant_value":true}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]}},{"address":"azurerm_role_assignment.avd_poweron_off","mode":"managed","type":"azurerm_role_assignment","name":"avd_poweron_off","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["data.azuread_service_principal.wvd.id","data.azuread_service_principal.wvd"]},"role_definition_name":{"constant_value":"Desktop Virtualization Power On Off Contributor"},"scope":{"references":["data.azurerm_client_config.current.subscription_id","data.azurerm_client_config.current"]},"skip_service_principal_aad_check":{"constant_value":true}},"schema_version":0},{"address":"azurerm_role_assignment.kv_aa_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_aa_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_user_assigned_identity.automation.principal_id","azurerm_user_assigned_identity.automation"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_aa_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_aa_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_user_assigned_identity.automation.principal_id","azurerm_user_assigned_identity.automation"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_deployment_account","mode":"managed","type":"azurerm_role_assignment","name":"kv_deployment_account","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"role_definition_name":{"constant_value":"Key Vault Administrator"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0},{"address":"azurerm_role_assignment.kv_rsv_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_rsv_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_recovery_services_vault.modern.identity[0].principal_id","azurerm_recovery_services_vault.modern.identity[0]","azurerm_recovery_services_vault.modern.identity","azurerm_recovery_services_vault.modern"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_rsv_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_rsv_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_recovery_services_vault.modern.identity[0].principal_id","azurerm_recovery_services_vault.modern.identity[0]","azurerm_recovery_services_vault.modern.identity","azurerm_recovery_services_vault.modern"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_st_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_st_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_storage_account.modern","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","local.modern_storage_accounts"]}},{"address":"azurerm_role_assignment.kv_st_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_st_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_storage_account.modern","each.key"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","local.modern_storage_accounts"]}},{"address":"azurerm_role_assignment.kv_testers_account","mode":"managed","type":"azurerm_role_assignment","name":"kv_testers_account","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["var.mod_testers","count.index"]},"role_definition_name":{"constant_value":"Key Vault Administrator"},"scope":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0,"count_expression":{"references":["var.mod_testers"]}},{"address":"azurerm_role_assignment.rbac_desktop_virtualization_user","mode":"managed","type":"azurerm_role_assignment","name":"rbac_desktop_virtualization_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azuread_group.session_host_users","each.key"]},"role_definition_name":{"constant_value":"Desktop Virtualization User"},"scope":{"references":["azurerm_virtual_desktop_application_group.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azuread_group.session_host_users"]},{"address":"azurerm_role_assignment.rbac_session_host_fslogix","mode":"managed","type":"azurerm_role_assignment","name":"rbac_session_host_fslogix","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azuread_group.session_host_users","each.key"]},"role_definition_name":{"constant_value":"Storage File Data SMB Share Contributor"},"scope":{"references":["azurerm_storage_account.modern[\"fslogix\"].id","azurerm_storage_account.modern[\"fslogix\"]","azurerm_storage_account.modern"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azuread_group.session_host_users"]},{"address":"azurerm_role_assignment.rbac_session_host_fslogix_privileged","mode":"managed","type":"azurerm_role_assignment","name":"rbac_session_host_fslogix_privileged","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azuread_group.session_host_users","each.key"]},"role_definition_name":{"constant_value":"Storage File Data Privileged Contributor"},"scope":{"references":["azurerm_storage_account.modern[\"fslogix\"].id","azurerm_storage_account.modern[\"fslogix\"]","azurerm_storage_account.modern"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azuread_group.session_host_users"]},{"address":"azurerm_role_assignment.rbac_session_host_login","mode":"managed","type":"azurerm_role_assignment","name":"rbac_session_host_login","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azuread_group.session_host_users","each.key"]},"role_definition_name":{"constant_value":"Virtual Machine User Login"},"scope":{"references":["azurerm_resource_group.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azuread_group.session_host_users"]},{"address":"azurerm_role_assignment.recovery_vault","mode":"managed","type":"azurerm_role_assignment","name":"recovery_vault","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_recovery_services_vault.modern.identity[0].principal_id","azurerm_recovery_services_vault.modern.identity[0]","azurerm_recovery_services_vault.modern.identity","azurerm_recovery_services_vault.modern"]},"role_definition_name":{"constant_value":"Contributor"},"scope":{"references":["azurerm_resource_group.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.recovery_vault_rg_permissions"]}},{"address":"azurerm_role_assignment.storage_account_mod_deployment_account","mode":"managed","type":"azurerm_role_assignment","name":"storage_account_mod_deployment_account","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"role_definition_name":{"references":["each.value.rbac_role","each.value"]},"scope":{"references":["each.value.storage_account_id","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.storage_rbac_process"]}},{"address":"azurerm_role_definition.avd_autoscale","mode":"managed","type":"azurerm_role_definition","name":"avd_autoscale","provider_config_key":"azurerm","expressions":{"description":{"constant_value":"AVD AutoScale Role"},"name":{"constant_value":"Mod-AVD-AutoScale"},"permissions":[{"actions":{"constant_value":["Microsoft.Insights/eventtypes/values/read","Microsoft.Compute/virtualMachines/deallocate/action","Microsoft.Compute/virtualMachines/restart/action","Microsoft.Compute/virtualMachines/powerOff/action","Microsoft.Compute/virtualMachines/start/action","Microsoft.Compute/virtualMachines/read","Microsoft.DesktopVirtualization/hostpools/read","Microsoft.DesktopVirtualization/hostpools/write","Microsoft.DesktopVirtualization/hostpools/sessionhosts/read","Microsoft.DesktopVirtualization/hostpools/sessionhosts/write","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/delete","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/read","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/sendMessage/action","Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/read","Microsoft.Authorization/roleAssignments/write"]},"not_actions":{"constant_value":[]}}],"scope":{"references":["data.azurerm_client_config.current.subscription_id","data.azurerm_client_config.current"]}},"schema_version":1},{"address":"azurerm_route.modern_outbound_internet_firewall","mode":"managed","type":"azurerm_route","name":"modern_outbound_internet_firewall","provider_config_key":"azurerm","expressions":{"address_prefix":{"constant_value":"0.0.0.0/0"},"name":{"constant_value":"Internet"},"next_hop_in_ip_address":{"references":["data.azurerm_firewall.hub.ip_configuration[0].private_ip_address","data.azurerm_firewall.hub.ip_configuration[0]","data.azurerm_firewall.hub.ip_configuration","data.azurerm_firewall.hub"]},"next_hop_type":{"constant_value":"VirtualAppliance"},"resource_group_name":{"references":["azurerm_resource_group.modern[\"network\"].name","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"route_table_name":{"references":["azurerm_route_table.modern_firewall.name","azurerm_route_table.modern_firewall"]}},"schema_version":0},{"address":"azurerm_route_table.modern_firewall","mode":"managed","type":"azurerm_route_table","name":"modern_firewall","provider_config_key":"azurerm","expressions":{"disable_bgp_route_propagation":{"constant_value":false},"location":{"references":["azurerm_resource_group.modern[\"network\"].location","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"network\"].name","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_security_center_auto_provisioning.modern","mode":"managed","type":"azurerm_security_center_auto_provisioning","name":"modern","provider_config_key":"azurerm","expressions":{"auto_provision":{"constant_value":"On"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.app_services","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"app_services","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"AppServices"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.arm","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"arm","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"Arm"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.container_registry","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"container_registry","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"ContainerRegistry"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.containers","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"containers","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"Containers"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.dns","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"dns","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"Dns"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.key_vault","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"key_vault","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"KeyVaults"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.kubernetes","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"kubernetes","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"KubernetesService"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.os_relational_databases","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"os_relational_databases","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"OpenSourceRelationalDatabases"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.sql_server_virtual_machines","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"sql_server_virtual_machines","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"SqlServerVirtualMachines"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.sql_servers","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"sql_servers","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"SqlServers"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.storage_accounts","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"storage_accounts","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"StorageAccounts"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_security_center_subscription_pricing.virtual_machines","mode":"managed","type":"azurerm_security_center_subscription_pricing","name":"virtual_machines","provider_config_key":"azurerm","expressions":{"resource_type":{"constant_value":"VirtualMachines"},"tier":{"constant_value":"Standard"}},"schema_version":1},{"address":"azurerm_storage_account.modern","mode":"managed","type":"azurerm_storage_account","name":"modern","provider_config_key":"azurerm","expressions":{"access_tier":{"references":["each.value.access_tier","each.value"]},"account_kind":{"references":["each.value.account_kind","each.value"]},"account_replication_type":{"references":["each.value.account_replication_type","each.value"]},"account_tier":{"references":["each.value.account_tier","each.value"]},"allow_nested_items_to_be_public":{"references":["each.value.public_blob_access","each.value"]},"blob_properties":[{"delete_retention_policy":[{"days":{"constant_value":30}}]}],"enable_https_traffic_only":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["each.value.location","each.value"]},"min_tls_version":{"constant_value":"TLS1_2"},"name":{"references":["each.value.name","each.value"]},"network_rules":[{"bypass":{"constant_value":["Logging","Metrics","AzureServices"]},"default_action":{"constant_value":"Deny"},"ip_rules":{"references":["var.deployment_public_ip_firewalls","data.http.myip.body","data.http.myip"]},"virtual_network_subnet_ids":{"references":["each.value"]}}],"resource_group_name":{"references":["each.value.resource_group_name","each.value"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":3,"for_each_expression":{"references":["local.modern_storage_accounts"]}},{"address":"azurerm_storage_account_customer_managed_key.modern","mode":"managed","type":"azurerm_storage_account_customer_managed_key","name":"modern","provider_config_key":"azurerm","expressions":{"key_name":{"references":["azurerm_key_vault_key.modern[0].name","azurerm_key_vault_key.modern[0]","azurerm_key_vault_key.modern"]},"key_vault_id":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]},"storage_account_id":{"references":["azurerm_storage_account.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","local.modern_storage_accounts"]},"depends_on":["azurerm_role_assignment.kv_st_reader","azurerm_role_assignment.kv_st_crypto_user"]},{"address":"azurerm_storage_blob.mod_file_blobs","mode":"managed","type":"azurerm_storage_blob","name":"mod_file_blobs","provider_config_key":"azurerm","expressions":{"content_md5":{"references":["each.value","each.value.source","each.value","each.value.source_content","each.value"]},"name":{"references":["each.value.name","each.value"]},"source":{"references":["each.value"]},"source_content":{"references":["each.value"]},"storage_account_name":{"references":["azurerm_storage_account.modern[\"blob\"].name","azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"storage_container_name":{"references":["each.value.container","each.value"]},"type":{"constant_value":"Block"}},"schema_version":1,"for_each_expression":{"references":["local.mod_storage_file_blobs"]},"depends_on":["azurerm_storage_container.mod_file"]},{"address":"azurerm_storage_container.mod_file","mode":"managed","type":"azurerm_storage_container","name":"mod_file","provider_config_key":"azurerm","expressions":{"container_access_type":{"references":["each.value.access_type","each.value"]},"name":{"references":["each.value.name","each.value"]},"storage_account_name":{"references":["azurerm_storage_account.modern[\"blob\"].name","azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]}},"schema_version":1,"for_each_expression":{"references":["module.blob_uploads.mod_containers","module.blob_uploads"]},"depends_on":["azurerm_role_assignment.storage_account_mod_deployment_account","azurerm_private_endpoint.storage_modern"]},{"address":"azurerm_storage_share.modern","mode":"managed","type":"azurerm_storage_share","name":"modern","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]},"quota":{"references":["each.value.quota","each.value"]},"storage_account_name":{"references":["azurerm_storage_account.modern","each.value.storage_account","each.value"]}},"schema_version":2,"for_each_expression":{"references":["local.modern_storage_file_shares"]},"depends_on":["azurerm_role_assignment.storage_account_mod_deployment_account","azurerm_private_endpoint.storage_modern"]},{"address":"azurerm_subnet.modern","mode":"managed","type":"azurerm_subnet","name":"modern","provider_config_key":"azurerm","expressions":{"address_prefixes":{"references":["each.value.range","each.value"]},"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"network\"].name","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"virtual_network_name":{"references":["azurerm_virtual_network.modern.name","azurerm_virtual_network.modern"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_subnets"]}},{"address":"azurerm_subnet_network_security_group_association.modern_bastion","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"modern_bastion","provider_config_key":"azurerm","expressions":{"network_security_group_id":{"references":["azurerm_network_security_group.modern_bastion.id","azurerm_network_security_group.modern_bastion"]},"subnet_id":{"references":["azurerm_subnet.modern[\"bastion\"].id","azurerm_subnet.modern[\"bastion\"]","azurerm_subnet.modern"]}},"schema_version":0,"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_subnet_network_security_group_association.modern_bau","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"modern_bau","provider_config_key":"azurerm","expressions":{"network_security_group_id":{"references":["azurerm_network_security_group.modern_bau.id","azurerm_network_security_group.modern_bau"]},"subnet_id":{"references":["azurerm_subnet.modern[\"bau\"].id","azurerm_subnet.modern[\"bau\"]","azurerm_subnet.modern"]}},"schema_version":0,"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_subnet_network_security_group_association.modern_irismirror","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"modern_irismirror","provider_config_key":"azurerm","expressions":{"network_security_group_id":{"references":["azurerm_network_security_group.modern_irisuser.id","azurerm_network_security_group.modern_irisuser"]},"subnet_id":{"references":["azurerm_subnet.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_subnets"]},"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_subnet_network_security_group_association.modern_irisuser","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"modern_irisuser","provider_config_key":"azurerm","expressions":{"network_security_group_id":{"references":["azurerm_network_security_group.modern_irisuser.id","azurerm_network_security_group.modern_irisuser"]},"subnet_id":{"references":["azurerm_subnet.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_subnets"]},"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_subnet_network_security_group_association.modern_nbssclientsite","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"modern_nbssclientsite","provider_config_key":"azurerm","expressions":{"network_security_group_id":{"references":["azurerm_network_security_group.modern_nbssclientsite.id","azurerm_network_security_group.modern_nbssclientsite"]},"subnet_id":{"references":["azurerm_subnet.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_subnets"]},"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_subnet_network_security_group_association.modern_pep","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"modern_pep","provider_config_key":"azurerm","expressions":{"network_security_group_id":{"references":["azurerm_network_security_group.modern_pep.id","azurerm_network_security_group.modern_pep"]},"subnet_id":{"references":["azurerm_subnet.modern[\"pep\"].id","azurerm_subnet.modern[\"pep\"]","azurerm_subnet.modern"]}},"schema_version":0,"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_subnet_route_table_association.modern","mode":"managed","type":"azurerm_subnet_route_table_association","name":"modern","provider_config_key":"azurerm","expressions":{"route_table_id":{"references":["azurerm_route_table.modern_firewall.id","azurerm_route_table.modern_firewall"]},"subnet_id":{"references":["azurerm_subnet.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_subnets"]},"depends_on":["azurerm_subnet.modern"]},{"address":"azurerm_user_assigned_identity.automation","mode":"managed","type":"azurerm_user_assigned_identity","name":"automation","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.modern[\"automation\"].location","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"automation\"].name","azurerm_resource_group.modern[\"automation\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags","var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]}},"schema_version":1},{"address":"azurerm_virtual_desktop_application_group.modern","mode":"managed","type":"azurerm_virtual_desktop_application_group","name":"modern","provider_config_key":"azurerm","expressions":{"description":{"references":["each.key","var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"friendly_name":{"constant_value":"Desktop AppGroup"},"host_pool_id":{"references":["azurerm_virtual_desktop_host_pool.modern","each.key"]},"location":{"references":["azurerm_resource_group.modern","each.key"]},"name":{"references":["each.key","var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern","each.key"]},"tags":{"references":["module.tags.value","module.tags"]},"type":{"constant_value":"Desktop"}},"schema_version":1,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azurerm_virtual_desktop_host_pool.modern","azurerm_virtual_desktop_workspace.modern"]},{"address":"azurerm_virtual_desktop_host_pool.modern","mode":"managed","type":"azurerm_virtual_desktop_host_pool","name":"modern","provider_config_key":"azurerm","expressions":{"custom_rdp_properties":{"constant_value":"audiocapturemode:i:1;audiomode:i:0;devicestoredirect:s:*;drivestoredirect:s:*;redirectprinters:i:1;enablerdsaadauth:i:1;usbdevicestoredirect:s:*;"},"description":{"references":["each.value.vdpool_description","each.value"]},"friendly_name":{"references":["each.value.vdpool_name","each.value"]},"load_balancer_type":{"constant_value":"DepthFirst"},"location":{"references":["var.location"]},"maximum_sessions_allowed":{"constant_value":50},"name":{"references":["each.value.vdpool_name","each.value"]},"resource_group_name":{"references":["each.value.resource_group_name","each.value"]},"start_vm_on_connect":{"constant_value":true},"tags":{"references":["module.tags.value","module.tags"]},"type":{"constant_value":"Pooled"},"validate_environment":{"constant_value":true}},"schema_version":1,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azurerm_resource_group.modern"]},{"address":"azurerm_virtual_desktop_host_pool_registration_info.avd","mode":"managed","type":"azurerm_virtual_desktop_host_pool_registration_info","name":"avd","provider_config_key":"azurerm","expressions":{"expiration_date":{},"hostpool_id":{"references":["azurerm_virtual_desktop_host_pool.modern","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azurerm_virtual_desktop_host_pool.modern"]},{"address":"azurerm_virtual_desktop_scaling_plan.modern","mode":"managed","type":"azurerm_virtual_desktop_scaling_plan","name":"modern","provider_config_key":"azurerm","expressions":{"description":{"references":["each.value.vdcsalling_description","each.value"]},"friendly_name":{"references":["each.value.vdcsalling_name","each.value"]},"host_pool":[{"hostpool_id":{"references":["azurerm_virtual_desktop_host_pool.modern","each.key"]},"scaling_plan_enabled":{"constant_value":true}}],"location":{"references":["var.location"]},"name":{"references":["each.value.vdcsalling_name","each.value"]},"resource_group_name":{"references":["each.value.resource_group_name","each.value"]},"schedule":[{"days_of_week":{"constant_value":["Monday","Tuesday","Wednesday","Thursday","Friday"]},"name":{"constant_value":"Weekdays"},"off_peak_load_balancing_algorithm":{"constant_value":"DepthFirst"},"off_peak_start_time":{"constant_value":"22:00"},"peak_load_balancing_algorithm":{"constant_value":"BreadthFirst"},"peak_start_time":{"constant_value":"09:00"},"ramp_down_capacity_threshold_percent":{"constant_value":5},"ramp_down_force_logoff_users":{"constant_value":false},"ramp_down_load_balancing_algorithm":{"constant_value":"DepthFirst"},"ramp_down_minimum_hosts_percent":{"constant_value":10},"ramp_down_notification_message":{"constant_value":"Please log off in the next 45 minutes..."},"ramp_down_start_time":{"constant_value":"19:00"},"ramp_down_stop_hosts_when":{"constant_value":"ZeroSessions"},"ramp_down_wait_time_minutes":{"constant_value":45},"ramp_up_capacity_threshold_percent":{"constant_value":10},"ramp_up_load_balancing_algorithm":{"constant_value":"BreadthFirst"},"ramp_up_minimum_hosts_percent":{"constant_value":20},"ramp_up_start_time":{"constant_value":"05:00"}}],"tags":{"references":["module.tags.value","module.tags","each.value.vdpool_name","each.value"]},"time_zone":{"constant_value":"GMT Standard Time"}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]}},{"address":"azurerm_virtual_desktop_workspace.modern","mode":"managed","type":"azurerm_virtual_desktop_workspace","name":"modern","provider_config_key":"azurerm","expressions":{"description":{"references":["each.value.vdws_description","each.value"]},"friendly_name":{"references":["each.value.vdws_name","each.value"]},"location":{"references":["var.location"]},"name":{"references":["each.value.vdws_name","each.value"]},"resource_group_name":{"references":["each.value.resource_group_name","each.value"]},"tags":{"references":["module.tags.value","module.tags","each.value.vdpool_name","each.value"]}},"schema_version":1,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azurerm_resource_group.modern"]},{"address":"azurerm_virtual_desktop_workspace_application_group_association.modern","mode":"managed","type":"azurerm_virtual_desktop_workspace_application_group_association","name":"modern","provider_config_key":"azurerm","expressions":{"application_group_id":{"references":["azurerm_virtual_desktop_application_group.modern","each.key"]},"workspace_id":{"references":["azurerm_virtual_desktop_workspace.modern","each.key"]}},"schema_version":1,"for_each_expression":{"references":["local.modern_avd"]}},{"address":"azurerm_virtual_machine_extension.vm_ext_avd_1","mode":"managed","type":"azurerm_virtual_machine_extension","name":"vm_ext_avd_1","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"avd_dsc"},"protected_settings":{"references":["azurerm_virtual_desktop_host_pool_registration_info.avd","each.key"]},"publisher":{"constant_value":"Microsoft.Powershell"},"settings":{"references":["azurerm_virtual_desktop_host_pool.modern","each.key"]},"type":{"constant_value":"DSC"},"type_handler_version":{"constant_value":"2.73"},"virtual_machine_id":{"references":["module.vm_session_host_1","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azurerm_virtual_desktop_host_pool.modern","azurerm_virtual_desktop_host_pool_registration_info.avd","module.vm_session_host_1"]},{"address":"azurerm_virtual_machine_extension.vm_ext_avd_2","mode":"managed","type":"azurerm_virtual_machine_extension","name":"vm_ext_avd_2","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"avd_dsc"},"protected_settings":{"references":["azurerm_virtual_desktop_host_pool_registration_info.avd","each.key"]},"publisher":{"constant_value":"Microsoft.Powershell"},"settings":{"references":["azurerm_virtual_desktop_host_pool.modern","each.key"]},"type":{"constant_value":"DSC"},"type_handler_version":{"constant_value":"2.73"},"virtual_machine_id":{"references":["module.vm_session_host_2","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azurerm_virtual_desktop_host_pool.modern","azurerm_virtual_desktop_host_pool_registration_info.avd","module.vm_session_host_2"]},{"address":"azurerm_virtual_machine_extension.vm_ext_avd_3","mode":"managed","type":"azurerm_virtual_machine_extension","name":"vm_ext_avd_3","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"avd_dsc"},"protected_settings":{"references":["azurerm_virtual_desktop_host_pool_registration_info.avd","each.key"]},"publisher":{"constant_value":"Microsoft.Powershell"},"settings":{"references":["azurerm_virtual_desktop_host_pool.modern","each.key"]},"type":{"constant_value":"DSC"},"type_handler_version":{"constant_value":"2.73"},"virtual_machine_id":{"references":["module.vm_session_host_3","each.key"]}},"schema_version":0,"for_each_expression":{"references":["local.modern_avd"]},"depends_on":["azurerm_virtual_desktop_host_pool.modern","azurerm_virtual_desktop_host_pool_registration_info.avd","module.vm_session_host_3"]},{"address":"azurerm_virtual_network.modern","mode":"managed","type":"azurerm_virtual_network","name":"modern","provider_config_key":"azurerm","expressions":{"address_space":{"references":["var.modern_vnet_range"]},"location":{"references":["azurerm_resource_group.modern[\"network\"].location","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"network\"].name","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"tags":{"references":["module.tags.value","module.tags"]}},"schema_version":0},{"address":"azurerm_virtual_network_dns_servers.modern","mode":"managed","type":"azurerm_virtual_network_dns_servers","name":"modern","provider_config_key":"azurerm","expressions":{"dns_servers":{"references":["data.azurerm_active_directory_domain_service.hub.replica_sets[0].domain_controller_ip_addresses","data.azurerm_active_directory_domain_service.hub.replica_sets[0]","data.azurerm_active_directory_domain_service.hub.replica_sets","data.azurerm_active_directory_domain_service.hub"]},"virtual_network_id":{"references":["azurerm_virtual_network.modern.id","azurerm_virtual_network.modern"]}},"schema_version":0},{"address":"azurerm_virtual_network_peering.devops_to_modern","mode":"managed","type":"azurerm_virtual_network_peering","name":"devops_to_modern","provider_config_key":"azurerm","expressions":{"allow_forwarded_traffic":{"constant_value":true},"allow_virtual_network_access":{"constant_value":true},"name":{"references":["azurerm_virtual_network.modern.name","azurerm_virtual_network.modern"]},"remote_virtual_network_id":{"references":["azurerm_virtual_network.modern.id","azurerm_virtual_network.modern"]},"resource_group_name":{"references":["data.azurerm_resource_group.devops[\"network\"].name","data.azurerm_resource_group.devops[\"network\"]","data.azurerm_resource_group.devops"]},"virtual_network_name":{"references":["data.azurerm_virtual_network.devops.name","data.azurerm_virtual_network.devops"]}},"schema_version":0},{"address":"azurerm_virtual_network_peering.hub_to_modern","mode":"managed","type":"azurerm_virtual_network_peering","name":"hub_to_modern","provider_config_key":"azurerm","expressions":{"allow_forwarded_traffic":{"constant_value":true},"allow_gateway_transit":{"constant_value":true},"allow_virtual_network_access":{"constant_value":true},"name":{"references":["azurerm_virtual_network.modern.name","azurerm_virtual_network.modern"]},"remote_virtual_network_id":{"references":["azurerm_virtual_network.modern.id","azurerm_virtual_network.modern"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"network\"].name","data.azurerm_resource_group.hub[\"network\"]","data.azurerm_resource_group.hub"]},"virtual_network_name":{"references":["data.azurerm_virtual_network.hub.name","data.azurerm_virtual_network.hub"]}},"schema_version":0},{"address":"azurerm_virtual_network_peering.modern_to_devops","mode":"managed","type":"azurerm_virtual_network_peering","name":"modern_to_devops","provider_config_key":"azurerm","expressions":{"allow_forwarded_traffic":{"constant_value":true},"allow_virtual_network_access":{"constant_value":true},"name":{"references":["data.azurerm_virtual_network.devops.name","data.azurerm_virtual_network.devops"]},"remote_virtual_network_id":{"references":["data.azurerm_virtual_network.devops.id","data.azurerm_virtual_network.devops"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"network\"].name","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"virtual_network_name":{"references":["azurerm_virtual_network.modern.name","azurerm_virtual_network.modern"]}},"schema_version":0},{"address":"azurerm_virtual_network_peering.modern_to_hub","mode":"managed","type":"azurerm_virtual_network_peering","name":"modern_to_hub","provider_config_key":"azurerm","expressions":{"allow_virtual_network_access":{"constant_value":true},"name":{"references":["data.azurerm_virtual_network.hub.name","data.azurerm_virtual_network.hub"]},"remote_virtual_network_id":{"references":["data.azurerm_virtual_network.hub.id","data.azurerm_virtual_network.hub"]},"resource_group_name":{"references":["azurerm_resource_group.modern[\"network\"].name","azurerm_resource_group.modern[\"network\"]","azurerm_resource_group.modern"]},"use_remote_gateways":{"constant_value":true},"virtual_network_name":{"references":["azurerm_virtual_network.modern.name","azurerm_virtual_network.modern"]}},"schema_version":0},{"address":"time_offset.next_day","mode":"managed","type":"time_offset","name":"next_day","provider_config_key":"time","expressions":{"offset_days":{"constant_value":1},"triggers":{"references":["local.update_time"]}},"schema_version":0},{"address":"time_sleep.wait_ad_replication","mode":"managed","type":"time_sleep","name":"wait_ad_replication","provider_config_key":"time","expressions":{"create_duration":{"constant_value":"120s"}},"schema_version":0,"depends_on":["azuread_group.vm_admins"]},{"address":"data.azuread_domains.azuread_domain","mode":"data","type":"azuread_domains","name":"azuread_domain","provider_config_key":"azuread","expressions":{"only_default":{"constant_value":true}},"schema_version":0},{"address":"data.azuread_service_principal.wvd","mode":"data","type":"azuread_service_principal","name":"wvd","provider_config_key":"azuread","expressions":{"application_id":{"constant_value":"9cdead84-a844-4324-93f2-b2e6bb768d07"}},"schema_version":0},{"address":"data.azurerm_active_directory_domain_service.hub","mode":"data","type":"azurerm_active_directory_domain_service","name":"hub","provider_config_key":"azurerm","expressions":{"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"aadds\"].name","data.azurerm_resource_group.hub[\"aadds\"]","data.azurerm_resource_group.hub"]}},"schema_version":0},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0},{"address":"data.azurerm_firewall.hub","mode":"data","type":"azurerm_firewall","name":"hub","provider_config_key":"azurerm","expressions":{"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment_num"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"network\"].name","data.azurerm_resource_group.hub[\"network\"]","data.azurerm_resource_group.hub"]}},"schema_version":0},{"address":"data.azurerm_firewall_policy.standard","mode":"data","type":"azurerm_firewall_policy","name":"standard","provider_config_key":"azurerm","expressions":{"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment_num"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"network\"].name","data.azurerm_resource_group.hub[\"network\"]","data.azurerm_resource_group.hub"]}},"schema_version":0},{"address":"data.azurerm_key_vault.hub","mode":"data","type":"azurerm_key_vault","name":"hub","provider_config_key":"azurerm","expressions":{"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"key_vault\"].name","data.azurerm_resource_group.hub[\"key_vault\"]","data.azurerm_resource_group.hub"]}},"schema_version":0},{"address":"data.azurerm_key_vault_secret.aadds_admin_password","mode":"data","type":"azurerm_key_vault_secret","name":"aadds_admin_password","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["data.azurerm_key_vault.hub.id","data.azurerm_key_vault.hub"]},"name":{"constant_value":"AADDSAdmin-Password"}},"schema_version":0},{"address":"data.azurerm_key_vault_secret.aadds_admin_username","mode":"data","type":"azurerm_key_vault_secret","name":"aadds_admin_username","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["data.azurerm_key_vault.hub.id","data.azurerm_key_vault.hub"]},"name":{"constant_value":"AADDSAdmin-Username"}},"schema_version":0},{"address":"data.azurerm_monitor_diagnostic_categories.automation_account_modern","mode":"data","type":"azurerm_monitor_diagnostic_categories","name":"automation_account_modern","provider_config_key":"azurerm","expressions":{"resource_id":{"references":["azurerm_automation_account.modern.id","azurerm_automation_account.modern"]}},"schema_version":0},{"address":"data.azurerm_monitor_diagnostic_categories.bastion","mode":"data","type":"azurerm_monitor_diagnostic_categories","name":"bastion","provider_config_key":"azurerm","expressions":{"resource_id":{"references":["azurerm_bastion_host.bastion.id","azurerm_bastion_host.bastion"]}},"schema_version":0},{"address":"data.azurerm_monitor_diagnostic_categories.key_vault_modern","mode":"data","type":"azurerm_monitor_diagnostic_categories","name":"key_vault_modern","provider_config_key":"azurerm","expressions":{"resource_id":{"references":["azurerm_key_vault.modern.id","azurerm_key_vault.modern"]}},"schema_version":0},{"address":"data.azurerm_monitor_diagnostic_categories.storage_account_modern","mode":"data","type":"azurerm_monitor_diagnostic_categories","name":"storage_account_modern","provider_config_key":"azurerm","expressions":{"resource_id":{"references":["each.value.storage_account_id","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.storage_diagnostics_process"]}},{"address":"data.azurerm_private_dns_zone.zone","mode":"data","type":"azurerm_private_dns_zone","name":"zone","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"network\"].name","data.azurerm_resource_group.hub[\"network\"]","data.azurerm_resource_group.hub"]}},"schema_version":0,"for_each_expression":{"references":["local.private_dns_zones"]}},{"address":"data.azurerm_resource_group.devops","mode":"data","type":"azurerm_resource_group","name":"devops","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.devops_resource_groups"]}},{"address":"data.azurerm_resource_group.environment","mode":"data","type":"azurerm_resource_group","name":"environment","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.environment_resource_groups"]}},{"address":"data.azurerm_resource_group.hub","mode":"data","type":"azurerm_resource_group","name":"hub","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.hub_resource_groups"]}},{"address":"data.azurerm_resource_group.support","mode":"data","type":"azurerm_resource_group","name":"support","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.support_resource_groups"]}},{"address":"data.azurerm_storage_account.hub","mode":"data","type":"azurerm_storage_account","name":"hub","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["each.value.resource_group_name","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.hub_storage_accounts"]}},{"address":"data.azurerm_storage_blob.file_blobs","mode":"data","type":"azurerm_storage_blob","name":"file_blobs","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]},"storage_account_name":{"references":["data.azurerm_storage_account.hub[\"file\"].name","data.azurerm_storage_account.hub[\"file\"]","data.azurerm_storage_account.hub"]},"storage_container_name":{"references":["data.azurerm_storage_container.file","each.value.container","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.storage_file_blobs"]}},{"address":"data.azurerm_storage_container.file","mode":"data","type":"azurerm_storage_container","name":"file","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]},"storage_account_name":{"references":["data.azurerm_storage_account.hub[\"file\"].name","data.azurerm_storage_account.hub[\"file\"]","data.azurerm_storage_account.hub"]}},"schema_version":0,"for_each_expression":{"references":["module.blob_uploads.containers","module.blob_uploads"]}},{"address":"data.azurerm_subnet.hub","mode":"data","type":"azurerm_subnet","name":"hub","provider_config_key":"azurerm","expressions":{"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"network\"].name","data.azurerm_resource_group.hub[\"network\"]","data.azurerm_resource_group.hub"]},"virtual_network_name":{"references":["data.azurerm_virtual_network.hub.name","data.azurerm_virtual_network.hub"]}},"schema_version":0,"for_each_expression":{"references":["local.hub_subnets"]}},{"address":"data.azurerm_subscription.current","mode":"data","type":"azurerm_subscription","name":"current","provider_config_key":"azurerm","schema_version":0},{"address":"data.azurerm_virtual_network.devops","mode":"data","type":"azurerm_virtual_network","name":"devops","provider_config_key":"azurerm","expressions":{"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment_num"]},"resource_group_name":{"references":["data.azurerm_resource_group.devops[\"network\"].name","data.azurerm_resource_group.devops[\"network\"]","data.azurerm_resource_group.devops"]}},"schema_version":0},{"address":"data.azurerm_virtual_network.hub","mode":"data","type":"azurerm_virtual_network","name":"hub","provider_config_key":"azurerm","expressions":{"name":{"references":["var.org_name","module.regions.short_names","module.regions","var.location","module.environments.short_names","module.environments","var.environment_num"]},"resource_group_name":{"references":["data.azurerm_resource_group.hub[\"network\"].name","data.azurerm_resource_group.hub[\"network\"]","data.azurerm_resource_group.hub"]}},"schema_version":0},{"address":"data.external.env","mode":"data","type":"external","name":"env","provider_config_key":"external","expressions":{"program":{"constant_value":["jq","-n","env"]}},"schema_version":0},{"address":"data.http.myip","mode":"data","type":"http","name":"myip","provider_config_key":"http","expressions":{"url":{"constant_value":"http://ipv4.icanhazip.com"}},"schema_version":0},{"address":"data.local_file.vm_start_stop_runbook","mode":"data","type":"local_file","name":"vm_start_stop_runbook","provider_config_key":"local","expressions":{"filename":{"constant_value":"../scripts/vm_auto_start_stop.ps1"}},"schema_version":0}],"module_calls":{"bau_support_vm":{"source":"../../tf_modules/vm","expressions":{"backup_policy":{"references":["azurerm_backup_policy_vm.modern_standard.name","azurerm_backup_policy_vm.modern_standard"]},"computer_name":{"references":["each.value.support_vm_computer_name","each.value"]},"custom_script":{"constant_value":true},"custom_script_url":{"references":["data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"].url","data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"]","data.azurerm_storage_blob.file_blobs"]},"customer_managed_keys":{"references":["var.customer_managed_keys"]},"data_collection_endpoint":{"references":["azurerm_monitor_data_collection_endpoint.modern"]},"data_collection_rule":{"references":["azurerm_monitor_data_collection_rule.modern"]},"domain_name":{"references":["data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"domain_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"domain_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"image":{"constant_value":"windows-2022-datacenter"},"key_vault":{"references":["azurerm_key_vault.modern"]},"key_vault_key":{"references":["var.customer_managed_keys","azurerm_key_vault_key.modern[0]","azurerm_key_vault_key.modern"]},"local_admins_group":{"references":["azuread_group.bau_vm_admins","each.key","data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"local_power_users_group":{"references":["azuread_group.bau_vm_power_users","each.key","data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"location":{"references":["azurerm_resource_group.modern[\"bau\"].location","azurerm_resource_group.modern[\"bau\"]","azurerm_resource_group.modern"]},"log_analytics":{"references":["azurerm_log_analytics_workspace.modern"]},"log_storage":{"references":["azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"name":{"references":["each.value.support_vm_name","each.value"]},"os_type":{"constant_value":"windows"},"recovery_resource_group":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"recovery_vault":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group":{"references":["azurerm_resource_group.modern[\"bau\"]","azurerm_resource_group.modern"]},"size":{"constant_value":"Standard_D4s_v5"},"storage_account_type":{"constant_value":"StandardSSD_LRS"},"tags":{"references":["module.tags.value","module.tags"]},"vnet_subnet":{"references":["azurerm_subnet.modern[\"bau\"]","azurerm_subnet.modern"]}},"for_each_expression":{"references":["local.bau_support_vm"]},"module":{"outputs":{"admin_password":{"sensitive":true,"expression":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"description":"Admin Password"},"admin_username":{"expression":{"references":["var.server_admin_name"]},"description":"Admin Username"},"location":{"expression":{"references":["var.location"]},"description":"Virtual Machine Location"},"name":{"expression":{"references":["var.name"]},"description":"Virtual Machine name"},"nic_id":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Nic IDs"},"private_ip":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Private IPv4 for the Virtual Machine"},"resource_group":{"expression":{"references":["var.resource_group.name","var.resource_group"]},"description":"Resource Group"},"ssh_private_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"SSH Private Key File"},"ssh_public_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"Public SSH Key"},"vm_id":{"expression":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"description":"Virtual Machine ID"}},"resources":[{"address":"azurerm_backup_protected_vm.vm_backup","mode":"managed","type":"azurerm_backup_protected_vm","name":"vm_backup","provider_config_key":"azurerm","expressions":{"backup_policy_id":{"references":["data.azurerm_backup_policy_vm.policy.id","data.azurerm_backup_policy_vm.policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]},"source_vm_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"azurerm_disk_encryption_set.vm_data","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_data","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_disk_encryption_set.vm_os","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_os","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_access_policy.vm","mode":"managed","type":"azurerm_key_vault_access_policy","name":"vm","provider_config_key":"azurerm","expressions":{"key_permissions":{"constant_value":["Get","WrapKey","UnwrapKey"]},"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"object_id":{"references":["azurerm_windows_virtual_machine.vm[0].identity[0].principal_id","azurerm_windows_virtual_machine.vm[0].identity[0]","azurerm_windows_virtual_machine.vm[0].identity","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_secret.vm_password","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_password","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["random_password.vm_admin.result","random_password.vm_admin"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_ssh_key","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_ssh_key","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_username","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_username","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["var.server_admin_name"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_ssh_key":[{"public_key":{"references":["tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"username":{"references":["var.server_admin_name"]}}],"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"disable_password_authentication":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]}},{"address":"azurerm_managed_disk.vm_data","mode":"managed","type":"azurerm_managed_disk","name":"vm_data","provider_config_key":"azurerm","expressions":{"create_option":{"constant_value":"Empty"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_data","each.key"]},"disk_size_gb":{"references":["var.data_disks","each.key"]},"location":{"references":["var.location"]},"name":{"references":["var.data_disks","each.key"]},"network_access_policy":{"constant_value":"DenyAll"},"public_network_access_enabled":{"constant_value":false},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"storage_account_type":{"references":["var.data_disks","each.key"]},"zone":{"references":["var.zone"]}},"schema_version":1,"for_each_expression":{"references":["var.data_disks"]},"depends_on":["azurerm_role_assignment.kv_vm_data_crypto_service_user","azurerm_role_assignment.kv_vm_data_crypto_user","azurerm_role_assignment.kv_vm_data_reader"]},{"address":"azurerm_monitor_data_collection_rule_association.vm_endpoint","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_endpoint","provider_config_key":"azurerm","expressions":{"data_collection_endpoint_id":{"references":["var.data_collection_endpoint.id","var.data_collection_endpoint"]},"description":{"references":["var.os_type","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_monitor_data_collection_rule_association.vm_rule","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_rule","provider_config_key":"azurerm","expressions":{"data_collection_rule_id":{"references":["var.data_collection_rule.id","var.data_collection_rule"]},"description":{"references":["var.os_type","var.data_collection_rule.name","var.data_collection_rule","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_rule.name","var.data_collection_rule","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"name":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"references":["each.value.ipconfig_name","each.value","each.value.ipconfig_name","each.value"]},"private_ip_address":{"references":["each.value.private_ip_address","each.value","each.value.private_ip_address","each.value"]},"private_ip_address_allocation":{"references":["each.value.private_ip_address_allocation","each.value"]},"subnet_id":{"references":["each.value.vnet_subnet_id","each.value","var.vnet_subnet.id","var.vnet_subnet","each.value.vnet_subnet_id","each.value"]}}],"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value","var.name","each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"tags":{"references":["var.tags"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_virtual_machine_data_disk_attachment.vm_data","mode":"managed","type":"azurerm_virtual_machine_data_disk_attachment","name":"vm_data","provider_config_key":"azurerm","expressions":{"caching":{"constant_value":"ReadWrite"},"lun":{"references":["var.data_disks","each.key"]},"managed_disk_id":{"references":["azurerm_managed_disk.vm_data","each.key"]},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"for_each_expression":{"references":["var.data_disks"]}},{"address":"azurerm_virtual_machine_extension.azure_monitor","mode":"managed","type":"azurerm_virtual_machine_extension","name":"azure_monitor","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Azure_Monitor_Windows_Agent"},"publisher":{"constant_value":"Microsoft.Azure.Monitor"},"tags":{"references":["var.tags"]},"type":{"constant_value":"AzureMonitorWindowsAgent"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.managed_identity"]},{"address":"azurerm_virtual_machine_extension.custom_script","mode":"managed","type":"azurerm_virtual_machine_extension","name":"custom_script","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Custom_Script"},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["local.custom_script_file_uris","local.custom_script_command"]},"type":{"constant_value":"CustomScriptExtension"},"type_handler_version":{"constant_value":"1.10"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.custom_script"]},"depends_on":["azurerm_virtual_machine_extension.guest_configuration"]},{"address":"azurerm_virtual_machine_extension.defender","mode":"managed","type":"azurerm_virtual_machine_extension","name":"defender","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"IaaS_Antimalware"},"publisher":{"constant_value":"Microsoft.Azure.Security"},"settings":{"constant_value":"  {\n    \"AntimalwareEnabled\": \"true\",\n    \"RealtimeProtectionEnabled\": \"true\",\n    \"ScheduledScanSettings\": {\n      \"isEnabled\": \"true\",\n      \"scanType\": \"Quick\",\n      \"day\": \"7\",\n      \"time\": \"120\"\n    }\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"IaaSAntimalware"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.network_watcher"]},{"address":"azurerm_virtual_machine_extension.domain_join_extension","mode":"managed","type":"azurerm_virtual_machine_extension","name":"domain_join_extension","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Domain_Join"},"protected_settings":{"references":["var.domain_password"]},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["var.domain_name","var.domain_name","var.domain_username"]},"tags":{"references":["var.tags"]},"type":{"constant_value":"JsonADDomainExtension"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.domain_name","var.domain_username","var.domain_password"]},"depends_on":["azurerm_virtual_machine_extension.custom_script"]},{"address":"azurerm_virtual_machine_extension.guest_configuration","mode":"managed","type":"azurerm_virtual_machine_extension","name":"guest_configuration","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Guest_Configuration"},"publisher":{"constant_value":"Microsoft.GuestConfiguration"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ConfigurationforWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_extension.defender"]},{"address":"azurerm_virtual_machine_extension.managed_identity","mode":"managed","type":"azurerm_virtual_machine_extension","name":"managed_identity","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Managed_Identity"},"publisher":{"constant_value":"Microsoft.ManagedIdentity"},"settings":{"constant_value":"  {\n    \"port\": \"50342\"\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ManagedIdentityExtensionForWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_data_disk_attachment.vm_data"]},{"address":"azurerm_virtual_machine_extension.network_watcher","mode":"managed","type":"azurerm_virtual_machine_extension","name":"network_watcher","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Network_Watcher_Agent"},"publisher":{"constant_value":"Microsoft.Azure.NetworkWatcher"},"tags":{"references":["var.tags"]},"type":{"constant_value":"NetworkWatcherAgentWindows"},"type_handler_version":{"constant_value":"1.4"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.azure_monitor"]},{"address":"azurerm_windows_virtual_machine.vm","mode":"managed","type":"azurerm_windows_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_password":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"computer_name":{"references":["var.computer_name"]},"enable_automatic_updates":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"license_type":{"references":["local.image_skus","var.image"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_os[0].id","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"patch_mode":{"constant_value":"AutomaticByOS"},"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_disk_encryption_set.vm_os","azurerm_role_assignment.kv_vm_os_reader","azurerm_role_assignment.kv_vm_os_crypto_user","azurerm_role_assignment.kv_vm_os_crypto_service_user"]},{"address":"null_resource.ansible_windows_updates","mode":"managed","type":"null_resource","name":"ansible_windows_updates","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.windows_update_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.windows_update_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.windows_update"]},"depends_on":["time_sleep.wait_vm_reboot","null_resource.local_admin_group","null_resource.disable_server_manager_login"]},{"address":"null_resource.disable_server_manager_login","mode":"managed","type":"null_resource","name":"disable_server_manager_login","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.disable_server_manager_startup_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.disable_server_manager_startup_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.ie_configuration","mode":"managed","type":"null_resource","name":"ie_configuration","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.ie_configuration","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.ie_configuration"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_admin_group","mode":"managed","type":"null_resource","name":"local_admin_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_admins_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_admins_group"]}}}],"expressions":{"triggers":{"references":["local.local_admins_script","var.local_admins_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_admins_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_power_users_group","mode":"managed","type":"null_resource","name":"local_power_users_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_power_users_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_power_users_group"]}}}],"expressions":{"triggers":{"references":["local.local_power_users_script","var.local_power_users_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_power_users_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"random_password.vm_admin","mode":"managed","type":"random_password","name":"vm_admin","provider_config_key":"random","expressions":{"length":{"references":["var.random_password_length"]},"override_special":{"constant_value":"_%@"},"special":{"constant_value":true}},"schema_version":0},{"address":"time_sleep.wait_vm_reboot","mode":"managed","type":"time_sleep","name":"wait_vm_reboot","provider_config_key":"time","expressions":{"create_duration":{"constant_value":"300s"}},"schema_version":0,"depends_on":["azurerm_virtual_machine_extension.domain_join_extension"]},{"address":"tls_private_key.vm_ssh_key","mode":"managed","type":"tls_private_key","name":"vm_ssh_key","provider_config_key":"module.bau_support_vm:tls","expressions":{"algorithm":{"constant_value":"RSA"},"rsa_bits":{"constant_value":4096}},"schema_version":1,"count_expression":{"references":["var.os_type"]}},{"address":"data.azuread_user.domain_username","mode":"data","type":"azuread_user","name":"domain_username","provider_config_key":"azuread","expressions":{"user_principal_name":{"references":["var.domain_username"]}},"schema_version":0},{"address":"data.azurerm_backup_policy_vm.policy","mode":"data","type":"azurerm_backup_policy_vm","name":"policy","provider_config_key":"azurerm","expressions":{"name":{"references":["var.backup_policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]}},"schema_version":0},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0},{"address":"data.azurerm_network_interface.vm","mode":"data","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"name":{"references":["azurerm_network_interface.vm","each.key"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]},"depends_on":["azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm"]}],"variables":{"backup_policy":{"default":null,"description":"Backup Policy to apply to the VM"},"computer_name":{"description":"Name of the internal SO computer."},"custom_script":{"default":false,"description":"Enable deployment of a Custom Script"},"custom_script_url":{"default":"","description":"The Custom Script URL to be downloaded and run on the VM"},"customer_managed_keys":{"default":false,"description":"Set if cutomer managed keys are used."},"data_collection_endpoint":{"description":"Data collection endpoint to add to vm."},"data_collection_rule":{"description":"Data collection rule to add to vm."},"data_disks":{"default":{},"description":"List of objects for creating data disks."},"domain_name":{"default":null,"description":"The Domain Name to join the Virtual Machine to"},"domain_password":{"default":null,"description":"The Domain Password of an account to use to join machine to domain but also run scripts with","sensitive":true},"domain_username":{"default":null,"description":"The Domain Username of an account used to join machine to domain but also run scripts with"},"image":{"default":"windows-2022-datacenter","description":"Image offer for the Virtual Machine"},"key_vault":{"default":null,"description":"Key Vault to store Virtual Machine credentials inside"},"key_vault_key":{"default":null,"description":"Certificate key for disk encryption."},"local_admins_group":{"default":null,"description":"AD Group to add into the Local Administrators on the server"},"local_power_users_group":{"default":null,"description":"AD Group to add into the Local Porwer Users on the server"},"location":{"default":"uksouth","description":"The location/region where the resources are created"},"log_analytics":{"default":null,"description":"Log Analytics workspace to use for VM logging"},"log_storage":{"default":null,"description":"Storage Account to use for VM logging"},"name":{"description":"Name of the Virtual Machine"},"nics":{"default":{"first":{"ipconfig_name":"default","name":"default","private_ip_address":"default","private_ip_address_allocation":"Dynamic","vnet_subnet_id":"default"}},"description":"List of objects for creating nics."},"os_type":{"default":"windows"},"random_password_length":{"default":64,"description":"The desired length of random password created by this module"},"recovery_resource_group":{"default":null,"description":"The Resource Group object in which the recovery vault is in"},"recovery_vault":{"default":null,"description":"Recovery Vault to backup to"},"resource_group":{"description":"The Resource Group object in which the resources will be created"},"running_days":{"default":""},"second_custom_script":{"default":false,"description":"Enable deployment of a second custom Script"},"second_custom_script_url":{"default":"","description":"The Second Custom Script URL to be downloaded and run on the VM."},"server_admin_name":{"default":"sysadmin","description":"Name of the Virtual Machine Server Admin Account"},"shutdown_hour":{"default":""},"size":{"default":"Standard_B1s","description":"Specifies the size of the virtual machine"},"startup_hour":{"default":""},"storage_account_type":{"default":"Standard_LRS","description":"Defines the type of storage to use for the Virtual Machine Scale Set"},"tags":{"default":{}},"vnet_subnet":{"description":"Virtual Machine NIC Subnet to connect with"},"windows_update":{"default":true,"description":"Applies the latest Windows Updates after deployment"},"zone":{"default":null,"description":"List of zones where the vm is created."}}},"depends_on":["time_sleep.wait_ad_replication","azurerm_subnet.modern","azurerm_subnet_route_table_association.modern","azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_private_endpoint.recovery_vault_modern","azuread_group.bau_vm_admins","azuread_group.bau_vm_power_users"]},"blob_uploads":{"source":"../../tf_modules/blob_uploads","module":{"outputs":{"blobs":{"expression":{"references":["local.storage_file_blobs"]},"description":"Blobs which we are uploading / have uploaded to the Hub Storage Account"},"containers":{"expression":{"references":["local.file_blob_containers"]},"description":"Containers which are created and used by the blobs in the Hub Storage Account"},"mod_blobs":{"expression":{"references":["local.mod_storage_file_blobs"]},"description":"Blobs which we are uploading / have uploaded to the Modernisation Storage Account"},"mod_containers":{"expression":{"references":["local.mod_file_blob_containers"]},"description":"Containers which are created and used by the blobs in the Modernisation Storage Account"}}}},"environments":{"source":"../../tf_modules/environments","module":{"outputs":{"environment_subnet_names":{"expression":{"references":["local.environment_subnets"]},"description":"Environment Subnet Names"},"full_names":{"expression":{"references":["local.full_environment_names"]},"description":"Full Environment Names"},"networking_code":{"expression":{"references":["local.environment_networking"]},"description":"A number used to workout a unique networking range for the environment"},"short_names":{"expression":{"references":["local.short_environment_names"]},"description":"Short Environment Abbreviations"}}}},"primary_vm_ansible_winserver_baseline":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_winserver_security_baseline.yml"},"server_admin_password":{"references":["module.vm_primary_iris_db","each.key"]},"server_admin_username":{"references":["module.vm_primary_iris_db","each.key"]},"vm_network_address":{"references":["module.vm_primary_iris_db","each.key"]}},"for_each_expression":{"references":["local.modern_irisdb"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}},"depends_on":["module.vm_primary_iris_db"]},"regions":{"source":"../../tf_modules/regions","module":{"outputs":{"region_pairs":{"expression":{"references":["local.region_pairs"]},"description":"Map of regions and their DR pair useful for lookups"},"short_names":{"expression":{"references":["local.short_region_names"]},"description":"Short Region Abbreviations"}}}},"tags":{"source":"../../tf_modules/tags","expressions":{"app":{"references":["var.tag_app"]},"environment":{"references":["var.tag_environment"]},"project":{"references":["var.tag_project"]},"service":{"references":["var.tag_service"]},"shared":{"references":["var.tag_shared"]},"site":{"references":["var.tag_site"]}},"module":{"outputs":{"value":{"expression":{"references":["local.tags"]},"description":"Global Environment Tags"}},"variables":{"app":{"description":"Application we are deploying"},"environment":{"description":"Environment we are deploying"},"project":{"description":"Project these resources are deployed for"},"service":{"description":"Service these resources provide"},"shared":{"description":"Definition about Shared resources"},"site":{"description":"Site from the resource"}}}},"vm_ansible_bau_support":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_support_vm.yml"},"server_admin_password":{"references":["module.bau_support_vm","each.key"]},"server_admin_username":{"references":["module.bau_support_vm","each.key"]},"vm_network_address":{"references":["module.bau_support_vm","each.key"]}},"for_each_expression":{"references":["local.bau_support_vm"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}},"depends_on":["module.bau_support_vm"]},"vm_ansible_files_ini_nbss_1":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_nbss_ini_files.yml"},"debug":{"constant_value":true},"server_admin_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"server_admin_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"vm_network_address":{"references":["module.vm_session_host_1","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}}},"vm_ansible_files_ini_nbss_2":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_nbss_ini_files.yml"},"debug":{"constant_value":true},"server_admin_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"server_admin_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"vm_network_address":{"references":["module.vm_session_host_2","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}}},"vm_ansible_files_ini_nbss_3":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_nbss_ini_files.yml"},"debug":{"constant_value":true},"server_admin_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"server_admin_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"vm_network_address":{"references":["module.vm_session_host_3","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}}},"vm_ansible_w10_baseline_1":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_win10_security_baseline.yml"},"debug":{"constant_value":true},"server_admin_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"server_admin_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"vm_network_address":{"references":["module.vm_session_host_1","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}},"depends_on":["azurerm_virtual_machine_extension.vm_ext_avd_1"]},"vm_ansible_w10_baseline_2":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_win10_security_baseline.yml"},"debug":{"constant_value":true},"server_admin_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"server_admin_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"vm_network_address":{"references":["module.vm_session_host_2","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}},"depends_on":["azurerm_virtual_machine_extension.vm_ext_avd_2"]},"vm_ansible_w10_baseline_3":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_win10_security_baseline.yml"},"debug":{"constant_value":true},"server_admin_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"server_admin_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"vm_network_address":{"references":["module.vm_session_host_3","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}},"depends_on":["azurerm_virtual_machine_extension.vm_ext_avd_3"]},"vm_ansible_win10_baseline_bau_support":{"source":"../../tf_modules/vm_ansible","expressions":{"ansible_script":{"constant_value":"../../ansible/deploy_winserver_security_baseline.yml"},"server_admin_password":{"references":["module.bau_support_vm","each.key"]},"server_admin_username":{"references":["module.bau_support_vm","each.key"]},"vm_network_address":{"references":["module.bau_support_vm","each.key"]}},"for_each_expression":{"references":["local.bau_support_vm"]},"module":{"resources":[{"address":"null_resource.ansible_script","mode":"managed","type":"null_resource","name":"ansible_script","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["var.ansible_script","var.vm_network_address","var.debug","var.server_admin_username","var.server_admin_password","var.additional_cmd_options"]}}}],"expressions":{"triggers":{"references":["var.ansible_script"]}},"schema_version":0}],"variables":{"additional_cmd_options":{"default":"","description":"Additional command line options to pass to Ansible"},"ansible_script":{"description":"The Ansible Script to be run on the VM"},"debug":{"default":false,"description":"Turns on verbose output from Ansible to help debug a script"},"server_admin_password":{"description":"Password of the Admin account to run the script under","sensitive":true},"server_admin_username":{"description":"Username of an Admin account to run the script under"},"vm_network_address":{"description":"FQDN or IP address of the Virtual Machine to run the Ansible script on"}}},"depends_on":["module.bau_support_vm"]},"vm_primary_iris_db":{"source":"../../tf_modules/vm","expressions":{"backup_policy":{"references":["azurerm_backup_policy_vm.modern_standard.name","azurerm_backup_policy_vm.modern_standard"]},"computer_name":{"references":["each.value.primary_computer_name","each.value"]},"custom_script":{"constant_value":true},"custom_script_url":{"references":["data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"].url","data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"]","data.azurerm_storage_blob.file_blobs"]},"customer_managed_keys":{"references":["var.customer_managed_keys"]},"data_collection_endpoint":{"references":["azurerm_monitor_data_collection_endpoint.modern"]},"data_collection_rule":{"references":["azurerm_monitor_data_collection_rule.modern"]},"data_disks":{"references":["each.value.primary_vm_data_disks","each.value"]},"domain_name":{"references":["data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"domain_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"domain_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"image":{"constant_value":"windows-2022-datacenter"},"key_vault":{"references":["azurerm_key_vault.modern"]},"key_vault_key":{"references":["var.customer_managed_keys","azurerm_key_vault_key.modern[0]","azurerm_key_vault_key.modern"]},"local_admins_group":{"references":["azuread_group.irisdb_vm_admins","each.key","data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"local_power_users_group":{"references":["azuread_group.irisdb_vm_power_users","each.key","data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"location":{"references":["azurerm_resource_group.modern","each.value.resource_group_key","each.value"]},"log_analytics":{"references":["azurerm_log_analytics_workspace.modern"]},"log_storage":{"references":["azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"name":{"references":["each.value.primary_vm_name","each.value"]},"nics":{"references":["each.value.primary_vm_user_nic_name","each.value","each.value.primary_vm_user_nic_ipconfig_name","each.value","azurerm_subnet.modern","each.value.subnet_primary_key","each.value","each.value.primary_vm_user_private_ip","each.value","each.value.primary_vm_mirror_nic_name","each.value","each.value.primary_vm_mirror_nic_ipconfig_name","each.value","azurerm_subnet.modern","each.value.subnet_mirror_key","each.value","each.value.primary_vm_mirror_private_ip","each.value"]},"os_type":{"constant_value":"windows"},"recovery_resource_group":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"recovery_vault":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group":{"references":["azurerm_resource_group.modern","each.value.resource_group_key","each.value"]},"second_custom_script":{"constant_value":true},"second_custom_script_url":{"references":["azurerm_storage_blob.mod_file_blobs[\"attach_iris_db_windows_disks\"].url","azurerm_storage_blob.mod_file_blobs[\"attach_iris_db_windows_disks\"]","azurerm_storage_blob.mod_file_blobs"]},"size":{"references":["var.iris_db_primary_vm_sku"]},"storage_account_type":{"constant_value":"StandardSSD_LRS"},"tags":{"references":["module.tags.value","module.tags"]},"vnet_subnet":{"references":["azurerm_subnet.modern","each.value.subnet_primary_key","each.value"]},"zone":{"references":["each.value.primary_vm_zone","each.value"]}},"for_each_expression":{"references":["local.modern_irisdb"]},"module":{"outputs":{"admin_password":{"sensitive":true,"expression":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"description":"Admin Password"},"admin_username":{"expression":{"references":["var.server_admin_name"]},"description":"Admin Username"},"location":{"expression":{"references":["var.location"]},"description":"Virtual Machine Location"},"name":{"expression":{"references":["var.name"]},"description":"Virtual Machine name"},"nic_id":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Nic IDs"},"private_ip":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Private IPv4 for the Virtual Machine"},"resource_group":{"expression":{"references":["var.resource_group.name","var.resource_group"]},"description":"Resource Group"},"ssh_private_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"SSH Private Key File"},"ssh_public_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"Public SSH Key"},"vm_id":{"expression":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"description":"Virtual Machine ID"}},"resources":[{"address":"azurerm_backup_protected_vm.vm_backup","mode":"managed","type":"azurerm_backup_protected_vm","name":"vm_backup","provider_config_key":"azurerm","expressions":{"backup_policy_id":{"references":["data.azurerm_backup_policy_vm.policy.id","data.azurerm_backup_policy_vm.policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]},"source_vm_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"azurerm_disk_encryption_set.vm_data","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_data","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_disk_encryption_set.vm_os","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_os","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_access_policy.vm","mode":"managed","type":"azurerm_key_vault_access_policy","name":"vm","provider_config_key":"azurerm","expressions":{"key_permissions":{"constant_value":["Get","WrapKey","UnwrapKey"]},"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"object_id":{"references":["azurerm_windows_virtual_machine.vm[0].identity[0].principal_id","azurerm_windows_virtual_machine.vm[0].identity[0]","azurerm_windows_virtual_machine.vm[0].identity","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_secret.vm_password","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_password","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["random_password.vm_admin.result","random_password.vm_admin"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_ssh_key","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_ssh_key","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_username","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_username","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["var.server_admin_name"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_ssh_key":[{"public_key":{"references":["tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"username":{"references":["var.server_admin_name"]}}],"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"disable_password_authentication":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]}},{"address":"azurerm_managed_disk.vm_data","mode":"managed","type":"azurerm_managed_disk","name":"vm_data","provider_config_key":"azurerm","expressions":{"create_option":{"constant_value":"Empty"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_data","each.key"]},"disk_size_gb":{"references":["var.data_disks","each.key"]},"location":{"references":["var.location"]},"name":{"references":["var.data_disks","each.key"]},"network_access_policy":{"constant_value":"DenyAll"},"public_network_access_enabled":{"constant_value":false},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"storage_account_type":{"references":["var.data_disks","each.key"]},"zone":{"references":["var.zone"]}},"schema_version":1,"for_each_expression":{"references":["var.data_disks"]},"depends_on":["azurerm_role_assignment.kv_vm_data_crypto_service_user","azurerm_role_assignment.kv_vm_data_crypto_user","azurerm_role_assignment.kv_vm_data_reader"]},{"address":"azurerm_monitor_data_collection_rule_association.vm_endpoint","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_endpoint","provider_config_key":"azurerm","expressions":{"data_collection_endpoint_id":{"references":["var.data_collection_endpoint.id","var.data_collection_endpoint"]},"description":{"references":["var.os_type","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_monitor_data_collection_rule_association.vm_rule","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_rule","provider_config_key":"azurerm","expressions":{"data_collection_rule_id":{"references":["var.data_collection_rule.id","var.data_collection_rule"]},"description":{"references":["var.os_type","var.data_collection_rule.name","var.data_collection_rule","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_rule.name","var.data_collection_rule","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"name":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"references":["each.value.ipconfig_name","each.value","each.value.ipconfig_name","each.value"]},"private_ip_address":{"references":["each.value.private_ip_address","each.value","each.value.private_ip_address","each.value"]},"private_ip_address_allocation":{"references":["each.value.private_ip_address_allocation","each.value"]},"subnet_id":{"references":["each.value.vnet_subnet_id","each.value","var.vnet_subnet.id","var.vnet_subnet","each.value.vnet_subnet_id","each.value"]}}],"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value","var.name","each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"tags":{"references":["var.tags"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_virtual_machine_data_disk_attachment.vm_data","mode":"managed","type":"azurerm_virtual_machine_data_disk_attachment","name":"vm_data","provider_config_key":"azurerm","expressions":{"caching":{"constant_value":"ReadWrite"},"lun":{"references":["var.data_disks","each.key"]},"managed_disk_id":{"references":["azurerm_managed_disk.vm_data","each.key"]},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"for_each_expression":{"references":["var.data_disks"]}},{"address":"azurerm_virtual_machine_extension.azure_monitor","mode":"managed","type":"azurerm_virtual_machine_extension","name":"azure_monitor","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Azure_Monitor_Windows_Agent"},"publisher":{"constant_value":"Microsoft.Azure.Monitor"},"tags":{"references":["var.tags"]},"type":{"constant_value":"AzureMonitorWindowsAgent"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.managed_identity"]},{"address":"azurerm_virtual_machine_extension.custom_script","mode":"managed","type":"azurerm_virtual_machine_extension","name":"custom_script","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Custom_Script"},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["local.custom_script_file_uris","local.custom_script_command"]},"type":{"constant_value":"CustomScriptExtension"},"type_handler_version":{"constant_value":"1.10"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.custom_script"]},"depends_on":["azurerm_virtual_machine_extension.guest_configuration"]},{"address":"azurerm_virtual_machine_extension.defender","mode":"managed","type":"azurerm_virtual_machine_extension","name":"defender","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"IaaS_Antimalware"},"publisher":{"constant_value":"Microsoft.Azure.Security"},"settings":{"constant_value":"  {\n    \"AntimalwareEnabled\": \"true\",\n    \"RealtimeProtectionEnabled\": \"true\",\n    \"ScheduledScanSettings\": {\n      \"isEnabled\": \"true\",\n      \"scanType\": \"Quick\",\n      \"day\": \"7\",\n      \"time\": \"120\"\n    }\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"IaaSAntimalware"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.network_watcher"]},{"address":"azurerm_virtual_machine_extension.domain_join_extension","mode":"managed","type":"azurerm_virtual_machine_extension","name":"domain_join_extension","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Domain_Join"},"protected_settings":{"references":["var.domain_password"]},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["var.domain_name","var.domain_name","var.domain_username"]},"tags":{"references":["var.tags"]},"type":{"constant_value":"JsonADDomainExtension"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.domain_name","var.domain_username","var.domain_password"]},"depends_on":["azurerm_virtual_machine_extension.custom_script"]},{"address":"azurerm_virtual_machine_extension.guest_configuration","mode":"managed","type":"azurerm_virtual_machine_extension","name":"guest_configuration","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Guest_Configuration"},"publisher":{"constant_value":"Microsoft.GuestConfiguration"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ConfigurationforWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_extension.defender"]},{"address":"azurerm_virtual_machine_extension.managed_identity","mode":"managed","type":"azurerm_virtual_machine_extension","name":"managed_identity","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Managed_Identity"},"publisher":{"constant_value":"Microsoft.ManagedIdentity"},"settings":{"constant_value":"  {\n    \"port\": \"50342\"\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ManagedIdentityExtensionForWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_data_disk_attachment.vm_data"]},{"address":"azurerm_virtual_machine_extension.network_watcher","mode":"managed","type":"azurerm_virtual_machine_extension","name":"network_watcher","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Network_Watcher_Agent"},"publisher":{"constant_value":"Microsoft.Azure.NetworkWatcher"},"tags":{"references":["var.tags"]},"type":{"constant_value":"NetworkWatcherAgentWindows"},"type_handler_version":{"constant_value":"1.4"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.azure_monitor"]},{"address":"azurerm_windows_virtual_machine.vm","mode":"managed","type":"azurerm_windows_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_password":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"computer_name":{"references":["var.computer_name"]},"enable_automatic_updates":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"license_type":{"references":["local.image_skus","var.image"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_os[0].id","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"patch_mode":{"constant_value":"AutomaticByOS"},"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_disk_encryption_set.vm_os","azurerm_role_assignment.kv_vm_os_reader","azurerm_role_assignment.kv_vm_os_crypto_user","azurerm_role_assignment.kv_vm_os_crypto_service_user"]},{"address":"null_resource.ansible_windows_updates","mode":"managed","type":"null_resource","name":"ansible_windows_updates","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.windows_update_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.windows_update_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.windows_update"]},"depends_on":["time_sleep.wait_vm_reboot","null_resource.local_admin_group","null_resource.disable_server_manager_login"]},{"address":"null_resource.disable_server_manager_login","mode":"managed","type":"null_resource","name":"disable_server_manager_login","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.disable_server_manager_startup_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.disable_server_manager_startup_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.ie_configuration","mode":"managed","type":"null_resource","name":"ie_configuration","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.ie_configuration","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.ie_configuration"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_admin_group","mode":"managed","type":"null_resource","name":"local_admin_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_admins_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_admins_group"]}}}],"expressions":{"triggers":{"references":["local.local_admins_script","var.local_admins_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_admins_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_power_users_group","mode":"managed","type":"null_resource","name":"local_power_users_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_power_users_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_power_users_group"]}}}],"expressions":{"triggers":{"references":["local.local_power_users_script","var.local_power_users_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_power_users_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"random_password.vm_admin","mode":"managed","type":"random_password","name":"vm_admin","provider_config_key":"random","expressions":{"length":{"references":["var.random_password_length"]},"override_special":{"constant_value":"_%@"},"special":{"constant_value":true}},"schema_version":0},{"address":"time_sleep.wait_vm_reboot","mode":"managed","type":"time_sleep","name":"wait_vm_reboot","provider_config_key":"time","expressions":{"create_duration":{"constant_value":"300s"}},"schema_version":0,"depends_on":["azurerm_virtual_machine_extension.domain_join_extension"]},{"address":"tls_private_key.vm_ssh_key","mode":"managed","type":"tls_private_key","name":"vm_ssh_key","provider_config_key":"module.vm_primary_iris_db:tls","expressions":{"algorithm":{"constant_value":"RSA"},"rsa_bits":{"constant_value":4096}},"schema_version":1,"count_expression":{"references":["var.os_type"]}},{"address":"data.azuread_user.domain_username","mode":"data","type":"azuread_user","name":"domain_username","provider_config_key":"azuread","expressions":{"user_principal_name":{"references":["var.domain_username"]}},"schema_version":0},{"address":"data.azurerm_backup_policy_vm.policy","mode":"data","type":"azurerm_backup_policy_vm","name":"policy","provider_config_key":"azurerm","expressions":{"name":{"references":["var.backup_policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]}},"schema_version":0},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0},{"address":"data.azurerm_network_interface.vm","mode":"data","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"name":{"references":["azurerm_network_interface.vm","each.key"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]},"depends_on":["azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm"]}],"variables":{"backup_policy":{"default":null,"description":"Backup Policy to apply to the VM"},"computer_name":{"description":"Name of the internal SO computer."},"custom_script":{"default":false,"description":"Enable deployment of a Custom Script"},"custom_script_url":{"default":"","description":"The Custom Script URL to be downloaded and run on the VM"},"customer_managed_keys":{"default":false,"description":"Set if cutomer managed keys are used."},"data_collection_endpoint":{"description":"Data collection endpoint to add to vm."},"data_collection_rule":{"description":"Data collection rule to add to vm."},"data_disks":{"default":{},"description":"List of objects for creating data disks."},"domain_name":{"default":null,"description":"The Domain Name to join the Virtual Machine to"},"domain_password":{"default":null,"description":"The Domain Password of an account to use to join machine to domain but also run scripts with","sensitive":true},"domain_username":{"default":null,"description":"The Domain Username of an account used to join machine to domain but also run scripts with"},"image":{"default":"windows-2022-datacenter","description":"Image offer for the Virtual Machine"},"key_vault":{"default":null,"description":"Key Vault to store Virtual Machine credentials inside"},"key_vault_key":{"default":null,"description":"Certificate key for disk encryption."},"local_admins_group":{"default":null,"description":"AD Group to add into the Local Administrators on the server"},"local_power_users_group":{"default":null,"description":"AD Group to add into the Local Porwer Users on the server"},"location":{"default":"uksouth","description":"The location/region where the resources are created"},"log_analytics":{"default":null,"description":"Log Analytics workspace to use for VM logging"},"log_storage":{"default":null,"description":"Storage Account to use for VM logging"},"name":{"description":"Name of the Virtual Machine"},"nics":{"default":{"first":{"ipconfig_name":"default","name":"default","private_ip_address":"default","private_ip_address_allocation":"Dynamic","vnet_subnet_id":"default"}},"description":"List of objects for creating nics."},"os_type":{"default":"windows"},"random_password_length":{"default":64,"description":"The desired length of random password created by this module"},"recovery_resource_group":{"default":null,"description":"The Resource Group object in which the recovery vault is in"},"recovery_vault":{"default":null,"description":"Recovery Vault to backup to"},"resource_group":{"description":"The Resource Group object in which the resources will be created"},"running_days":{"default":""},"second_custom_script":{"default":false,"description":"Enable deployment of a second custom Script"},"second_custom_script_url":{"default":"","description":"The Second Custom Script URL to be downloaded and run on the VM."},"server_admin_name":{"default":"sysadmin","description":"Name of the Virtual Machine Server Admin Account"},"shutdown_hour":{"default":""},"size":{"default":"Standard_B1s","description":"Specifies the size of the virtual machine"},"startup_hour":{"default":""},"storage_account_type":{"default":"Standard_LRS","description":"Defines the type of storage to use for the Virtual Machine Scale Set"},"tags":{"default":{}},"vnet_subnet":{"description":"Virtual Machine NIC Subnet to connect with"},"windows_update":{"default":true,"description":"Applies the latest Windows Updates after deployment"},"zone":{"default":null,"description":"List of zones where the vm is created."}}},"depends_on":["time_sleep.wait_ad_replication","azurerm_subnet.modern","azurerm_subnet_route_table_association.modern","azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_private_endpoint.recovery_vault_modern","azuread_group.irisdb_vm_admins","azuread_group.irisdb_vm_power_users"]},"vm_session_host_1":{"source":"../../tf_modules/vm","expressions":{"backup_policy":{"references":["azurerm_backup_policy_vm.modern_standard.name","azurerm_backup_policy_vm.modern_standard"]},"computer_name":{"references":["each.key","var.environment"]},"custom_script":{"constant_value":true},"custom_script_url":{"references":["data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"].url","data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"]","data.azurerm_storage_blob.file_blobs"]},"customer_managed_keys":{"references":["var.customer_managed_keys"]},"data_collection_endpoint":{"references":["azurerm_monitor_data_collection_endpoint.modern"]},"data_collection_rule":{"references":["azurerm_monitor_data_collection_rule.modern"]},"domain_name":{"references":["data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"domain_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"domain_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"image":{"constant_value":"windows-10-22h2-avd"},"key_vault":{"references":["azurerm_key_vault.modern"]},"key_vault_key":{"references":["var.customer_managed_keys","azurerm_key_vault_key.modern[0]","azurerm_key_vault_key.modern"]},"local_admins_group":{"references":["each.value.aad_group_name_admin","each.value"]},"local_power_users_group":{"references":["each.value.aad_group_name_power","each.value"]},"location":{"references":["azurerm_resource_group.modern","each.key"]},"log_analytics":{"references":["azurerm_log_analytics_workspace.modern"]},"log_storage":{"references":["azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"name":{"references":["each.value.session_host_name","each.value"]},"nics":{"references":["each.value.vm_nic_name","each.value"]},"os_type":{"constant_value":"windows"},"recovery_resource_group":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"recovery_vault":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group":{"references":["azurerm_resource_group.modern","each.key"]},"size":{"references":["var.avd_vm_sku"]},"storage_account_type":{"constant_value":"StandardSSD_LRS"},"tags":{"references":["module.tags.value","module.tags","each.value.vdpool_name","each.value"]},"vnet_subnet":{"references":["azurerm_subnet.modern","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"outputs":{"admin_password":{"sensitive":true,"expression":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"description":"Admin Password"},"admin_username":{"expression":{"references":["var.server_admin_name"]},"description":"Admin Username"},"location":{"expression":{"references":["var.location"]},"description":"Virtual Machine Location"},"name":{"expression":{"references":["var.name"]},"description":"Virtual Machine name"},"nic_id":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Nic IDs"},"private_ip":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Private IPv4 for the Virtual Machine"},"resource_group":{"expression":{"references":["var.resource_group.name","var.resource_group"]},"description":"Resource Group"},"ssh_private_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"SSH Private Key File"},"ssh_public_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"Public SSH Key"},"vm_id":{"expression":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"description":"Virtual Machine ID"}},"resources":[{"address":"azurerm_backup_protected_vm.vm_backup","mode":"managed","type":"azurerm_backup_protected_vm","name":"vm_backup","provider_config_key":"azurerm","expressions":{"backup_policy_id":{"references":["data.azurerm_backup_policy_vm.policy.id","data.azurerm_backup_policy_vm.policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]},"source_vm_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"azurerm_disk_encryption_set.vm_data","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_data","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_disk_encryption_set.vm_os","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_os","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_access_policy.vm","mode":"managed","type":"azurerm_key_vault_access_policy","name":"vm","provider_config_key":"azurerm","expressions":{"key_permissions":{"constant_value":["Get","WrapKey","UnwrapKey"]},"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"object_id":{"references":["azurerm_windows_virtual_machine.vm[0].identity[0].principal_id","azurerm_windows_virtual_machine.vm[0].identity[0]","azurerm_windows_virtual_machine.vm[0].identity","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_secret.vm_password","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_password","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["random_password.vm_admin.result","random_password.vm_admin"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_ssh_key","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_ssh_key","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_username","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_username","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["var.server_admin_name"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_ssh_key":[{"public_key":{"references":["tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"username":{"references":["var.server_admin_name"]}}],"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"disable_password_authentication":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]}},{"address":"azurerm_managed_disk.vm_data","mode":"managed","type":"azurerm_managed_disk","name":"vm_data","provider_config_key":"azurerm","expressions":{"create_option":{"constant_value":"Empty"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_data","each.key"]},"disk_size_gb":{"references":["var.data_disks","each.key"]},"location":{"references":["var.location"]},"name":{"references":["var.data_disks","each.key"]},"network_access_policy":{"constant_value":"DenyAll"},"public_network_access_enabled":{"constant_value":false},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"storage_account_type":{"references":["var.data_disks","each.key"]},"zone":{"references":["var.zone"]}},"schema_version":1,"for_each_expression":{"references":["var.data_disks"]},"depends_on":["azurerm_role_assignment.kv_vm_data_crypto_service_user","azurerm_role_assignment.kv_vm_data_crypto_user","azurerm_role_assignment.kv_vm_data_reader"]},{"address":"azurerm_monitor_data_collection_rule_association.vm_endpoint","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_endpoint","provider_config_key":"azurerm","expressions":{"data_collection_endpoint_id":{"references":["var.data_collection_endpoint.id","var.data_collection_endpoint"]},"description":{"references":["var.os_type","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_monitor_data_collection_rule_association.vm_rule","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_rule","provider_config_key":"azurerm","expressions":{"data_collection_rule_id":{"references":["var.data_collection_rule.id","var.data_collection_rule"]},"description":{"references":["var.os_type","var.data_collection_rule.name","var.data_collection_rule","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_rule.name","var.data_collection_rule","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"name":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"references":["each.value.ipconfig_name","each.value","each.value.ipconfig_name","each.value"]},"private_ip_address":{"references":["each.value.private_ip_address","each.value","each.value.private_ip_address","each.value"]},"private_ip_address_allocation":{"references":["each.value.private_ip_address_allocation","each.value"]},"subnet_id":{"references":["each.value.vnet_subnet_id","each.value","var.vnet_subnet.id","var.vnet_subnet","each.value.vnet_subnet_id","each.value"]}}],"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value","var.name","each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"tags":{"references":["var.tags"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_virtual_machine_data_disk_attachment.vm_data","mode":"managed","type":"azurerm_virtual_machine_data_disk_attachment","name":"vm_data","provider_config_key":"azurerm","expressions":{"caching":{"constant_value":"ReadWrite"},"lun":{"references":["var.data_disks","each.key"]},"managed_disk_id":{"references":["azurerm_managed_disk.vm_data","each.key"]},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"for_each_expression":{"references":["var.data_disks"]}},{"address":"azurerm_virtual_machine_extension.azure_monitor","mode":"managed","type":"azurerm_virtual_machine_extension","name":"azure_monitor","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Azure_Monitor_Windows_Agent"},"publisher":{"constant_value":"Microsoft.Azure.Monitor"},"tags":{"references":["var.tags"]},"type":{"constant_value":"AzureMonitorWindowsAgent"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.managed_identity"]},{"address":"azurerm_virtual_machine_extension.custom_script","mode":"managed","type":"azurerm_virtual_machine_extension","name":"custom_script","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Custom_Script"},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["local.custom_script_file_uris","local.custom_script_command"]},"type":{"constant_value":"CustomScriptExtension"},"type_handler_version":{"constant_value":"1.10"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.custom_script"]},"depends_on":["azurerm_virtual_machine_extension.guest_configuration"]},{"address":"azurerm_virtual_machine_extension.defender","mode":"managed","type":"azurerm_virtual_machine_extension","name":"defender","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"IaaS_Antimalware"},"publisher":{"constant_value":"Microsoft.Azure.Security"},"settings":{"constant_value":"  {\n    \"AntimalwareEnabled\": \"true\",\n    \"RealtimeProtectionEnabled\": \"true\",\n    \"ScheduledScanSettings\": {\n      \"isEnabled\": \"true\",\n      \"scanType\": \"Quick\",\n      \"day\": \"7\",\n      \"time\": \"120\"\n    }\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"IaaSAntimalware"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.network_watcher"]},{"address":"azurerm_virtual_machine_extension.domain_join_extension","mode":"managed","type":"azurerm_virtual_machine_extension","name":"domain_join_extension","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Domain_Join"},"protected_settings":{"references":["var.domain_password"]},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["var.domain_name","var.domain_name","var.domain_username"]},"tags":{"references":["var.tags"]},"type":{"constant_value":"JsonADDomainExtension"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.domain_name","var.domain_username","var.domain_password"]},"depends_on":["azurerm_virtual_machine_extension.custom_script"]},{"address":"azurerm_virtual_machine_extension.guest_configuration","mode":"managed","type":"azurerm_virtual_machine_extension","name":"guest_configuration","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Guest_Configuration"},"publisher":{"constant_value":"Microsoft.GuestConfiguration"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ConfigurationforWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_extension.defender"]},{"address":"azurerm_virtual_machine_extension.managed_identity","mode":"managed","type":"azurerm_virtual_machine_extension","name":"managed_identity","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Managed_Identity"},"publisher":{"constant_value":"Microsoft.ManagedIdentity"},"settings":{"constant_value":"  {\n    \"port\": \"50342\"\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ManagedIdentityExtensionForWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_data_disk_attachment.vm_data"]},{"address":"azurerm_virtual_machine_extension.network_watcher","mode":"managed","type":"azurerm_virtual_machine_extension","name":"network_watcher","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Network_Watcher_Agent"},"publisher":{"constant_value":"Microsoft.Azure.NetworkWatcher"},"tags":{"references":["var.tags"]},"type":{"constant_value":"NetworkWatcherAgentWindows"},"type_handler_version":{"constant_value":"1.4"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.azure_monitor"]},{"address":"azurerm_windows_virtual_machine.vm","mode":"managed","type":"azurerm_windows_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_password":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"computer_name":{"references":["var.computer_name"]},"enable_automatic_updates":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"license_type":{"references":["local.image_skus","var.image"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_os[0].id","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"patch_mode":{"constant_value":"AutomaticByOS"},"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_disk_encryption_set.vm_os","azurerm_role_assignment.kv_vm_os_reader","azurerm_role_assignment.kv_vm_os_crypto_user","azurerm_role_assignment.kv_vm_os_crypto_service_user"]},{"address":"null_resource.ansible_windows_updates","mode":"managed","type":"null_resource","name":"ansible_windows_updates","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.windows_update_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.windows_update_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.windows_update"]},"depends_on":["time_sleep.wait_vm_reboot","null_resource.local_admin_group","null_resource.disable_server_manager_login"]},{"address":"null_resource.disable_server_manager_login","mode":"managed","type":"null_resource","name":"disable_server_manager_login","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.disable_server_manager_startup_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.disable_server_manager_startup_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.ie_configuration","mode":"managed","type":"null_resource","name":"ie_configuration","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.ie_configuration","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.ie_configuration"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_admin_group","mode":"managed","type":"null_resource","name":"local_admin_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_admins_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_admins_group"]}}}],"expressions":{"triggers":{"references":["local.local_admins_script","var.local_admins_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_admins_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_power_users_group","mode":"managed","type":"null_resource","name":"local_power_users_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_power_users_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_power_users_group"]}}}],"expressions":{"triggers":{"references":["local.local_power_users_script","var.local_power_users_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_power_users_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"random_password.vm_admin","mode":"managed","type":"random_password","name":"vm_admin","provider_config_key":"random","expressions":{"length":{"references":["var.random_password_length"]},"override_special":{"constant_value":"_%@"},"special":{"constant_value":true}},"schema_version":0},{"address":"time_sleep.wait_vm_reboot","mode":"managed","type":"time_sleep","name":"wait_vm_reboot","provider_config_key":"time","expressions":{"create_duration":{"constant_value":"300s"}},"schema_version":0,"depends_on":["azurerm_virtual_machine_extension.domain_join_extension"]},{"address":"tls_private_key.vm_ssh_key","mode":"managed","type":"tls_private_key","name":"vm_ssh_key","provider_config_key":"module.vm_session_host_1:tls","expressions":{"algorithm":{"constant_value":"RSA"},"rsa_bits":{"constant_value":4096}},"schema_version":1,"count_expression":{"references":["var.os_type"]}},{"address":"data.azuread_user.domain_username","mode":"data","type":"azuread_user","name":"domain_username","provider_config_key":"azuread","expressions":{"user_principal_name":{"references":["var.domain_username"]}},"schema_version":0},{"address":"data.azurerm_backup_policy_vm.policy","mode":"data","type":"azurerm_backup_policy_vm","name":"policy","provider_config_key":"azurerm","expressions":{"name":{"references":["var.backup_policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]}},"schema_version":0},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0},{"address":"data.azurerm_network_interface.vm","mode":"data","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"name":{"references":["azurerm_network_interface.vm","each.key"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]},"depends_on":["azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm"]}],"variables":{"backup_policy":{"default":null,"description":"Backup Policy to apply to the VM"},"computer_name":{"description":"Name of the internal SO computer."},"custom_script":{"default":false,"description":"Enable deployment of a Custom Script"},"custom_script_url":{"default":"","description":"The Custom Script URL to be downloaded and run on the VM"},"customer_managed_keys":{"default":false,"description":"Set if cutomer managed keys are used."},"data_collection_endpoint":{"description":"Data collection endpoint to add to vm."},"data_collection_rule":{"description":"Data collection rule to add to vm."},"data_disks":{"default":{},"description":"List of objects for creating data disks."},"domain_name":{"default":null,"description":"The Domain Name to join the Virtual Machine to"},"domain_password":{"default":null,"description":"The Domain Password of an account to use to join machine to domain but also run scripts with","sensitive":true},"domain_username":{"default":null,"description":"The Domain Username of an account used to join machine to domain but also run scripts with"},"image":{"default":"windows-2022-datacenter","description":"Image offer for the Virtual Machine"},"key_vault":{"default":null,"description":"Key Vault to store Virtual Machine credentials inside"},"key_vault_key":{"default":null,"description":"Certificate key for disk encryption."},"local_admins_group":{"default":null,"description":"AD Group to add into the Local Administrators on the server"},"local_power_users_group":{"default":null,"description":"AD Group to add into the Local Porwer Users on the server"},"location":{"default":"uksouth","description":"The location/region where the resources are created"},"log_analytics":{"default":null,"description":"Log Analytics workspace to use for VM logging"},"log_storage":{"default":null,"description":"Storage Account to use for VM logging"},"name":{"description":"Name of the Virtual Machine"},"nics":{"default":{"first":{"ipconfig_name":"default","name":"default","private_ip_address":"default","private_ip_address_allocation":"Dynamic","vnet_subnet_id":"default"}},"description":"List of objects for creating nics."},"os_type":{"default":"windows"},"random_password_length":{"default":64,"description":"The desired length of random password created by this module"},"recovery_resource_group":{"default":null,"description":"The Resource Group object in which the recovery vault is in"},"recovery_vault":{"default":null,"description":"Recovery Vault to backup to"},"resource_group":{"description":"The Resource Group object in which the resources will be created"},"running_days":{"default":""},"second_custom_script":{"default":false,"description":"Enable deployment of a second custom Script"},"second_custom_script_url":{"default":"","description":"The Second Custom Script URL to be downloaded and run on the VM."},"server_admin_name":{"default":"sysadmin","description":"Name of the Virtual Machine Server Admin Account"},"shutdown_hour":{"default":""},"size":{"default":"Standard_B1s","description":"Specifies the size of the virtual machine"},"startup_hour":{"default":""},"storage_account_type":{"default":"Standard_LRS","description":"Defines the type of storage to use for the Virtual Machine Scale Set"},"tags":{"default":{}},"vnet_subnet":{"description":"Virtual Machine NIC Subnet to connect with"},"windows_update":{"default":true,"description":"Applies the latest Windows Updates after deployment"},"zone":{"default":null,"description":"List of zones where the vm is created."}}},"depends_on":["time_sleep.wait_ad_replication","azurerm_subnet.modern","azurerm_subnet_route_table_association.modern","azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_virtual_desktop_host_pool.modern","azurerm_virtual_desktop_workspace.modern","azurerm_private_endpoint.recovery_vault_modern"]},"vm_session_host_2":{"source":"../../tf_modules/vm","expressions":{"backup_policy":{"references":["azurerm_backup_policy_vm.modern_standard.name","azurerm_backup_policy_vm.modern_standard"]},"computer_name":{"references":["each.key","var.environment"]},"custom_script":{"constant_value":true},"custom_script_url":{"references":["data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"].url","data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"]","data.azurerm_storage_blob.file_blobs"]},"customer_managed_keys":{"references":["var.customer_managed_keys"]},"data_collection_endpoint":{"references":["azurerm_monitor_data_collection_endpoint.modern"]},"data_collection_rule":{"references":["azurerm_monitor_data_collection_rule.modern"]},"domain_name":{"references":["data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"domain_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"domain_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"image":{"constant_value":"windows-10-22h2-avd"},"key_vault":{"references":["azurerm_key_vault.modern"]},"key_vault_key":{"references":["var.customer_managed_keys","azurerm_key_vault_key.modern[0]","azurerm_key_vault_key.modern"]},"local_admins_group":{"references":["each.value.aad_group_name_admin","each.value"]},"local_power_users_group":{"references":["each.value.aad_group_name_power","each.value"]},"location":{"references":["azurerm_resource_group.modern","each.key"]},"log_analytics":{"references":["azurerm_log_analytics_workspace.modern"]},"log_storage":{"references":["azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"name":{"references":["each.value.session_host_name","each.value"]},"nics":{"references":["each.value.vm_nic_name","each.value"]},"os_type":{"constant_value":"windows"},"recovery_resource_group":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"recovery_vault":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group":{"references":["azurerm_resource_group.modern","each.key"]},"size":{"references":["var.avd_vm_sku"]},"storage_account_type":{"constant_value":"StandardSSD_LRS"},"tags":{"references":["module.tags.value","module.tags","each.value.vdpool_name","each.value"]},"vnet_subnet":{"references":["azurerm_subnet.modern","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"outputs":{"admin_password":{"sensitive":true,"expression":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"description":"Admin Password"},"admin_username":{"expression":{"references":["var.server_admin_name"]},"description":"Admin Username"},"location":{"expression":{"references":["var.location"]},"description":"Virtual Machine Location"},"name":{"expression":{"references":["var.name"]},"description":"Virtual Machine name"},"nic_id":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Nic IDs"},"private_ip":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Private IPv4 for the Virtual Machine"},"resource_group":{"expression":{"references":["var.resource_group.name","var.resource_group"]},"description":"Resource Group"},"ssh_private_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"SSH Private Key File"},"ssh_public_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"Public SSH Key"},"vm_id":{"expression":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"description":"Virtual Machine ID"}},"resources":[{"address":"azurerm_backup_protected_vm.vm_backup","mode":"managed","type":"azurerm_backup_protected_vm","name":"vm_backup","provider_config_key":"azurerm","expressions":{"backup_policy_id":{"references":["data.azurerm_backup_policy_vm.policy.id","data.azurerm_backup_policy_vm.policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]},"source_vm_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"azurerm_disk_encryption_set.vm_data","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_data","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_disk_encryption_set.vm_os","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_os","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_access_policy.vm","mode":"managed","type":"azurerm_key_vault_access_policy","name":"vm","provider_config_key":"azurerm","expressions":{"key_permissions":{"constant_value":["Get","WrapKey","UnwrapKey"]},"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"object_id":{"references":["azurerm_windows_virtual_machine.vm[0].identity[0].principal_id","azurerm_windows_virtual_machine.vm[0].identity[0]","azurerm_windows_virtual_machine.vm[0].identity","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_secret.vm_password","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_password","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["random_password.vm_admin.result","random_password.vm_admin"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_ssh_key","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_ssh_key","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_username","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_username","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["var.server_admin_name"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_ssh_key":[{"public_key":{"references":["tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"username":{"references":["var.server_admin_name"]}}],"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"disable_password_authentication":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]}},{"address":"azurerm_managed_disk.vm_data","mode":"managed","type":"azurerm_managed_disk","name":"vm_data","provider_config_key":"azurerm","expressions":{"create_option":{"constant_value":"Empty"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_data","each.key"]},"disk_size_gb":{"references":["var.data_disks","each.key"]},"location":{"references":["var.location"]},"name":{"references":["var.data_disks","each.key"]},"network_access_policy":{"constant_value":"DenyAll"},"public_network_access_enabled":{"constant_value":false},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"storage_account_type":{"references":["var.data_disks","each.key"]},"zone":{"references":["var.zone"]}},"schema_version":1,"for_each_expression":{"references":["var.data_disks"]},"depends_on":["azurerm_role_assignment.kv_vm_data_crypto_service_user","azurerm_role_assignment.kv_vm_data_crypto_user","azurerm_role_assignment.kv_vm_data_reader"]},{"address":"azurerm_monitor_data_collection_rule_association.vm_endpoint","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_endpoint","provider_config_key":"azurerm","expressions":{"data_collection_endpoint_id":{"references":["var.data_collection_endpoint.id","var.data_collection_endpoint"]},"description":{"references":["var.os_type","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_monitor_data_collection_rule_association.vm_rule","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_rule","provider_config_key":"azurerm","expressions":{"data_collection_rule_id":{"references":["var.data_collection_rule.id","var.data_collection_rule"]},"description":{"references":["var.os_type","var.data_collection_rule.name","var.data_collection_rule","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_rule.name","var.data_collection_rule","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"name":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"references":["each.value.ipconfig_name","each.value","each.value.ipconfig_name","each.value"]},"private_ip_address":{"references":["each.value.private_ip_address","each.value","each.value.private_ip_address","each.value"]},"private_ip_address_allocation":{"references":["each.value.private_ip_address_allocation","each.value"]},"subnet_id":{"references":["each.value.vnet_subnet_id","each.value","var.vnet_subnet.id","var.vnet_subnet","each.value.vnet_subnet_id","each.value"]}}],"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value","var.name","each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"tags":{"references":["var.tags"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_virtual_machine_data_disk_attachment.vm_data","mode":"managed","type":"azurerm_virtual_machine_data_disk_attachment","name":"vm_data","provider_config_key":"azurerm","expressions":{"caching":{"constant_value":"ReadWrite"},"lun":{"references":["var.data_disks","each.key"]},"managed_disk_id":{"references":["azurerm_managed_disk.vm_data","each.key"]},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"for_each_expression":{"references":["var.data_disks"]}},{"address":"azurerm_virtual_machine_extension.azure_monitor","mode":"managed","type":"azurerm_virtual_machine_extension","name":"azure_monitor","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Azure_Monitor_Windows_Agent"},"publisher":{"constant_value":"Microsoft.Azure.Monitor"},"tags":{"references":["var.tags"]},"type":{"constant_value":"AzureMonitorWindowsAgent"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.managed_identity"]},{"address":"azurerm_virtual_machine_extension.custom_script","mode":"managed","type":"azurerm_virtual_machine_extension","name":"custom_script","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Custom_Script"},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["local.custom_script_file_uris","local.custom_script_command"]},"type":{"constant_value":"CustomScriptExtension"},"type_handler_version":{"constant_value":"1.10"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.custom_script"]},"depends_on":["azurerm_virtual_machine_extension.guest_configuration"]},{"address":"azurerm_virtual_machine_extension.defender","mode":"managed","type":"azurerm_virtual_machine_extension","name":"defender","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"IaaS_Antimalware"},"publisher":{"constant_value":"Microsoft.Azure.Security"},"settings":{"constant_value":"  {\n    \"AntimalwareEnabled\": \"true\",\n    \"RealtimeProtectionEnabled\": \"true\",\n    \"ScheduledScanSettings\": {\n      \"isEnabled\": \"true\",\n      \"scanType\": \"Quick\",\n      \"day\": \"7\",\n      \"time\": \"120\"\n    }\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"IaaSAntimalware"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.network_watcher"]},{"address":"azurerm_virtual_machine_extension.domain_join_extension","mode":"managed","type":"azurerm_virtual_machine_extension","name":"domain_join_extension","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Domain_Join"},"protected_settings":{"references":["var.domain_password"]},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["var.domain_name","var.domain_name","var.domain_username"]},"tags":{"references":["var.tags"]},"type":{"constant_value":"JsonADDomainExtension"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.domain_name","var.domain_username","var.domain_password"]},"depends_on":["azurerm_virtual_machine_extension.custom_script"]},{"address":"azurerm_virtual_machine_extension.guest_configuration","mode":"managed","type":"azurerm_virtual_machine_extension","name":"guest_configuration","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Guest_Configuration"},"publisher":{"constant_value":"Microsoft.GuestConfiguration"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ConfigurationforWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_extension.defender"]},{"address":"azurerm_virtual_machine_extension.managed_identity","mode":"managed","type":"azurerm_virtual_machine_extension","name":"managed_identity","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Managed_Identity"},"publisher":{"constant_value":"Microsoft.ManagedIdentity"},"settings":{"constant_value":"  {\n    \"port\": \"50342\"\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ManagedIdentityExtensionForWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_data_disk_attachment.vm_data"]},{"address":"azurerm_virtual_machine_extension.network_watcher","mode":"managed","type":"azurerm_virtual_machine_extension","name":"network_watcher","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Network_Watcher_Agent"},"publisher":{"constant_value":"Microsoft.Azure.NetworkWatcher"},"tags":{"references":["var.tags"]},"type":{"constant_value":"NetworkWatcherAgentWindows"},"type_handler_version":{"constant_value":"1.4"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.azure_monitor"]},{"address":"azurerm_windows_virtual_machine.vm","mode":"managed","type":"azurerm_windows_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_password":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"computer_name":{"references":["var.computer_name"]},"enable_automatic_updates":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"license_type":{"references":["local.image_skus","var.image"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_os[0].id","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"patch_mode":{"constant_value":"AutomaticByOS"},"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_disk_encryption_set.vm_os","azurerm_role_assignment.kv_vm_os_reader","azurerm_role_assignment.kv_vm_os_crypto_user","azurerm_role_assignment.kv_vm_os_crypto_service_user"]},{"address":"null_resource.ansible_windows_updates","mode":"managed","type":"null_resource","name":"ansible_windows_updates","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.windows_update_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.windows_update_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.windows_update"]},"depends_on":["time_sleep.wait_vm_reboot","null_resource.local_admin_group","null_resource.disable_server_manager_login"]},{"address":"null_resource.disable_server_manager_login","mode":"managed","type":"null_resource","name":"disable_server_manager_login","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.disable_server_manager_startup_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.disable_server_manager_startup_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.ie_configuration","mode":"managed","type":"null_resource","name":"ie_configuration","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.ie_configuration","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.ie_configuration"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_admin_group","mode":"managed","type":"null_resource","name":"local_admin_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_admins_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_admins_group"]}}}],"expressions":{"triggers":{"references":["local.local_admins_script","var.local_admins_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_admins_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_power_users_group","mode":"managed","type":"null_resource","name":"local_power_users_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_power_users_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_power_users_group"]}}}],"expressions":{"triggers":{"references":["local.local_power_users_script","var.local_power_users_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_power_users_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"random_password.vm_admin","mode":"managed","type":"random_password","name":"vm_admin","provider_config_key":"random","expressions":{"length":{"references":["var.random_password_length"]},"override_special":{"constant_value":"_%@"},"special":{"constant_value":true}},"schema_version":0},{"address":"time_sleep.wait_vm_reboot","mode":"managed","type":"time_sleep","name":"wait_vm_reboot","provider_config_key":"time","expressions":{"create_duration":{"constant_value":"300s"}},"schema_version":0,"depends_on":["azurerm_virtual_machine_extension.domain_join_extension"]},{"address":"tls_private_key.vm_ssh_key","mode":"managed","type":"tls_private_key","name":"vm_ssh_key","provider_config_key":"module.vm_session_host_2:tls","expressions":{"algorithm":{"constant_value":"RSA"},"rsa_bits":{"constant_value":4096}},"schema_version":1,"count_expression":{"references":["var.os_type"]}},{"address":"data.azuread_user.domain_username","mode":"data","type":"azuread_user","name":"domain_username","provider_config_key":"azuread","expressions":{"user_principal_name":{"references":["var.domain_username"]}},"schema_version":0},{"address":"data.azurerm_backup_policy_vm.policy","mode":"data","type":"azurerm_backup_policy_vm","name":"policy","provider_config_key":"azurerm","expressions":{"name":{"references":["var.backup_policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]}},"schema_version":0},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0},{"address":"data.azurerm_network_interface.vm","mode":"data","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"name":{"references":["azurerm_network_interface.vm","each.key"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]},"depends_on":["azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm"]}],"variables":{"backup_policy":{"default":null,"description":"Backup Policy to apply to the VM"},"computer_name":{"description":"Name of the internal SO computer."},"custom_script":{"default":false,"description":"Enable deployment of a Custom Script"},"custom_script_url":{"default":"","description":"The Custom Script URL to be downloaded and run on the VM"},"customer_managed_keys":{"default":false,"description":"Set if cutomer managed keys are used."},"data_collection_endpoint":{"description":"Data collection endpoint to add to vm."},"data_collection_rule":{"description":"Data collection rule to add to vm."},"data_disks":{"default":{},"description":"List of objects for creating data disks."},"domain_name":{"default":null,"description":"The Domain Name to join the Virtual Machine to"},"domain_password":{"default":null,"description":"The Domain Password of an account to use to join machine to domain but also run scripts with","sensitive":true},"domain_username":{"default":null,"description":"The Domain Username of an account used to join machine to domain but also run scripts with"},"image":{"default":"windows-2022-datacenter","description":"Image offer for the Virtual Machine"},"key_vault":{"default":null,"description":"Key Vault to store Virtual Machine credentials inside"},"key_vault_key":{"default":null,"description":"Certificate key for disk encryption."},"local_admins_group":{"default":null,"description":"AD Group to add into the Local Administrators on the server"},"local_power_users_group":{"default":null,"description":"AD Group to add into the Local Porwer Users on the server"},"location":{"default":"uksouth","description":"The location/region where the resources are created"},"log_analytics":{"default":null,"description":"Log Analytics workspace to use for VM logging"},"log_storage":{"default":null,"description":"Storage Account to use for VM logging"},"name":{"description":"Name of the Virtual Machine"},"nics":{"default":{"first":{"ipconfig_name":"default","name":"default","private_ip_address":"default","private_ip_address_allocation":"Dynamic","vnet_subnet_id":"default"}},"description":"List of objects for creating nics."},"os_type":{"default":"windows"},"random_password_length":{"default":64,"description":"The desired length of random password created by this module"},"recovery_resource_group":{"default":null,"description":"The Resource Group object in which the recovery vault is in"},"recovery_vault":{"default":null,"description":"Recovery Vault to backup to"},"resource_group":{"description":"The Resource Group object in which the resources will be created"},"running_days":{"default":""},"second_custom_script":{"default":false,"description":"Enable deployment of a second custom Script"},"second_custom_script_url":{"default":"","description":"The Second Custom Script URL to be downloaded and run on the VM."},"server_admin_name":{"default":"sysadmin","description":"Name of the Virtual Machine Server Admin Account"},"shutdown_hour":{"default":""},"size":{"default":"Standard_B1s","description":"Specifies the size of the virtual machine"},"startup_hour":{"default":""},"storage_account_type":{"default":"Standard_LRS","description":"Defines the type of storage to use for the Virtual Machine Scale Set"},"tags":{"default":{}},"vnet_subnet":{"description":"Virtual Machine NIC Subnet to connect with"},"windows_update":{"default":true,"description":"Applies the latest Windows Updates after deployment"},"zone":{"default":null,"description":"List of zones where the vm is created."}}},"depends_on":["time_sleep.wait_ad_replication","azurerm_subnet.modern","azurerm_subnet_route_table_association.modern","azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_virtual_desktop_host_pool.modern","azurerm_virtual_desktop_workspace.modern","azurerm_private_endpoint.recovery_vault_modern"]},"vm_session_host_3":{"source":"../../tf_modules/vm","expressions":{"backup_policy":{"references":["azurerm_backup_policy_vm.modern_standard.name","azurerm_backup_policy_vm.modern_standard"]},"computer_name":{"references":["each.key","var.environment"]},"custom_script":{"constant_value":true},"custom_script_url":{"references":["data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"].url","data.azurerm_storage_blob.file_blobs[\"windows_configure_script\"]","data.azurerm_storage_blob.file_blobs"]},"customer_managed_keys":{"references":["var.customer_managed_keys"]},"data_collection_endpoint":{"references":["azurerm_monitor_data_collection_endpoint.modern"]},"data_collection_rule":{"references":["azurerm_monitor_data_collection_rule.modern"]},"domain_name":{"references":["data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"domain_password":{"references":["data.azurerm_key_vault_secret.aadds_admin_password.value","data.azurerm_key_vault_secret.aadds_admin_password"]},"domain_username":{"references":["data.azurerm_key_vault_secret.aadds_admin_username.value","data.azurerm_key_vault_secret.aadds_admin_username"]},"image":{"constant_value":"windows-10-22h2-avd"},"key_vault":{"references":["azurerm_key_vault.modern"]},"key_vault_key":{"references":["var.customer_managed_keys","azurerm_key_vault_key.modern[0]","azurerm_key_vault_key.modern"]},"local_admins_group":{"references":["azuread_group.vm_admins","each.key","data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"local_power_users_group":{"references":["azuread_group.vm_power_users","each.key","data.azuread_domains.azuread_domain.domains[0].domain_name","data.azuread_domains.azuread_domain.domains[0]","data.azuread_domains.azuread_domain.domains","data.azuread_domains.azuread_domain"]},"location":{"references":["azurerm_resource_group.modern","each.key"]},"log_analytics":{"references":["azurerm_log_analytics_workspace.modern"]},"log_storage":{"references":["azurerm_storage_account.modern[\"blob\"]","azurerm_storage_account.modern"]},"name":{"references":["each.value.session_host_name","each.value"]},"nics":{"references":["each.value.vm_nic_name","each.value"]},"os_type":{"constant_value":"windows"},"recovery_resource_group":{"references":["azurerm_resource_group.modern[\"backup\"].name","azurerm_resource_group.modern[\"backup\"]","azurerm_resource_group.modern"]},"recovery_vault":{"references":["azurerm_recovery_services_vault.modern.name","azurerm_recovery_services_vault.modern"]},"resource_group":{"references":["azurerm_resource_group.modern","each.key"]},"size":{"references":["var.avd_vm_sku"]},"storage_account_type":{"constant_value":"StandardSSD_LRS"},"tags":{"references":["module.tags.value","module.tags","each.value.vdpool_name","each.value"]},"vnet_subnet":{"references":["azurerm_subnet.modern","each.key"]}},"for_each_expression":{"references":["local.modern_avd"]},"module":{"outputs":{"admin_password":{"sensitive":true,"expression":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"description":"Admin Password"},"admin_username":{"expression":{"references":["var.server_admin_name"]},"description":"Admin Username"},"location":{"expression":{"references":["var.location"]},"description":"Virtual Machine Location"},"name":{"expression":{"references":["var.name"]},"description":"Virtual Machine name"},"nic_id":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Nic IDs"},"private_ip":{"expression":{"references":["data.azurerm_network_interface.vm"]},"description":"Private IPv4 for the Virtual Machine"},"resource_group":{"expression":{"references":["var.resource_group.name","var.resource_group"]},"description":"Resource Group"},"ssh_private_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"SSH Private Key File"},"ssh_public_key":{"expression":{"references":["var.os_type","tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"description":"Public SSH Key"},"vm_id":{"expression":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"description":"Virtual Machine ID"}},"resources":[{"address":"azurerm_backup_protected_vm.vm_backup","mode":"managed","type":"azurerm_backup_protected_vm","name":"vm_backup","provider_config_key":"azurerm","expressions":{"backup_policy_id":{"references":["data.azurerm_backup_policy_vm.policy.id","data.azurerm_backup_policy_vm.policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]},"source_vm_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"azurerm_disk_encryption_set.vm_data","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_data","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_disk_encryption_set.vm_os","mode":"managed","type":"azurerm_disk_encryption_set","name":"vm_os","provider_config_key":"azurerm","expressions":{"auto_key_rotation_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"key_vault_key_id":{"references":["var.key_vault_key.id","var.key_vault_key"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_access_policy.vm","mode":"managed","type":"azurerm_key_vault_access_policy","name":"vm","provider_config_key":"azurerm","expressions":{"key_permissions":{"constant_value":["Get","WrapKey","UnwrapKey"]},"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"object_id":{"references":["azurerm_windows_virtual_machine.vm[0].identity[0].principal_id","azurerm_windows_virtual_machine.vm[0].identity[0]","azurerm_windows_virtual_machine.vm[0].identity","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_key_vault_secret.vm_password","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_password","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["random_password.vm_admin.result","random_password.vm_admin"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_ssh_key","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_ssh_key","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["tls_private_key.vm_ssh_key[0].private_key_pem","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.key_vault"]}},{"address":"azurerm_key_vault_secret.vm_username","mode":"managed","type":"azurerm_key_vault_secret","name":"vm_username","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["var.key_vault.id","var.key_vault"]},"name":{"references":["var.name"]},"tags":{"references":["var.tags"]},"value":{"references":["var.server_admin_name"]}},"schema_version":0,"count_expression":{"references":["var.key_vault"]}},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_ssh_key":[{"public_key":{"references":["tls_private_key.vm_ssh_key[0].public_key_openssh","tls_private_key.vm_ssh_key[0]","tls_private_key.vm_ssh_key"]},"username":{"references":["var.server_admin_name"]}}],"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"disable_password_authentication":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]}},{"address":"azurerm_managed_disk.vm_data","mode":"managed","type":"azurerm_managed_disk","name":"vm_data","provider_config_key":"azurerm","expressions":{"create_option":{"constant_value":"Empty"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_data","each.key"]},"disk_size_gb":{"references":["var.data_disks","each.key"]},"location":{"references":["var.location"]},"name":{"references":["var.data_disks","each.key"]},"network_access_policy":{"constant_value":"DenyAll"},"public_network_access_enabled":{"constant_value":false},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"storage_account_type":{"references":["var.data_disks","each.key"]},"zone":{"references":["var.zone"]}},"schema_version":1,"for_each_expression":{"references":["var.data_disks"]},"depends_on":["azurerm_role_assignment.kv_vm_data_crypto_service_user","azurerm_role_assignment.kv_vm_data_crypto_user","azurerm_role_assignment.kv_vm_data_reader"]},{"address":"azurerm_monitor_data_collection_rule_association.vm_endpoint","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_endpoint","provider_config_key":"azurerm","expressions":{"data_collection_endpoint_id":{"references":["var.data_collection_endpoint.id","var.data_collection_endpoint"]},"description":{"references":["var.os_type","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_endpoint.name","var.data_collection_endpoint","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_monitor_data_collection_rule_association.vm_rule","mode":"managed","type":"azurerm_monitor_data_collection_rule_association","name":"vm_rule","provider_config_key":"azurerm","expressions":{"data_collection_rule_id":{"references":["var.data_collection_rule.id","var.data_collection_rule"]},"description":{"references":["var.os_type","var.data_collection_rule.name","var.data_collection_rule","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","var.data_collection_rule.name","var.data_collection_rule","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"name":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].name","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].name","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]},"target_resource_id":{"references":["var.os_type","azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm[0].id","azurerm_linux_virtual_machine.vm[0]","azurerm_linux_virtual_machine.vm"]}},"schema_version":0},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"references":["each.value.ipconfig_name","each.value","each.value.ipconfig_name","each.value"]},"private_ip_address":{"references":["each.value.private_ip_address","each.value","each.value.private_ip_address","each.value"]},"private_ip_address_allocation":{"references":["each.value.private_ip_address_allocation","each.value"]},"subnet_id":{"references":["each.value.vnet_subnet_id","each.value","var.vnet_subnet.id","var.vnet_subnet","each.value.vnet_subnet_id","each.value"]}}],"location":{"references":["var.location"]},"name":{"references":["each.value.name","each.value","var.name","each.value.name","each.value"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"tags":{"references":["var.tags"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_data_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_data_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_data","each.key"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"for_each_expression":{"references":["var.customer_managed_keys","var.data_disks"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_service_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_service_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto Service Encryption User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_crypto_user","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_crypto_user","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Crypto User"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_role_assignment.kv_vm_os_reader","mode":"managed","type":"azurerm_role_assignment","name":"kv_vm_os_reader","provider_config_key":"azurerm","expressions":{"principal_id":{"references":["azurerm_disk_encryption_set.vm_os[0].identity[0].principal_id","azurerm_disk_encryption_set.vm_os[0].identity[0]","azurerm_disk_encryption_set.vm_os[0].identity","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"role_definition_name":{"constant_value":"Key Vault Reader"},"scope":{"references":["var.key_vault.id","var.key_vault"]}},"schema_version":0,"count_expression":{"references":["var.customer_managed_keys"]}},{"address":"azurerm_virtual_machine_data_disk_attachment.vm_data","mode":"managed","type":"azurerm_virtual_machine_data_disk_attachment","name":"vm_data","provider_config_key":"azurerm","expressions":{"caching":{"constant_value":"ReadWrite"},"lun":{"references":["var.data_disks","each.key"]},"managed_disk_id":{"references":["azurerm_managed_disk.vm_data","each.key"]},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"for_each_expression":{"references":["var.data_disks"]}},{"address":"azurerm_virtual_machine_extension.azure_monitor","mode":"managed","type":"azurerm_virtual_machine_extension","name":"azure_monitor","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Azure_Monitor_Windows_Agent"},"publisher":{"constant_value":"Microsoft.Azure.Monitor"},"tags":{"references":["var.tags"]},"type":{"constant_value":"AzureMonitorWindowsAgent"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.managed_identity"]},{"address":"azurerm_virtual_machine_extension.custom_script","mode":"managed","type":"azurerm_virtual_machine_extension","name":"custom_script","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Custom_Script"},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["local.custom_script_file_uris","local.custom_script_command"]},"type":{"constant_value":"CustomScriptExtension"},"type_handler_version":{"constant_value":"1.10"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.custom_script"]},"depends_on":["azurerm_virtual_machine_extension.guest_configuration"]},{"address":"azurerm_virtual_machine_extension.defender","mode":"managed","type":"azurerm_virtual_machine_extension","name":"defender","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"IaaS_Antimalware"},"publisher":{"constant_value":"Microsoft.Azure.Security"},"settings":{"constant_value":"  {\n    \"AntimalwareEnabled\": \"true\",\n    \"RealtimeProtectionEnabled\": \"true\",\n    \"ScheduledScanSettings\": {\n      \"isEnabled\": \"true\",\n      \"scanType\": \"Quick\",\n      \"day\": \"7\",\n      \"time\": \"120\"\n    }\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"IaaSAntimalware"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.network_watcher"]},{"address":"azurerm_virtual_machine_extension.domain_join_extension","mode":"managed","type":"azurerm_virtual_machine_extension","name":"domain_join_extension","provider_config_key":"azurerm","expressions":{"name":{"constant_value":"Domain_Join"},"protected_settings":{"references":["var.domain_password"]},"publisher":{"constant_value":"Microsoft.Compute"},"settings":{"references":["var.domain_name","var.domain_name","var.domain_username"]},"tags":{"references":["var.tags"]},"type":{"constant_value":"JsonADDomainExtension"},"type_handler_version":{"constant_value":"1.3"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.domain_name","var.domain_username","var.domain_password"]},"depends_on":["azurerm_virtual_machine_extension.custom_script"]},{"address":"azurerm_virtual_machine_extension.guest_configuration","mode":"managed","type":"azurerm_virtual_machine_extension","name":"guest_configuration","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"automatic_upgrade_enabled":{"constant_value":true},"name":{"constant_value":"Guest_Configuration"},"publisher":{"constant_value":"Microsoft.GuestConfiguration"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ConfigurationforWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_extension.defender"]},{"address":"azurerm_virtual_machine_extension.managed_identity","mode":"managed","type":"azurerm_virtual_machine_extension","name":"managed_identity","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Managed_Identity"},"publisher":{"constant_value":"Microsoft.ManagedIdentity"},"settings":{"constant_value":"  {\n    \"port\": \"50342\"\n  }\n"},"tags":{"references":["var.tags"]},"type":{"constant_value":"ManagedIdentityExtensionForWindows"},"type_handler_version":{"constant_value":"1.0"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_virtual_machine_data_disk_attachment.vm_data"]},{"address":"azurerm_virtual_machine_extension.network_watcher","mode":"managed","type":"azurerm_virtual_machine_extension","name":"network_watcher","provider_config_key":"azurerm","expressions":{"auto_upgrade_minor_version":{"constant_value":true},"name":{"constant_value":"Network_Watcher_Agent"},"publisher":{"constant_value":"Microsoft.Azure.NetworkWatcher"},"tags":{"references":["var.tags"]},"type":{"constant_value":"NetworkWatcherAgentWindows"},"type_handler_version":{"constant_value":"1.4"},"virtual_machine_id":{"references":["azurerm_windows_virtual_machine.vm[0].id","azurerm_windows_virtual_machine.vm[0]","azurerm_windows_virtual_machine.vm"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.log_analytics"]},"depends_on":["azurerm_virtual_machine_extension.azure_monitor"]},{"address":"azurerm_windows_virtual_machine.vm","mode":"managed","type":"azurerm_windows_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_password":{"references":["random_password.vm_admin.result","random_password.vm_admin"]},"admin_username":{"references":["var.server_admin_name"]},"boot_diagnostics":[{"storage_account_uri":{"constant_value":null}}],"computer_name":{"references":["var.computer_name"]},"enable_automatic_updates":{"constant_value":true},"encryption_at_host_enabled":{"constant_value":true},"identity":[{"type":{"constant_value":"SystemAssigned"}}],"license_type":{"references":["local.image_skus","var.image"]},"location":{"references":["var.location"]},"name":{"references":["var.name"]},"network_interface_ids":{"references":["azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadOnly"},"disk_encryption_set_id":{"references":["var.customer_managed_keys","azurerm_disk_encryption_set.vm_os[0].id","azurerm_disk_encryption_set.vm_os[0]","azurerm_disk_encryption_set.vm_os"]},"name":{"references":["var.name"]},"storage_account_type":{"references":["var.storage_account_type"]}}],"patch_mode":{"constant_value":"AutomaticByOS"},"provision_vm_agent":{"constant_value":true},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]},"size":{"references":["var.size"]},"source_image_reference":[{"offer":{"references":["local.image_skus","var.image"]},"publisher":{"references":["local.image_skus","var.image"]},"sku":{"references":["local.image_skus","var.image"]},"version":{"references":["local.image_skus","var.image"]}}],"tags":{"references":["var.startup_hour","var.shutdown_hour","var.running_days","var.tags","var.startup_hour","var.shutdown_hour","var.running_days","var.tags"]},"zone":{"references":["var.zone"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["azurerm_disk_encryption_set.vm_os","azurerm_role_assignment.kv_vm_os_reader","azurerm_role_assignment.kv_vm_os_crypto_user","azurerm_role_assignment.kv_vm_os_crypto_service_user"]},{"address":"null_resource.ansible_windows_updates","mode":"managed","type":"null_resource","name":"ansible_windows_updates","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.windows_update_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.windows_update_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.windows_update"]},"depends_on":["time_sleep.wait_vm_reboot","null_resource.local_admin_group","null_resource.disable_server_manager_login"]},{"address":"null_resource.disable_server_manager_login","mode":"managed","type":"null_resource","name":"disable_server_manager_login","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.disable_server_manager_startup_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.disable_server_manager_startup_script"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.ie_configuration","mode":"managed","type":"null_resource","name":"ie_configuration","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.ie_configuration","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password"]}}}],"expressions":{"triggers":{"references":["local.ie_configuration"]}},"schema_version":0,"count_expression":{"references":["var.os_type"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_admin_group","mode":"managed","type":"null_resource","name":"local_admin_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_admins_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_admins_group"]}}}],"expressions":{"triggers":{"references":["local.local_admins_script","var.local_admins_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_admins_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"null_resource.local_power_users_group","mode":"managed","type":"null_resource","name":"local_power_users_group","provider_config_key":"null","provisioners":[{"type":"local-exec","expressions":{"command":{"references":["local.local_power_users_script","data.azurerm_network_interface.vm","data.azurerm_network_interface.vm","var.domain_username","var.domain_password","var.local_power_users_group"]}}}],"expressions":{"triggers":{"references":["local.local_power_users_script","var.local_power_users_group"]}},"schema_version":0,"count_expression":{"references":["var.os_type","var.local_power_users_group"]},"depends_on":["time_sleep.wait_vm_reboot"]},{"address":"random_password.vm_admin","mode":"managed","type":"random_password","name":"vm_admin","provider_config_key":"random","expressions":{"length":{"references":["var.random_password_length"]},"override_special":{"constant_value":"_%@"},"special":{"constant_value":true}},"schema_version":0},{"address":"time_sleep.wait_vm_reboot","mode":"managed","type":"time_sleep","name":"wait_vm_reboot","provider_config_key":"time","expressions":{"create_duration":{"constant_value":"300s"}},"schema_version":0,"depends_on":["azurerm_virtual_machine_extension.domain_join_extension"]},{"address":"tls_private_key.vm_ssh_key","mode":"managed","type":"tls_private_key","name":"vm_ssh_key","provider_config_key":"module.vm_session_host_3:tls","expressions":{"algorithm":{"constant_value":"RSA"},"rsa_bits":{"constant_value":4096}},"schema_version":1,"count_expression":{"references":["var.os_type"]}},{"address":"data.azuread_user.domain_username","mode":"data","type":"azuread_user","name":"domain_username","provider_config_key":"azuread","expressions":{"user_principal_name":{"references":["var.domain_username"]}},"schema_version":0},{"address":"data.azurerm_backup_policy_vm.policy","mode":"data","type":"azurerm_backup_policy_vm","name":"policy","provider_config_key":"azurerm","expressions":{"name":{"references":["var.backup_policy"]},"recovery_vault_name":{"references":["var.recovery_vault"]},"resource_group_name":{"references":["var.recovery_resource_group"]}},"schema_version":0},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0},{"address":"data.azurerm_network_interface.vm","mode":"data","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"name":{"references":["azurerm_network_interface.vm","each.key"]},"resource_group_name":{"references":["var.resource_group.name","var.resource_group"]}},"schema_version":0,"for_each_expression":{"references":["var.nics"]},"depends_on":["azurerm_windows_virtual_machine.vm","azurerm_linux_virtual_machine.vm"]}],"variables":{"backup_policy":{"default":null,"description":"Backup Policy to apply to the VM"},"computer_name":{"description":"Name of the internal SO computer."},"custom_script":{"default":false,"description":"Enable deployment of a Custom Script"},"custom_script_url":{"default":"","description":"The Custom Script URL to be downloaded and run on the VM"},"customer_managed_keys":{"default":false,"description":"Set if cutomer managed keys are used."},"data_collection_endpoint":{"description":"Data collection endpoint to add to vm."},"data_collection_rule":{"description":"Data collection rule to add to vm."},"data_disks":{"default":{},"description":"List of objects for creating data disks."},"domain_name":{"default":null,"description":"The Domain Name to join the Virtual Machine to"},"domain_password":{"default":null,"description":"The Domain Password of an account to use to join machine to domain but also run scripts with","sensitive":true},"domain_username":{"default":null,"description":"The Domain Username of an account used to join machine to domain but also run scripts with"},"image":{"default":"windows-2022-datacenter","description":"Image offer for the Virtual Machine"},"key_vault":{"default":null,"description":"Key Vault to store Virtual Machine credentials inside"},"key_vault_key":{"default":null,"description":"Certificate key for disk encryption."},"local_admins_group":{"default":null,"description":"AD Group to add into the Local Administrators on the server"},"local_power_users_group":{"default":null,"description":"AD Group to add into the Local Porwer Users on the server"},"location":{"default":"uksouth","description":"The location/region where the resources are created"},"log_analytics":{"default":null,"description":"Log Analytics workspace to use for VM logging"},"log_storage":{"default":null,"description":"Storage Account to use for VM logging"},"name":{"description":"Name of the Virtual Machine"},"nics":{"default":{"first":{"ipconfig_name":"default","name":"default","private_ip_address":"default","private_ip_address_allocation":"Dynamic","vnet_subnet_id":"default"}},"description":"List of objects for creating nics."},"os_type":{"default":"windows"},"random_password_length":{"default":64,"description":"The desired length of random password created by this module"},"recovery_resource_group":{"default":null,"description":"The Resource Group object in which the recovery vault is in"},"recovery_vault":{"default":null,"description":"Recovery Vault to backup to"},"resource_group":{"description":"The Resource Group object in which the resources will be created"},"running_days":{"default":""},"second_custom_script":{"default":false,"description":"Enable deployment of a second custom Script"},"second_custom_script_url":{"default":"","description":"The Second Custom Script URL to be downloaded and run on the VM."},"server_admin_name":{"default":"sysadmin","description":"Name of the Virtual Machine Server Admin Account"},"shutdown_hour":{"default":""},"size":{"default":"Standard_B1s","description":"Specifies the size of the virtual machine"},"startup_hour":{"default":""},"storage_account_type":{"default":"Standard_LRS","description":"Defines the type of storage to use for the Virtual Machine Scale Set"},"tags":{"default":{}},"vnet_subnet":{"description":"Virtual Machine NIC Subnet to connect with"},"windows_update":{"default":true,"description":"Applies the latest Windows Updates after deployment"},"zone":{"default":null,"description":"List of zones where the vm is created."}}},"depends_on":["time_sleep.wait_ad_replication","azurerm_subnet.modern","azurerm_subnet_route_table_association.modern","azurerm_virtual_network_peering.modern_to_hub","azurerm_virtual_network_peering.hub_to_modern","azurerm_virtual_network_peering.modern_to_devops","azurerm_virtual_network_peering.devops_to_modern","azurerm_virtual_desktop_host_pool.modern","azurerm_virtual_desktop_workspace.modern","azurerm_private_endpoint.recovery_vault_modern"]}},"variables":{"avd_vm_sku":{"default":"Standard_D4s_v5"},"az_files_hybrid_url":{"default":"https://github.com/Azure-Samples/azure-files-samples/releases/download/v0.2.7/AzFilesHybrid.zip","description":"Url where download AZ files hybrid scripts."},"customer_managed_keys":{"default":false,"description":"Set if cutomer managed keys are used."},"deploy_cache_db":{"default":"none","description":"The Cache DB to deploy to the server. If deploying Cache itself is disabled this will be skipped regardless of setting"},"deploy_daybook_ver":{"default":"2_5_0","description":"Which version of daybook to install. requires install nbss = true, default 2.5.0"},"deploy_iris_db":{"default":"none","description":"The IRIS DB to deploy to the server. If deploying IRIS itself is disabled this will be skipped regardless of setting"},"deploy_vb_app_ver":{"default":"4_2_0","description":"The VB6 App Version"},"deployment_public_ip_firewalls":{"default":true},"environment":{"default":"txet"},"environment_num":{"default":1},"expiration_date":{"default":"2030-01-01T00:00:00Z","description":"Date when the certificate expires."},"fslogix_app_url":{"default":"https://aka.ms/fslogix_download","description":"Url where download AZ files hybrid scripts."},"install_base_software":{"default":true,"description":"Install some common base software onto the Server"},"install_cache":{"default":false,"description":"Install Cache onto the Server"},"install_cache_client_only":{"default":false,"description":"Install Cache Client onto the Server"},"install_iris":{"default":false,"description":"Install IRIS onto the Server"},"install_nbss":{"default":true,"description":"Install NBSS onto the Server"},"install_vb6":{"default":false,"description":"Install Visual Basic 6.0 IDE onto the Server"},"iris_db_arbiter_vm_sku":{"default":"Standard_D2s_v5"},"iris_db_backup_vm_sku":{"default":"Standard_D48s_v5"},"iris_db_primary_vm_sku":{"default":"Standard_D48s_v5"},"key_size":{"default":2048,"description":"Key size."},"key_type":{"default":"RSA","description":"Key type."},"location":{"default":"uksouth"},"mod_testers":{"default":["fb1919e0-6f24-483b-9805-cad05ea3c745","9ee966e1-4b96-483e-a0a2-10b6c0e070cb","823ce908-2aae-49a2-981d-870d8aca86b0"],"description":"Modernisation Network Virtual Network Range"},"modern_vnet_range":{"default":"10.20.0.0/21","description":"Modernisation Network Virtual Network Range"},"org_name":{"default":"NBSS"},"security_contact_email":{"default":"paul.thoms@hitachivantara.com","description":"The security contact for Defender for Cloud's email address"},"security_contact_phone":{"default":"+447551283828","description":"The security contact for Defender for Cloud's phone number"},"tag_app":{"default":"Core"},"tag_environment":{"default":"Modernisation"},"tag_project":{"default":"Modernisation"},"tag_service":{"default":"Modernisation"},"tag_shared":{"default":"Modernisation"},"tag_site":{"default":"Modernisation"}}}},"relevant_attributes":[{"resource":"data.azurerm_client_config.current","attribute":["subscription_id"]},{"resource":"data.azuread_service_principal.wvd","attribute":["id"]},{"resource":"data.azurerm_firewall_policy.standard","attribute":["id"]}]}
